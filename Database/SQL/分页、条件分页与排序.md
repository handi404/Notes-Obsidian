# MySQL 分页、条件分页与排序 SQL 语句汇总

## 一、基础分页查询

### 1. 标准分页写法
```sql
-- 从第11条开始，取20条数据（第2页，每页20条）
SELECT * FROM t_student LIMIT 10, 20;

-- 等价写法（SQL标准语法）
SELECT * FROM t_student LIMIT 20 OFFSET 10;
```

### 2. 获取前 N 条记录
```sql
-- 获取前10条记录
SELECT * FROM t_student LIMIT 10;
-- 等价于
SELECT * FROM t_student LIMIT 0, 10;
```

## 二、带条件的分页查询

### 1. 基础条件分页
```sql
-- 查询年龄大于18的学生，分页显示
SELECT * FROM t_student 
WHERE age > 18
LIMIT 10, 20;
```

### 2. 多条件组合查询
```sql
-- 查询18-25岁之间的女生
SELECT * FROM t_student 
WHERE age BETWEEN 18 AND 25
AND sex = '女'
LIMIT 0, 10;
```

### 3. IN 条件分页
```sql
-- 查询特定班级的学生
SELECT * FROM t_student
WHERE class_id IN (1, 3, 5)
LIMIT 20, 10;
```

### 4. LIKE 模糊查询分页
```sql
-- 查询姓张的学生
SELECT * FROM t_student
WHERE name LIKE '张%'
LIMIT 0, 15;
```

## 三、带排序的分页查询

### 1. 单字段排序
```sql
-- 按年龄升序分页
SELECT * FROM t_student
ORDER BY age ASC
LIMIT 10, 20;

-- 按创建时间降序分页
SELECT * FROM t_student
ORDER BY create_time DESC
LIMIT 0, 10;
```

### 2. 多字段排序
```sql
-- 先按性别升序，再按年龄降序
SELECT * FROM t_student
ORDER BY sex ASC, age DESC
LIMIT 15, 5;
```

### 3. 随机记录分页
```sql
-- 随机获取10条记录（性能较差，小表适用）
SELECT * FROM t_student
ORDER BY RAND()
LIMIT 10;
```

## 四、高级分页技巧

### 1. 获取分页元数据
```sql
-- 获取总记录数（用于计算总页数）
SELECT COUNT(*) FROM t_student;

-- 带条件的总数查询
SELECT COUNT(*) FROM t_student WHERE age > 18;
```

### 2. 优化大偏移量分页
```sql
-- 替代 LIMIT 10000, 20 的高效写法
SELECT * FROM t_student
WHERE id > (SELECT id FROM t_student ORDER BY id LIMIT 10000, 1)
ORDER BY id
LIMIT 20;
```

### 3. 分页联表查询
```sql
-- 学生表与班级表联表分页
SELECT s.*, c.class_name 
FROM t_student s
JOIN t_class c ON s.class_id = c.id
ORDER BY s.create_time DESC
LIMIT 30, 10;
```

## 五、特殊分页需求

### 1. 分组后分页
```sql
-- 按班级分组后取前3组
SELECT class_id, COUNT(*) as student_count
FROM t_student
GROUP BY class_id
ORDER BY student_count DESC
LIMIT 0, 3;
```

### 2. 去重分页
```sql
-- 获取不重复的专业列表并分页
SELECT DISTINCT major FROM t_student
ORDER BY major
LIMIT 10, 5;
```

### 3. 子查询分页
```sql
-- 先筛选后分页
SELECT * FROM (
    SELECT * FROM t_student
    WHERE score > 60
) AS passed_students
ORDER BY score DESC
LIMIT 0, 10;
```

## 六、性能优化建议

1. **索引优化**：
   - 确保排序字段和条件字段有索引
   ```sql
   ALTER TABLE t_student ADD INDEX idx_age_name (age, name);
   ```

2. **避免大偏移量**：
   - 使用"上一页最后一条 ID"方法替代传统分页
   ```sql
   -- 假设上一页最后一条记录的id是12345
   SELECT * FROM t_student
   WHERE id > 12345
   ORDER BY id
   LIMIT 10;
   ```

3. **只查询必要字段**：
   ```sql
   -- 不要使用 SELECT *
   SELECT id, name, age FROM t_student
   ORDER BY create_time
   LIMIT 0, 10;
   ```

这些 SQL 语句涵盖了 MySQL 中分页查询的绝大多数使用场景，根据实际需求选择合适的方式，并注意性能优化。