来聊聊 MySQL 里这几个 `COUNT`  的区别。很多人第一次看到  `COUNT(*)` 、 `COUNT(1)` 、 `COUNT(id)` 、 `COUNT(字段)` 的时候都会懵：这不都是数数吗？能有啥区别？但用错了可能掉坑里，尤其数据量大的时候性能差距能拉开几十倍。我给你掰开揉碎了讲，保证听完不迷糊。  

---

### 先说结论（懒人版）

1. 1\. `COUNT(*)` 和 `COUNT(1)` 没本质区别，闭着眼用 `COUNT(*)` 就行。
2. 2\. `COUNT(id)` 和 `COUNT(*)` **看似** 一样，但某些情况下会翻车。
3. 3\. `COUNT(字段)` 是「最矫情」的，用不好结果可能不对，还拖慢速度。

---

### 正经分析环节

#### 1\. COUNT(\*) 和 COUNT(1) 是亲兄弟

这俩货本质是一模一样的，都是统计 **所有符合条件** 的行数，不管字段是不是 NULL。哪怕你表里所有字段都是 NULL，它们也会老实计数。

**举个栗子🌰** ：  
假设有个表 `students` ，里面全是 NULL 值的行：

```
+------+------+------+
| id   | name | age  |
+------+------+------+
| NULL | NULL | NULL |
| NULL | NULL | NULL |
+------+------+------+
```

执行：

```
SELECT COUNT(*), COUNT(1) FROM students;  -- 结果都是 2
```

**底层真相** ：  
在 MySQL 优化器眼里， `COUNT(*)` 和 `COUNT(1)` 会被翻译成同一个执行计划，性能完全没区别。那些说 `COUNT(1)` 更快的人，八成是被过时的知识误导了。

---

#### 2\. COUNT(id) 是个「伪君子」

很多人觉得 `COUNT(id)` 和 `COUNT(*)` 一样，毕竟 `id`  是主键不可能为 NULL。但注意！如果  `id` 字段 **允许 NULL** （虽然主键一般不允许）， `COUNT(id)` 会跳过 NULL 值，这时候结果可能比 `COUNT(*)` 少！

**举个栗子🌰** ：  
假设有个允许 NULL 的 `id` 字段：

```
+------+-------+
| id   | name  |
+------+-------+
| 1    | 张三  |
| NULL | 李四  |
+------+-------+
```

执行：

```
SELECT COUNT(*), COUNT(id) FROM students;  
-- COUNT(*) = 2，COUNT(id) = 1
```

**关键点** ：

- • 如果 `id`  是主键（NOT NULL）， `COUNT(id)` 和 `COUNT(*)` 结果一致。
- • 但如果 `id`  允许 NULL， `COUNT(id)` 会漏数！
- • **性能陷阱** ：如果 `id`  是二级索引， `COUNT(id)` 可能比 `COUNT(*)` 慢，因为它要走索引扫描。

---

#### 3\. COUNT(字段) 是「事儿精」

这是最需要小心的写法！ `COUNT(字段)` 只统计该字段 **不为 NULL** 的行数，而且性能可能最差。

**举个栗子🌰** ：

```
SELECT COUNT(name) FROM students;  -- 只统计 name 不为 NULL 的行
```

**三大坑点** ：

1. 1\. **结果可能不准** ：如果字段有 NULL 值，结果会比实际行数少。
2. 2\. **性能杀手** ：如果字段没索引，需要全表扫描 + 检查 NULL，大表直接卡成PPT。
3. 3\. **索引依赖** ：即使字段有索引，如果是二级索引，可能还是要回表（InnoDB 的锅）。

---

### 终极性能对比（InnoDB 引擎）

| 写法 | 使用主键索引 | 使用二级索引 | 无索引字段 |
| --- | --- | --- | --- |
| `COUNT(*)` | 最快 ✅ | 快 🚀 | 快 🚀 |
| `COUNT(1)` | 同 `COUNT(*)` | 同 `COUNT(*)` | 同 `COUNT(*)` |
| `COUNT(id)` | 同 `COUNT(*)` （id 是主键） | 较慢 🐢（走二级索引） | 不存在（主键必须有索引） |
| `COUNT(字段)` | \- | 中等 🚶（需检查 NULL） | 最慢 🐌 |

---

### 该用哪个？记住这三点！

1. 1\. **无脑用 `COUNT(*)`** ：
- • 结果最准确（统计所有行）。
	- • MySQL 专门优化过，性能最佳。
	- • SQL 标准写法，DBA 看了都说专业。
3. 2\. **统计非 NULL 字段时才用 `COUNT(字段)`** ：
- • 比如统计「填写了手机号的用户数」。
	- • 确保字段有索引，否则小表勉强用，大表会暴毙。
5. 3\. **别用 `COUNT(id)` 装逼** ：
- • 除非你 100% 确定 `id` 是主键且 NOT NULL。
	- • 否则可能掉进 NULL 值的坑，性能也不占优。

---

### 灵魂拷问：为什么网上有人说 COUNT(1) 更快？

这是上古版本的 MySQL 遗留问题（比如 5.0 之前），当时 `COUNT(*)` 的优化不够好。但从 5.1 版本开始，两者已经完全等价。2025 年了，该放下这个「祖传误解」了！

---

### 实战技巧

- • **大表统计** ：用 `COUNT(*)` ，如果实在慢到崩溃，考虑用缓存（如 Redis）或单独维护计数表。
- • **统计非 NULL 值** ： `COUNT(字段)` + 确保字段有索引。
- • **分组统计** ：结合 `GROUP BY` 时，优先用覆盖索引（索引包含分组字段和查询字段）。

---

### 总结

记住这个口诀：  
**「统计行数用星号，字段统计要索引，主键计数可替代，其他写法要三思」** 。 
