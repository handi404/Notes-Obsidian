//  updater function = 通常作为参数传递给 setState（） 的函数
//                                 例如：setYear（y => y + 1）
//                                 允许根据以前的状态进行安全更新
//                                 与多个状态更新和异步函数一起使用
//                                 使用更新程序函数的良好做法

---

```jsx
import React, { useState } from 'react';

function MyComponent() {

    const [count, setCount] = useState(0);
	/*取状态变量的第一个字母并使用它来指示这是先前的状态*/
    function increment(){
        setCount(c => c + 1);
        setCount(c => c + 1);
        setCount(c => c + 1);
    };
 
    function decrement(){
        setCount(c => c - 1);
        setCount(c => c - 1);
        setCount(c => c - 1);
    };

    function reset(){
        setCount(0);
    }

    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={decrement}>Decrement</button>
            <button onClick={reset}>Reset</button>
            <button onClick={increment}>Increment</button>
        </div>
      );
}
export default MyComponent
```


在 React 中，**updater function** 是指通过 `setState` 更新组件状态时的一种特殊用法。它允许你基于先前的状态来计算新的状态，确保状态更新的可靠性和一致性。

### 解释 `setState` 的两种用法

1. **直接传递新状态**：
   - 你可以直接传递一个对象来更新状态。例如：
     ```jsx
     this.setState({ count: this.state.count + 1 });
     ```
   - 这里的 `this.setState` 接受的是一个对象，表示希望将组件的 `count` 状态加 1。

2. **使用 `updater function`**：
   - 当新状态依赖于先前的状态时，使用 `updater function` 更加安全和可靠。这是因为 React 的状态更新是异步的，如果你直接依赖 `this.state`，在某些情况下可能会出现意外的行为。
   - 例如：
     ```jsx
     this.setState((prevState) => ({
       count: prevState.count + 1
     }));
     ```
   - 在这里，`this.setState` 接受一个函数作为参数。这个函数会接收当前的 `prevState` 和 `props`，并返回一个新的状态对象。通过 `prevState`，你可以确保基于最新的状态来计算新的状态。

### 为什么使用 `updater function`

- **异步更新**：React 可能会批量处理 `setState` 调用，从而提高性能。如果你多次调用 `setState`，直接使用 `this.state` 可能会导致意想不到的结果，因为 `this.state` 可能还没有反映出最新的变化。
  
- **确保正确性**：使用 `updater function` 确保你的新状态基于正确的前一个状态，而不会受到其他异步 `setState` 调用的影响。

### 示例

考虑一个计数器应用：

```jsx
class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      count: 0
    };
  }

  increment() {
    // 使用 updater function 来确保更新基于最新的状态
    this.setState((prevState) => ({
      count: prevState.count + 1
    }));
  }

  render() {
    return (
      <div>
        <p>Count: {this.state.count}</p>
        <button onClick={() => this.increment()}>Increment</button>
      </div>
    );
  }
}
```

在这个示例中，每次点击按钮时，`increment` 方法会调用 `setState`，并传递一个 `updater function`，确保计数值 `count` 始终准确地递增。

### 总结

**React updater function** 是通过 `setState` 更新状态时的一种模式，用于在更新新状态时基于前一个状态值进行计算。它是处理依赖于当前状态的更新逻辑时的最佳实践，确保状态更新的正确性，尤其在复杂的应用中显得尤为重要。
