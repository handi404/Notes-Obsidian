Template refs æ¨¡æ¿å¼•ç”¨ ref ä¸ dom å…ƒç´ å…³è” 
```vue
<template>
  <div class="home">
    Home
    <p ref="p">My name is {{ name }}, age is {{ age }}</p>
    <button @click="handleClick">click me</button>
  </div>
</template>

<script>
import { ref } from "vue";
export default {
  setup() {
    let name = "Home";
    let age = 25;
    let p = ref(null);
    console.log(p, p.value);//è¿™é‡Œçš„p.valueä¸ä¸‹é¢çš„ä¸åŒ
    const handleClick = (params) => {
      console.log(p, p.value);//
      p.value.textContent = "hello, world";
    };
    return {
      name,
      age,
      handleClick,
      p,
    };
  },
};
</script>
<style></style>
```
å¾ˆå°‘ä½¿ç”¨æ¨¡æ¿å¼•ç”¨å› ä¸ºæˆ‘è§‰å¾—å°±åƒæˆ‘éœ€è¦åšçš„æ‰€æœ‰æ“ä½œ dom å†…å®¹çš„äº‹æƒ…éƒ½å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ä½¿ç”¨ vue æ¥å®Œæˆ, ä½†åœ¨ä½¿ç”¨ Composition API æ—¶ ref è¿˜æœ‰å¦ä¸€ä¸ªéå¸¸éå¸¸é‡è¦çš„ä½œç”¨å¯ä»¥ç”¨æ¥ä½¿å€¼å…·æœ‰å“åº”æ€§

---

### **Vue 3 ä¸­çš„ `ref` ç»‘å®š DOM å…ƒç´ ï¼ˆä½¿ç”¨ `setup()`ï¼‰**

åœ¨ Vue 3 çš„ `setup()` ç»„åˆå¼ API ä¸­ï¼Œ`ref` å¯ä»¥ç”¨äºè·å–å’Œæ“ä½œ DOM å…ƒç´ ã€‚ä¸åŒäº Vue 2 çš„ `$refs`ï¼Œåœ¨ Vue 3 ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ `ref()` ç»‘å®š DOM å…ƒç´ ï¼Œå¹¶åœ¨ `onMounted()` ä¸­æ“ä½œå®ƒã€‚

---

## **1. åŸºæœ¬ç”¨æ³•**

åœ¨ Vue 3 ä¸­ï¼Œä½¿ç”¨ `ref()` ç»‘å®š DOM å…ƒç´ çš„æ­¥éª¤ï¼š

1. **åˆ›å»º `ref` å˜é‡**ï¼Œåˆå§‹å€¼ä¸º `null`ã€‚
2. **åœ¨æ¨¡æ¿ä¸­ç»‘å®š `ref`**ï¼Œå°†å…¶èµ‹å€¼ç»™å…ƒç´ ã€‚
3. **åœ¨ `onMounted()` ä¸­è®¿é—® DOM å…ƒç´ **ã€‚

### **ç¤ºä¾‹ï¼šè·å– `input` å…ƒç´ å¹¶èšç„¦**

```vue
<template>
  <input ref="inputRef" type="text" placeholder="è‡ªåŠ¨èšç„¦" />
</template>

<script>
import { ref, onMounted } from 'vue';

export default {
  setup() {
    const inputRef = ref(null);

    onMounted(() => {
      if (inputRef.value) {
        inputRef.value.focus(); // åœ¨ç»„ä»¶æŒ‚è½½åè‡ªåŠ¨èšç„¦
      }
    });

    return { inputRef };
  }
};
</script>
```

#### **ğŸ“Œ è§£æ**

- `ref(null)`: `inputRef` ç»‘å®š DOM å…ƒç´ ï¼Œåˆå§‹å€¼ä¸º `null`ã€‚
- `ref="inputRef"`: ç»‘å®šåˆ° `<input>` å…ƒç´ ã€‚
- `onMounted()`: ç»„ä»¶æŒ‚è½½åï¼Œ`inputRef.value` æŒ‡å‘çœŸå®çš„ DOM å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ `focus()` è®©è¾“å…¥æ¡†è‡ªåŠ¨èšç„¦ã€‚

---

## **2. ç»‘å®šå¤šä¸ªå…ƒç´ **

å½“éœ€è¦ç®¡ç†å¤šä¸ªç›¸åŒç±»å‹çš„å…ƒç´ æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `ref([])`ï¼Œå¹¶åœ¨ `v-for` ä¸­ç»‘å®šã€‚

### **ç¤ºä¾‹ï¼šç®¡ç†å¤šä¸ªæŒ‰é’®**

```vue
<template>
  <button v-for="(item, index) in 3" :key="index" ref="buttonsRef">
    æŒ‰é’® {{ index + 1 }}
  </button>
</template>

<script>
import { ref, onMounted } from 'vue';

export default {
  setup() {
    const buttonsRef = ref([]);

    onMounted(() => {
      console.log(buttonsRef.value); // è·å–æ‰€æœ‰æŒ‰é’® DOM å…ƒç´ 
      buttonsRef.value[0]?.focus(); // è®©ç¬¬ä¸€ä¸ªæŒ‰é’®è·å–ç„¦ç‚¹
    });

    return { buttonsRef };
  }
};
</script>
```

#### **ğŸ“Œ è§£æ**

- `ref([])`: `buttonsRef` ç»‘å®šå¤šä¸ª DOM å…ƒç´ ï¼Œåˆå§‹å€¼ä¸ºç©ºæ•°ç»„ã€‚
- `ref="buttonsRef"`: ç»‘å®šåˆ° `v-for` ç”Ÿæˆçš„æ‰€æœ‰ `<button>`ã€‚
- `buttonsRef.value[0].focus()`: è®¿é—®æ•°ç»„ä¸­çš„ DOM å…ƒç´ å¹¶æ“ä½œã€‚

---

## **3. æ“ä½œå­ç»„ä»¶çš„ `ref`**

åœ¨ Vue 3 ä¸­ï¼Œ`ref` ä¹Ÿå¯ä»¥ç»‘å®šåˆ°å­ç»„ä»¶ï¼Œä»è€Œè®¿é—®å­ç»„ä»¶çš„æ–¹æ³•æˆ–æ•°æ®ã€‚

### **ç¤ºä¾‹ï¼šè·å–å­ç»„ä»¶å®ä¾‹å¹¶è°ƒç”¨æ–¹æ³•**

#### **ğŸ“Œ å­ç»„ä»¶**

```vue
<!-- ChildComponent.vue -->
<template>
  <div>å­ç»„ä»¶</div>
</template>

<script>
import { defineExpose } from 'vue';

export default {
  setup() {
    const sayHello = () => {
      alert('Hello from Child Component!');
    };

    // é€šè¿‡ defineExpose å…¬å¼€æ–¹æ³•
    defineExpose({ sayHello });
  }
};
</script>
```

#### **ğŸ“Œ çˆ¶ç»„ä»¶**

```vue
<template>
  <ChildComponent ref="childRef" />
  <button @click="childRef?.sayHello()">è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</button>
</template>

<script>
import { ref, onMounted } from 'vue';
import ChildComponent from './ChildComponent.vue';

export default {
  components: { ChildComponent },
  setup() {
    const childRef = ref(null);

    onMounted(() => {
      console.log(childRef.value); // å­ç»„ä»¶å®ä¾‹
    });

    return { childRef };
  }
};
</script>
```

#### **ğŸ“Œ è§£æ**

- `ref="childRef"`: ç»‘å®šå­ç»„ä»¶ã€‚
- `defineExpose({ sayHello })`: é€šè¿‡ `defineExpose` è®© `sayHello` æ–¹æ³•å¯è¢«å¤–éƒ¨è®¿é—®ã€‚
- `childRef?.sayHello()`: è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•ã€‚

---

## **4. `ref` vs `template ref`**

Vue 3 æä¾›äº† `template ref` ä½œä¸º `ref` çš„æ›¿ä»£æ–¹å¼ï¼Œé€‚ç”¨äº `setup()` è¯­æ³•ç³–çš„ `<script setup>`ã€‚

### **ç¤ºä¾‹ï¼šä½¿ç”¨ `template ref`**

```vue
<template>
  <input ref="inputRef" type="text" placeholder="è‡ªåŠ¨èšç„¦" />
</template>

<script setup>
import { ref, onMounted } from 'vue';

const inputRef = ref(null);

onMounted(() => {
  inputRef.value?.focus();
});
</script>
```

#### **ğŸ“Œ è§£æ**

- ç›´æ¥åœ¨ `<script setup>` å®šä¹‰ `ref`ï¼Œæ— éœ€ `return`ã€‚
- `template ref` æ›´ç®€æ´ï¼Œæ¨èåœ¨ `<script setup>` è¯­æ³•ä¸­ä½¿ç”¨ã€‚

---

## **5. ç»“åˆäº‹ä»¶ç›‘å¬æ“ä½œ DOM**

å¯ä»¥é€šè¿‡ `ref` æ“ä½œ DOM æ¥ç›‘å¬äº‹ä»¶ï¼Œæ¯”å¦‚æ‰‹åŠ¨è§¦å‘ `click` äº‹ä»¶ã€‚

### **ç¤ºä¾‹ï¼šæ‰‹åŠ¨è§¦å‘ç‚¹å‡»äº‹ä»¶**

```vue
<template>
  <button ref="btnRef" @click="handleClick">ç‚¹å‡»æˆ‘</button>
</template>

<script setup>
import { ref, onMounted } from 'vue';

const btnRef = ref(null);

const handleClick = () => {
  alert('æŒ‰é’®è¢«ç‚¹å‡»');
};

onMounted(() => {
  btnRef.value?.click(); // ç»„ä»¶æŒ‚è½½åè‡ªåŠ¨è§¦å‘ç‚¹å‡»
});
</script>
```

#### **ğŸ“Œ è§£æ**

- `btnRef.value?.click()` è®©æŒ‰é’®åœ¨ `onMounted()` æ—¶è‡ªåŠ¨è¢«ç‚¹å‡»ã€‚

---

## **6. ç»‘å®š `canvas`ã€`video` ç­‰ç‰¹æ®Šå…ƒç´ **

### **ç¤ºä¾‹ï¼šè·å– `canvas` ä¸Šä¸‹æ–‡**

```vue
<template>
  <canvas ref="canvasRef" width="200" height="200"></canvas>
</template>

<script setup>
import { ref, onMounted } from 'vue';

const canvasRef = ref(null);

onMounted(() => {
  const ctx = canvasRef.value?.getContext('2d');
  if (ctx) {
    ctx.fillStyle = 'red';
    ctx.fillRect(20, 20, 100, 100);
  }
});
</script>
```

#### **ğŸ“Œ è§£æ**

- `canvasRef.value.getContext('2d')` è·å– `canvas` ä¸Šä¸‹æ–‡å¹¶ç»˜åˆ¶å›¾å½¢ã€‚

---

## **æ€»ç»“**

|åœºæ™¯|æ–¹å¼|
|---|---|
|ç»‘å®šå•ä¸ª DOM å…ƒç´ |`const el = ref(null);`|
|ç»‘å®šå¤šä¸ª DOM å…ƒç´ |`const els = ref([]);`|
|è®¿é—®å­ç»„ä»¶æ–¹æ³•|`defineExpose({ method })`|
|`script setup` è¯­æ³•ç³–|`ref="elRef"` ç›´æ¥ä½¿ç”¨|
|æ“ä½œ `canvas`ã€`video`|`elRef.value.getContext('2d')`|

Vue 3 çš„ `ref` ç»“åˆ `setup()` è®© DOM æ“ä½œæ›´æ¸…æ™°ã€æ›´æ˜“ç®¡ç†ï¼Œæ¨èä¼˜å…ˆä½¿ç”¨ `template ref` æ–¹å¼ã€‚