### **详解 Vue Router 中的重定向与 404 错误处理**

在单页面应用（SPA）中，路由重定向和 404 错误处理是两项重要的功能，分别用于导航控制和用户体验优化。

---

### **1. 重定向**

重定向（Redirect）用于将用户访问的一个 URL 转向另一个 URL。这在以下情况下非常有用：

1. 路由路径发生变化，但旧路径仍需兼容。
2. 提供用户友好的路径别名。

#### **1.1 定义重定向**

在 Vue Router 中，通过路由规则中的 `redirect` 属性定义重定向。

##### **语法：**

```javascript
{
  path: '/old-path',
  redirect: '/new-path'
}
```

##### **示例：**

```javascript
const routes = [
  { path: '/', component: Home },
  { path: '/old-about', redirect: '/about' },
  { path: '/about', component: About }
];
```

- 当用户访问 `/old-about` 时，会自动重定向到 `/about`。

---

#### **1.2 动态重定向**

重定向目标可以是一个动态生成的路径或函数。

##### **动态路径：**

```javascript
{
  path: '/user/:id',
  redirect: '/profile/:id'
}
```

当用户访问 `/user/123` 时，URL 会重定向到 `/profile/123`。

##### **重定向函数：**

```javascript
{
  path: '/login',
  redirect: (to) => {
    // 检查目标路径是否包含查询参数 redirect
    return to.query.redirect || '/default-home';
  }
}
```

- `to` 是当前的目标路由对象。
- 通过函数可以根据逻辑条件动态决定重定向的目标路径。

---

### **2. 404 错误处理**

404 错误处理是为了捕获用户访问了未定义路径时的情况，通常用来显示一个友好的 "页面不存在" 提示。

#### **2.1 捕获未匹配的路径**

使用路由规则中的通配符 `*` 或正则表达式，捕获所有未匹配的路径。

##### **通配符语法：**

```javascript
const routes = [
  { path: '/', component: Home },
  { path: '/about', component: About },
  { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound }
];
```

- `/about` 和 `/` 会匹配到对应的路由。
- 任何其他路径都会匹配到 `NotFound` 组件。

##### **正则表达式语法：**

```javascript
{
  path: '/:pathMatch(.*)',
  name: 'NotFound',
  component: NotFound
}
```

- `/pathMatch(.*)` 是一个正则表达式，表示匹配所有路径。
```js
{
	 path: "/:catchAll(`.*`)",  //类似一个正则匹配
	 name: ""
	 component: ""
}
```
---

#### **2.2 显示友好的 404 页面**

定义一个专用的 `NotFound` 组件，用于显示 "页面不存在" 的提示。

##### **示例：**

```vue
<template>
  <div>
    <h1>404 Not Found</h1>
    <p>The page you are looking for does not exist.</p>
    <router-link to="/">Go back to Home</router-link>
  </div>
</template>

<script>
export default {
  name: 'NotFound'
};
</script>
```

---

#### **2.3 配合导航守卫实现细粒度控制**

在一些场景中，你可能希望根据逻辑动态判断路径是否有效。如果无效，则重定向到 404 页面。

##### **示例：**

```javascript
const routes = [
  { path: '/', component: Home },
  { path: '/user/:id', component: User },
  { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound }
];

const router = createRouter({
  history: createWebHistory(),
  routes
});

router.beforeEach((to, from, next) => {
  // 检查目标路径是否有效
  const validPaths = ['/user', '/about', '/'];
  if (!validPaths.includes(to.path)) {
    next({ name: 'NotFound' });
  } else {
    next();
  }
});
```

---

### **3. 重定向与 404 错误处理的区别**

|**功能**|**重定向**|**404 错误处理**|
|---|---|---|
|**用途**|将一个路径导航到另一个路径|捕获未匹配路径，显示 "页面不存在" 的提示|
|**实现方式**|路由规则中的 `redirect` 属性|使用通配符或正则匹配未定义的路径|
|**结果**|URL 会更新为目标路径|URL 不变，显示 404 页面|

---

### **4. 综合示例**

以下代码展示了如何同时实现重定向和 404 错误处理：

```javascript
import { createRouter, createWebHistory } from 'vue-router';
import Home from './components/Home.vue';
import About from './components/About.vue';
import NotFound from './components/NotFound.vue';

const routes = [
  { path: '/', component: Home },
  { path: '/about', component: About },
  { path: '/old-home', redirect: '/' }, // 重定向
  { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound } // 404 处理
];

const router = createRouter({
  history: createWebHistory(),
  routes
});

export default router;
```

在应用中：

1. 用户访问 `/old-home` 会被重定向到 `/`。
2. 用户访问任何未定义路径（如 `/random-path`）会显示 `NotFound` 组件。

---

### **5. 总结**

- **重定向**：
    - 用于路径迁移或兼容旧路径。
    - 支持静态和动态定义。
- **404 错误处理**：
    - 用于捕获未匹配路径，显示友好提示。
    - 通过通配符或正则实现。

通过合理配置重定向与 404 错误处理，可以有效提升应用的健壮性与用户体验。