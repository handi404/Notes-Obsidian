## C++ 对象数组的多态

### 什么是对象数组的多态？

在C++中，对象数组的多态指的是：**在一个数组中存储不同类型的对象，但这些对象都具有共同的基类**。通过基类指针或引用来访问数组中的元素，从而实现多态行为。

**为什么需要对象数组的多态？**

- **灵活处理不同类型的对象：** 可以将不同类型的对象统一管理，提高代码的灵活性。
- **模拟现实世界中的复杂关系：** 在现实世界中，往往存在多种具有共同特征的事物。
- **简化代码：** 通过基类指针或引用，可以统一处理不同类型的对象，减少代码的重复。

### 实现对象数组的多态

**1. 继承关系：**

- 首先定义一个基类，作为所有对象的共同基类。
- 派生出多个子类，每个子类代表一种具体的对象类型。
- 子类继承基类的虚函数，实现不同的行为。

**2. 数组声明：**

- 声明一个基类类型的指针数组或引用数组。

**3. 对象创建和赋值：**

- 创建不同子类的对象。
- 将子类对象的地址赋值给基类指针数组的元素。

**代码示例：**

```C++
#include <iostream>

class Animal {
public:
    virtual void makeSound() = 0; // 纯虚函数，强制子类实现
};

class Dog : public Animal {
public:
    void makeSound() override {
        std::cout << "汪汪汪！" << std::endl;
    }
};

class Cat : public Animal {
public:
    void makeSound() override {
        std::cout << "喵喵喵！" << std::endl;
    }
};

int main() {
    // 创建一个Animal指针数组，用于存储不同类型的宠物
    Animal* pets[3];

    // 创建Dog和Cat对象，并将其地址赋值给数组
    pets[0] = new Dog;
    pets[1] = new Cat;
    pets[2] = new Dog;

    // 通过基类指针调用虚函数，实现多态
    for (int i = 0; i < 3; i++) {
        pets[i]->makeSound();
    }

    // 释放内存
    for (int i = 0; i < 3; i++) {
        delete pets[i];
    }

    return 0;
}
```

**解释：**

- `Animal` 是基类，`Dog` 和 `Cat` 是派生类。
- `makeSound` 是一个纯虚函数，强制子类必须实现。
- `pets` 数组存储的是 `Animal` 指针，可以指向任何 `Animal` 的子类对象。
- 通过 `pets[i]->makeSound()` 调用虚函数，根据实际对象的类型动态绑定到对应的函数实现。

### 注意点

- **虚函数的重要性：** 虚函数是实现多态的关键。通过虚函数，编译器可以在运行时根据对象的实际类型选择调用哪个函数。
- **指针或引用：** 必须使用基类指针或引用来访问数组中的元素，才能实现多态。
- **内存管理：** 动态分配的对象需要手动释放，否则会造成内存泄漏。

### 优点

- **灵活性和可扩展性：** 可以方便地添加新的子类，而无需修改原有代码。
- **代码复用：** 可以通过基类定义公共接口，子类实现具体的行为。
- **更好的面向对象设计：** 符合面向对象编程的思想，提高代码的可维护性。

### 应用场景

- **图形用户界面：** 不同类型的控件可以继承自同一个基类，实现统一的事件处理。
- **游戏开发：** 不同的游戏角色可以继承自同一个基类，实现不同的行为。
- **数据结构：** 可以创建各种容器类，如链表、栈、队列等，实现统一的接口。

### 总结

对象数组的多态是C++面向对象编程中一个非常重要的概念。通过它，我们可以更灵活地处理不同类型的对象，提高代码的复用性和可扩展性。