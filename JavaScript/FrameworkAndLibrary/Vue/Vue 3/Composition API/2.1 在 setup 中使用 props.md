åœ¨ setup å‡½æ•°ä¸­è®¿é—® props, setup(props) å³å¯
```vue
<!--------------------Home.vue----------------------->
<template>
  <div class="home">
    <h1>Home</h1>
    <PostList :posts="posts" />
  </div>
</template>
<script>
import { computed, watch, ref, watchEffect } from "vue";
import PostList from "../components/PostList.vue";
export default {
  components: {
    PostList,
  },
  setup() {
    const posts = ref([
      {
        title: "welcome to the blog",
        body: "Lorem ipsum dolor, sit amet consectetur adipisicing elit. Minus quo repudiandae labore iusto ut nisi suscipit, mollitia ex, rem id obcaecati consectetur tenetur commodi doloribus facilis rerum autem beatae ab!",
        id: 1,
      },
      { title: "top 5 css tips", body: "Lorem ipsum", id: 2 },
    ]);
    return {
      posts,
    };
  },
};
</script>
<!--------------------PostList.vue------------------------->
<template>
  <div class="post-list">
    <div v-for="post in posts" :key="post.id">
      <SinglePost :post="post" />
    </div>
  </div>
</template>
<script>
import SinglePost from "./SinglePost.vue";
export default {
  props: ["posts"],
  components: {
    SinglePost,
  },
  setup(props) {
    console.log(props.posts);
  },
};
</script>
<!--------------------SinglePost.vue------------------------->
<template>
  <div class="post">
    <h3>{{ post.title }}</h3>
    <p>{{ snippet }}</p>
  </div>
</template>
<script>
import { computed } from "vue";
export default {
  props: ["post"],
  setup(props) {
    const snippet = computed(() => {
      return props.post.body.substring(0, 100) + "....";
    });
    return {
      snippet,
    };
  },
};
</script>
```

---

# **åœ¨ `setup()` ä¸­ä½¿ç”¨ `props` è¯¦è§£**

åœ¨ Vue 3 çš„ `setup()` ç»„åˆå¼ API (`Composition API`) ä¸­ï¼Œ`props` ç”¨äºæ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„æ•°æ®ã€‚Vue 3 çš„ `setup()` ä½¿ `props` æ›´åŠ ç›´è§‚ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ–°çš„æ³¨æ„äº‹é¡¹ã€‚

---

## **1. `setup(props)` çš„åŸºæœ¬ä½¿ç”¨**

`setup()` çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ `props`ï¼Œå®ƒæ˜¯ä¸€ä¸ª**åªè¯»çš„å“åº”å¼å¯¹è±¡**ï¼Œç”¨äºæ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„å€¼ã€‚

### **ç¤ºä¾‹ï¼šåŸºç¡€ `props` ä¼ é€’**

#### **çˆ¶ç»„ä»¶ (`Parent.vue`)**

```vue
<template>
  <Child message="Hello Vue 3!" />
</template>

<script>
import Child from './Child.vue';

export default {
  components: { Child }
};
</script>
```

#### **å­ç»„ä»¶ (`Child.vue`)**

```vue
<template>
  <p>çˆ¶ç»„ä»¶ä¼ æ¥çš„æ¶ˆæ¯: {{ message }}</p>
</template>

<script>
export default {
  props: {
    message: String
  },
  setup(props) {
    console.log(props.message); // "Hello Vue 3!"
    return { message: props.message };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

1. `setup(props)` ç›´æ¥æ¥æ”¶çˆ¶ç»„ä»¶ä¼ æ¥çš„ `props`ã€‚
2. **`props` æ˜¯å“åº”å¼çš„**ï¼Œå½“ `message` å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨æ›´æ–°ã€‚
3. **`props` æ˜¯åªè¯»çš„**ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ `props.message`ï¼Œå¦åˆ™ Vue ä¼šæŠ›å‡ºè­¦å‘Šã€‚

---

## **2. ç›´æ¥è§£æ„ `props`ï¼ˆè¦å°å¿ƒï¼ï¼‰**

å¦‚æœç›´æ¥ä½¿ç”¨ ES6 è§£æ„ `props`ï¼Œä¼šä¸¢å¤±å…¶å“åº”æ€§ã€‚

### **é”™è¯¯ç¤ºä¾‹ï¼ˆä¸¢å¤±å“åº”æ€§ï¼‰**

```vue
<script>
export default {
  props: {
    message: String
  },
  setup({ message }) { // âŒ ç›´æ¥è§£æ„ï¼Œmessage ä¸æ˜¯å“åº”å¼çš„
    console.log(message); // ä¸æ˜¯å“åº”å¼æ•°æ®
    return { message };
  }
};
</script>
```

> è¿™æ · `message` **ä¸ä¼šåœ¨ `props` å˜åŒ–æ—¶æ›´æ–°**ï¼Œå› ä¸ºè§£æ„èµ‹å€¼ä¼šä¸¢å¤±å“åº”æ€§ã€‚

### **æ­£ç¡®ç¤ºä¾‹ï¼ˆä¿æŒå“åº”æ€§ï¼‰**

```vue
<script>
import { toRefs } from 'vue';

export default {
  props: {
    message: String
  },
  setup(props) {
    const { message } = toRefs(props); // âœ… ä¿æŒå“åº”æ€§
    return { message };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `toRefs(props)` è®© `message` ä»ç„¶ä¿æŒå“åº”å¼ï¼Œä¸ä¼šä¸¢å¤± `props` çš„ reactivityã€‚

---

## **3. ä½¿ç”¨ `defineProps()`ï¼ˆåœ¨ `<script setup>` è¯­æ³•ä¸­ï¼‰**

å¦‚æœä½¿ç”¨ `<script setup>` è¯­æ³•ï¼Œå¯ä»¥ç”¨ `defineProps()` ä»£æ›¿ `props`ã€‚

### **ç¤ºä¾‹ï¼š`defineProps()` æ–¹å¼**

```vue
<template>
  <p>çˆ¶ç»„ä»¶ä¼ æ¥çš„æ¶ˆæ¯: {{ message }}</p>
</template>

<script setup>
const props = defineProps({
  message: String
});

console.log(props.message); // "Hello Vue 3!"
</script>
```

### **ğŸ“Œ è§£æ**

- `defineProps()` åªåœ¨ `<script setup>` è¯­æ³•ä¸­å¯ç”¨ï¼Œä¸”ä¸éœ€è¦ `export default`ã€‚
- `props` ä»ç„¶æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ã€‚

---

## **4. è®¾ç½®é»˜è®¤å€¼**

`props` æ²¡æœ‰ä¼ å€¼æ—¶ï¼Œå¯ä»¥è®¾ç½®é»˜è®¤å€¼ã€‚

### **ç¤ºä¾‹ï¼šä½¿ç”¨ `default` è®¾ç½®é»˜è®¤å€¼**

```vue
<template>
  <p>ç”¨æˆ·å: {{ username }}</p>
</template>

<script>
export default {
  props: {
    username: {
      type: String,
      default: 'æ¸¸å®¢'
    }
  },
  setup(props) {
    return { username: props.username };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- å¦‚æœçˆ¶ç»„ä»¶æœªä¼  `username`ï¼Œ`props.username` é»˜è®¤å€¼ä¸º `'æ¸¸å®¢'`ã€‚

---

## **5. ä¼ é€’å¯¹è±¡ `props`**

å¯ä»¥ä¼ é€’å¯¹è±¡ç±»å‹çš„ `props`ï¼Œå¹¶åœ¨ `setup()` ä¸­è§£æ„ã€‚

### **ç¤ºä¾‹ï¼šå¯¹è±¡ç±»å‹ `props`**

```vue
<template>
  <p>å§“å: {{ user.name }}</p>
  <p>å¹´é¾„: {{ user.age }}</p>
</template>

<script>
import { toRefs } from 'vue';

export default {
  props: {
    user: Object
  },
  setup(props) {
    const { user } = toRefs(props); // ä¿æŒå“åº”æ€§
    return { user };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `toRefs(props)` ç¡®ä¿ `user` ä¿æŒå“åº”æ€§ï¼Œå¦åˆ™ `user` å˜æ›´ä¸ä¼šè§¦å‘æ›´æ–°ã€‚

---

## **6. `props` ä¸ `computed` ç»“åˆ**

å¯ä»¥ä½¿ç”¨ `computed` å¤„ç† `props`ï¼Œç”Ÿæˆ**æ–°çš„è®¡ç®—å±æ€§**ã€‚

### **ç¤ºä¾‹ï¼šè®¡ç®—å±æ€§åŸºäº `props`**

```vue
<template>
  <p>åŸä»·: {{ price }}</p>
  <p>æŠ˜æ‰£ä»·: {{ discountedPrice }}</p>
</template>

<script>
import { computed } from 'vue';

export default {
  props: {
    price: Number
  },
  setup(props) {
    const discountedPrice = computed(() => props.price * 0.9);
    return { discountedPrice };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `computed(() => props.price * 0.9)` åˆ›å»ºæŠ˜æ‰£ä»·ï¼Œ`props.price` å˜æ›´æ—¶ä¼šè‡ªåŠ¨æ›´æ–°ã€‚

---

## **7. `props` ä¸ `watch` ç»“åˆ**

å¯ä»¥ç”¨ `watch` ç›‘å¬ `props` å˜åŒ–ï¼Œå¹¶æ‰§è¡Œæ“ä½œã€‚

### **ç¤ºä¾‹ï¼šç›‘å¬ `props` å˜åŒ–**

```vue
<template>
  <p>å½“å‰è®¡æ•°: {{ count }}</p>
</template>

<script>
import { watch } from 'vue';

export default {
  props: {
    count: Number
  },
  setup(props) {
    watch(() => props.count, (newVal, oldVal) => {
      console.log(`è®¡æ•°å˜åŒ–: ${oldVal} -> ${newVal}`);
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `watch(() => props.count, callback)` ç›‘å¬ `props.count` å˜åŒ–å¹¶æ‰§è¡Œå›è°ƒã€‚

---

## **8. `props` ä¸ `emit` ç»“åˆ**

Vue ç»„ä»¶é€šå¸¸**ä¸èƒ½ç›´æ¥ä¿®æ”¹ `props`**ï¼Œåº”é€šè¿‡ `emit` è®©çˆ¶ç»„ä»¶æ›´æ–° `props`ã€‚

### **ç¤ºä¾‹ï¼šä½¿ç”¨ `emit` æ›´æ–° `props`**

#### **çˆ¶ç»„ä»¶ (`Parent.vue`)**

```vue
<template>
  <Child :count="count" @update-count="count = $event" />
</template>

<script>
import Child from './Child.vue';
import { ref } from 'vue';

export default {
  components: { Child },
  setup() {
    const count = ref(0);
    return { count };
  }
};
</script>
```

#### **å­ç»„ä»¶ (`Child.vue`)**

```vue
<template>
  <p>è®¡æ•°: {{ count }}</p>
  <button @click="updateCount">å¢åŠ </button>
</template>

<script>
export default {
  props: {
    count: Number
  },
  emits: ['update-count'],
  setup(props, { emit }) {
    const updateCount = () => {
      emit('update-count', props.count + 1);
    };

    return { updateCount };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- å­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹ `props.count`ï¼Œåº”ä½¿ç”¨ `emit('update-count', æ–°å€¼)` è®©çˆ¶ç»„ä»¶æ›´æ–°ã€‚

---

## **9. æ€»ç»“**

|åŠŸèƒ½|ä»£ç ç¤ºä¾‹|
|---|---|
|**åŸºç¡€ `props` ä¼ é€’**|`setup(props) { return { message: props.message } }`|
|**ä¿æŒå“åº”æ€§**|`const { message } = toRefs(props);`|
|**é»˜è®¤å€¼**|`default: 'æ¸¸å®¢'`|
|**ç›‘å¬ `props` å˜åŒ–**|`watch(() => props.count, callback)`|
|**`computed` è®¡ç®— `props`**|`computed(() => props.price * 0.9)`|
|**æ›´æ–° `props`ï¼ˆä½¿ç”¨ `emit`ï¼‰**|`emit('update-count', props.count + 1)`|

Vue 3 åœ¨ `setup()` ä¸­ä½¿ç”¨ `props` å˜å¾—æ›´åŠ ç›´è§‚ï¼Œä½†è¦æ³¨æ„ `props` æ˜¯**åªè¯»çš„**ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼