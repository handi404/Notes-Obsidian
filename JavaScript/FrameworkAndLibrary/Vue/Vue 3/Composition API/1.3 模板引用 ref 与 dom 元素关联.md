Template refs 模板引用 ref 与 dom 元素关联 
```vue
<template>
  <div class="home">
    Home
    <p ref="p">My name is {{ name }}, age is {{ age }}</p>
    <button @click="handleClick">click me</button>
  </div>
</template>

<script>
import { ref } from "vue";
export default {
  setup() {
    let name = "Home";
    let age = 25;
    let p = ref(null);
    console.log(p, p.value);//这里的p.value与下面的不同
    const handleClick = (params) => {
      console.log(p, p.value);//
      p.value.textContent = "hello, world";
    };
    return {
      name,
      age,
      handleClick,
      p,
    };
  },
};
</script>
<style></style>
```
很少使用模板引用因为我觉得就像我需要做的所有操作 dom 内容的事情都可以通过其他方式使用 vue 来完成, 但在使用 Composition API 时 ref 还有另一个非常非常重要的作用可以用来使值具有响应性

---

### **Vue 3 中的 `ref` 绑定 DOM 元素（使用 `setup()`）**

在 Vue 3 的 `setup()` 组合式 API 中，`ref` 可以用于获取和操作 DOM 元素。不同于 Vue 2 的 `$refs`，在 Vue 3 中，我们通过 `ref()` 绑定 DOM 元素，并在 `onMounted()` 中操作它。

---

## **1. 基本用法**

在 Vue 3 中，使用 `ref()` 绑定 DOM 元素的步骤：

1. **创建 `ref` 变量**，初始值为 `null`。
2. **在模板中绑定 `ref`**，将其赋值给元素。
3. **在 `onMounted()` 中访问 DOM 元素**。

### **示例：获取 `input` 元素并聚焦**

```vue
<template>
  <input ref="inputRef" type="text" placeholder="自动聚焦" />
</template>

<script>
import { ref, onMounted } from 'vue';

export default {
  setup() {
    const inputRef = ref(null);

    onMounted(() => {
      if (inputRef.value) {
        inputRef.value.focus(); // 在组件挂载后自动聚焦
      }
    });

    return { inputRef };
  }
};
</script>
```

#### **📌 解析**

- `ref(null)`: `inputRef` 绑定 DOM 元素，初始值为 `null`。
- `ref="inputRef"`: 绑定到 `<input>` 元素。
- `onMounted()`: 组件挂载后，`inputRef.value` 指向真实的 DOM 元素，我们可以调用 `focus()` 让输入框自动聚焦。

---

## **2. 绑定多个元素**

当需要管理多个相同类型的元素时，可以使用 `ref([])`，并在 `v-for` 中绑定。

### **示例：管理多个按钮**

```vue
<template>
  <button v-for="(item, index) in 3" :key="index" ref="buttonsRef">
    按钮 {{ index + 1 }}
  </button>
</template>

<script>
import { ref, onMounted } from 'vue';

export default {
  setup() {
    const buttonsRef = ref([]);

    onMounted(() => {
      console.log(buttonsRef.value); // 获取所有按钮 DOM 元素
      buttonsRef.value[0]?.focus(); // 让第一个按钮获取焦点
    });

    return { buttonsRef };
  }
};
</script>
```

#### **📌 解析**

- `ref([])`: `buttonsRef` 绑定多个 DOM 元素，初始值为空数组。
- `ref="buttonsRef"`: 绑定到 `v-for` 生成的所有 `<button>`。
- `buttonsRef.value[0].focus()`: 访问数组中的 DOM 元素并操作。

---

## **3. 操作子组件的 `ref`**

在 Vue 3 中，`ref` 也可以绑定到子组件，从而访问子组件的方法或数据。

### **示例：获取子组件实例并调用方法**

#### **📌 子组件**

```vue
<!-- ChildComponent.vue -->
<template>
  <div>子组件</div>
</template>

<script>
import { defineExpose } from 'vue';

export default {
  setup() {
    const sayHello = () => {
      alert('Hello from Child Component!');
    };

    // 通过 defineExpose 公开方法
    defineExpose({ sayHello });
  }
};
</script>
```

#### **📌 父组件**

```vue
<template>
  <ChildComponent ref="childRef" />
  <button @click="childRef?.sayHello()">调用子组件方法</button>
</template>

<script>
import { ref, onMounted } from 'vue';
import ChildComponent from './ChildComponent.vue';

export default {
  components: { ChildComponent },
  setup() {
    const childRef = ref(null);

    onMounted(() => {
      console.log(childRef.value); // 子组件实例
    });

    return { childRef };
  }
};
</script>
```

#### **📌 解析**

- `ref="childRef"`: 绑定子组件。
- `defineExpose({ sayHello })`: 通过 `defineExpose` 让 `sayHello` 方法可被外部访问。
- `childRef?.sayHello()`: 调用子组件的方法。

---

## **4. `ref` vs `template ref`**

Vue 3 提供了 `template ref` 作为 `ref` 的替代方式，适用于 `setup()` 语法糖的 `<script setup>`。

### **示例：使用 `template ref`**

```vue
<template>
  <input ref="inputRef" type="text" placeholder="自动聚焦" />
</template>

<script setup>
import { ref, onMounted } from 'vue';

const inputRef = ref(null);

onMounted(() => {
  inputRef.value?.focus();
});
</script>
```

#### **📌 解析**

- 直接在 `<script setup>` 定义 `ref`，无需 `return`。
- `template ref` 更简洁，推荐在 `<script setup>` 语法中使用。

---

## **5. 结合事件监听操作 DOM**

可以通过 `ref` 操作 DOM 来监听事件，比如手动触发 `click` 事件。

### **示例：手动触发点击事件**

```vue
<template>
  <button ref="btnRef" @click="handleClick">点击我</button>
</template>

<script setup>
import { ref, onMounted } from 'vue';

const btnRef = ref(null);

const handleClick = () => {
  alert('按钮被点击');
};

onMounted(() => {
  btnRef.value?.click(); // 组件挂载后自动触发点击
});
</script>
```

#### **📌 解析**

- `btnRef.value?.click()` 让按钮在 `onMounted()` 时自动被点击。

---

## **6. 绑定 `canvas`、`video` 等特殊元素**

### **示例：获取 `canvas` 上下文**

```vue
<template>
  <canvas ref="canvasRef" width="200" height="200"></canvas>
</template>

<script setup>
import { ref, onMounted } from 'vue';

const canvasRef = ref(null);

onMounted(() => {
  const ctx = canvasRef.value?.getContext('2d');
  if (ctx) {
    ctx.fillStyle = 'red';
    ctx.fillRect(20, 20, 100, 100);
  }
});
</script>
```

#### **📌 解析**

- `canvasRef.value.getContext('2d')` 获取 `canvas` 上下文并绘制图形。

---

## **总结**

|场景|方式|
|---|---|
|绑定单个 DOM 元素|`const el = ref(null);`|
|绑定多个 DOM 元素|`const els = ref([]);`|
|访问子组件方法|`defineExpose({ method })`|
|`script setup` 语法糖|`ref="elRef"` 直接使用|
|操作 `canvas`、`video`|`elRef.value.getContext('2d')`|

Vue 3 的 `ref` 结合 `setup()` 让 DOM 操作更清晰、更易管理，推荐优先使用 `template ref` 方式。