Home.vue
```vue
<template>
  <div class="home">
    <h1>Home</h1>
    <PostList :posts="posts" v-if="showPosts" />
    <button @click="showPosts = !showPosts">toggle posts</button>
    <button @click="posts.pop()">delete a post</button>
  </div>
</template>

<script>
import { computed, watch, ref, watchEffect } from "vue";
import PostList from "../components/PostList.vue";
export default {
  components: {
    PostList,
  },
  setup() {
    const posts = ref([
      {
        title: "welcome to the blog",
        body: "Lorem ipsum dolor, sit amet consectetur adipisicing elit. Minus quo repudiandae labore iusto ut nisi suscipit, mollitia ex, rem id obcaecati consectetur tenetur commodi doloribus facilis rerum autem beatae ab!",
        id: 1,
      },
      { title: "top 5 css tips", body: "Lorem ipsum", id: 2 },
    ]);
    const showPosts = ref(true);
    return {
      posts,
      showPosts,
    };
  },
};
</script>
<style></style>
```
PostList.vue
```vue
<template>
  <div class="post-list">
    <div v-for="post in posts" :key="post.id">
      <SinglePost :post="post" />
    </div>
  </div>
</template>

<script>
import { onMounted, onUnmounted, onUpdated } from "vue";
import SinglePost from "./SinglePost.vue";
export default {
  props: ["posts"],
  components: {
    SinglePost,
  },
  setup(props) {
    onMounted(() => {
      console.log("component mounted");
    });
    onUnmounted(() => {
      console.log("component unmounted");
    });
    onUpdated(() => {
      console.log("component updated");
    });
  },
};
</script>

<style lang="scss" scoped></style>
```

---

# **åœ¨ `setup()` ä¸­çš„ç”Ÿå‘½å‘¨æœŸé’©å­è¯¦è§£**

Vue 3 çš„ç»„åˆå¼ API (`Composition API`) ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°åœ¨ `setup()` ä¸­ä»¥ä¸åŒçš„æ–¹å¼è¢«ä½¿ç”¨ã€‚ç”Ÿå‘½å‘¨æœŸé’©å­ç”¨äºåœ¨ç»„ä»¶çš„ä¸åŒé˜¶æ®µæ‰§è¡Œä»£ç ï¼Œæ¯”å¦‚ç»„ä»¶åˆ›å»ºã€æ›´æ–°ã€é”€æ¯ç­‰ã€‚

åœ¨ `setup()` ä¸­ï¼Œå¯ä»¥é€šè¿‡`onX` ç³»åˆ—å‡½æ•°æ¥å¤„ç†ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚

---

## **1. `onBeforeMount`**

`onBeforeMount` åœ¨**ç»„ä»¶æŒ‚è½½ä¹‹å‰**è¢«è°ƒç”¨ï¼Œ**DOM å…ƒç´ å°šæœªè¢«æ’å…¥é¡µé¢**ã€‚

### **ç¤ºä¾‹ï¼š`onBeforeMount` ä½¿ç”¨**

```vue
<script>
import { onBeforeMount } from 'vue';

export default {
  setup() {
    onBeforeMount(() => {
      console.log('ç»„ä»¶æŒ‚è½½å‰');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onBeforeMount` åœ¨ç»„ä»¶æŒ‚è½½åˆ° DOM ä¹‹å‰æ‰§è¡Œï¼Œå¯ä»¥ç”¨äºåˆå§‹åŒ–ä¸€äº›æ•°æ®ï¼Œæˆ–è€…æ‰§è¡Œä¸€äº›ä¾èµ–äº DOM çš„æ“ä½œï¼ˆä½†æ­¤æ—¶ DOM å°šæœªå¯ç”¨ï¼‰ã€‚

---

## **2. `onMounted`**

`onMounted` åœ¨**ç»„ä»¶æŒ‚è½½åˆ° DOM å**è¢«è°ƒç”¨ï¼Œ**DOM å…ƒç´ å·²è¢«æ¸²æŸ“åˆ°é¡µé¢**ã€‚

### **ç¤ºä¾‹ï¼š`onMounted` ä½¿ç”¨**

```vue
<script>
import { onMounted } from 'vue';

export default {
  setup() {
    onMounted(() => {
      console.log('ç»„ä»¶æŒ‚è½½å');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onMounted` å¯ä»¥ç”¨äºæ‰§è¡Œ**ä¾èµ–äº DOM çš„æ“ä½œ**ï¼Œæ¯”å¦‚ DOM æŸ¥è¯¢ã€äº‹ä»¶ç»‘å®šç­‰ï¼Œå› ä¸ºæ­¤æ—¶ç»„ä»¶çš„ DOM å·²ç»æ¸²æŸ“å®Œæ¯•ã€‚

---

## **3. `onBeforeUpdate`**

`onBeforeUpdate` åœ¨**ç»„ä»¶æ•°æ®æ›´æ–°ä¹‹å‰**è¢«è°ƒç”¨ï¼Œ**DOM å°šæœªæ›´æ–°**ã€‚

### **ç¤ºä¾‹ï¼š`onBeforeUpdate` ä½¿ç”¨**

```vue
<script>
import { onBeforeUpdate } from 'vue';

export default {
  setup() {
    onBeforeUpdate(() => {
      console.log('æ•°æ®æ›´æ–°å‰');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onBeforeUpdate` åœ¨ç»„ä»¶æ›´æ–°å‰è§¦å‘ï¼Œé€‚åˆåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œæ¯”å¦‚ç¼“å­˜æ—§å€¼ï¼Œæˆ–è€…æ‰§è¡Œä¸€äº›æ•°æ®éªŒè¯ç­‰ã€‚

---

## **4. `onUpdated`**

`onUpdated` åœ¨**ç»„ä»¶æ•°æ®æ›´æ–°å**è¢«è°ƒç”¨ï¼Œ**DOM æ›´æ–°å®Œæ¯•**ã€‚

### **ç¤ºä¾‹ï¼š`onUpdated` ä½¿ç”¨**

```vue
<script>
import { onUpdated } from 'vue';

export default {
  setup() {
    onUpdated(() => {
      console.log('æ•°æ®æ›´æ–°å');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onUpdated` åœ¨ç»„ä»¶æ›´æ–°å®Œæˆåè§¦å‘ï¼Œé€‚åˆç”¨äºæ“ä½œæ›´æ–°åçš„ DOMï¼Œæˆ–è€…æ‰§è¡Œä¾èµ–äºç»„ä»¶æ¸²æŸ“åçš„å…¶ä»–ä»»åŠ¡ã€‚

---

## **5. `onBeforeUnmount`**

`onBeforeUnmount` åœ¨**ç»„ä»¶å¸è½½ä¹‹å‰**è¢«è°ƒç”¨ï¼Œ**DOM å°šæœªè¢«é”€æ¯**ã€‚

### **ç¤ºä¾‹ï¼š`onBeforeUnmount` ä½¿ç”¨**

```vue
<script>
import { onBeforeUnmount } from 'vue';

export default {
  setup() {
    onBeforeUnmount(() => {
      console.log('ç»„ä»¶å¸è½½å‰');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onBeforeUnmount` å¯ä»¥ç”¨äºæ¸…ç†å·¥ä½œï¼Œ**è§£ç»‘äº‹ä»¶**ã€**å–æ¶ˆå®šæ—¶å™¨**ã€**æ¸…ç†ç½‘ç»œè¯·æ±‚**ç­‰ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚

---

## **6. `onUnmounted`**

`onUnmounted` åœ¨**ç»„ä»¶å¸è½½ä¹‹å**è¢«è°ƒç”¨ï¼Œ**DOM å…ƒç´ å·²è¢«é”€æ¯**ã€‚

### **ç¤ºä¾‹ï¼š`onUnmounted` ä½¿ç”¨**

```vue
<script>
import { onUnmounted } from 'vue';

export default {
  setup() {
    onUnmounted(() => {
      console.log('ç»„ä»¶å¸è½½å');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onUnmounted` ç”¨äºåšç»„ä»¶å¸è½½åçš„æ¸…ç†å·¥ä½œï¼Œé€šå¸¸ç”¨äºè§£é™¤å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ç­‰ã€‚

---

## **7. `onActivated`**

`onActivated` åœ¨**ç»„ä»¶æ¿€æ´»æ—¶**è¢«è°ƒç”¨ï¼Œé€šå¸¸ç”¨äº `keep-alive` åŒ…è£¹çš„ç»„ä»¶ã€‚ç»„ä»¶åœ¨ç¼“å­˜æ—¶ä¼šè¢«æš‚åœï¼Œè€Œåœ¨å†æ¬¡æ¿€æ´»æ—¶ä¼šè§¦å‘æ­¤é’©å­ã€‚

### **ç¤ºä¾‹ï¼š`onActivated` ä½¿ç”¨**

```vue
<script>
import { onActivated } from 'vue';

export default {
  setup() {
    onActivated(() => {
      console.log('ç»„ä»¶æ¿€æ´»');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onActivated` åªåœ¨ç»„ä»¶è¢« `keep-alive` ç¼“å­˜å¹¶å†æ¬¡æ¿€æ´»æ—¶è§¦å‘ï¼Œé€‚åˆç”¨æ¥æ‰§è¡Œåœ¨ç»„ä»¶æ˜¾ç¤ºæ—¶çš„æ“ä½œã€‚

---

## **8. `onDeactivated`**

`onDeactivated` åœ¨**ç»„ä»¶åœç”¨æ—¶**è¢«è°ƒç”¨ï¼Œé€šå¸¸ç”¨äº `keep-alive` ç¼“å­˜çš„ç»„ä»¶ã€‚

### **ç¤ºä¾‹ï¼š`onDeactivated` ä½¿ç”¨**

```vue
<script>
import { onDeactivated } from 'vue';

export default {
  setup() {
    onDeactivated(() => {
      console.log('ç»„ä»¶åœç”¨');
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onDeactivated` åªåœ¨ç»„ä»¶è¢« `keep-alive` ç¼“å­˜å¹¶åœç”¨æ—¶è§¦å‘ï¼Œé€‚åˆåšä¸€äº›ç¼“å­˜æ•°æ®çš„æ¸…ç†å·¥ä½œã€‚

---

## **9. `onErrorCaptured`**

`onErrorCaptured` ç”¨äº**æ•è·å­ç»„ä»¶çš„é”™è¯¯**ï¼Œå¹¶å¤„ç†é”™è¯¯ã€‚

### **ç¤ºä¾‹ï¼š`onErrorCaptured` ä½¿ç”¨**

```vue
<script>
import { onErrorCaptured } from 'vue';

export default {
  setup() {
    onErrorCaptured((err, vm, info) => {
      console.error('æ•è·é”™è¯¯:', err);
      return false; // é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­
    });

    return {};
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `onErrorCaptured` å¯ä»¥æ•è·ç»„ä»¶å†…éƒ¨æˆ–è€…å­ç»„ä»¶çš„é”™è¯¯ï¼Œè¿”å› `false` å¯ä»¥é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­ã€‚
- é€‚åˆç”¨äºå…¨å±€é”™è¯¯å¤„ç†ã€‚

---

## **10. æ€»ç»“ï¼šåœ¨ `setup()` ä¸­çš„ç”Ÿå‘½å‘¨æœŸé’©å­**

|ç”Ÿå‘½å‘¨æœŸé’©å­|è¯´æ˜|è§¦å‘æ—¶æœº|
|---|---|---|
|`onBeforeMount`|ç»„ä»¶æŒ‚è½½å‰|ç»„ä»¶åˆ›å»ºå®Œæˆï¼Œå°šæœªæŒ‚è½½åˆ° DOM|
|`onMounted`|ç»„ä»¶æŒ‚è½½å|ç»„ä»¶æŒ‚è½½åˆ° DOM å|
|`onBeforeUpdate`|æ•°æ®æ›´æ–°å‰|ç»„ä»¶æ›´æ–°å‰|
|`onUpdated`|æ•°æ®æ›´æ–°å|ç»„ä»¶æ›´æ–°å|
|`onBeforeUnmount`|ç»„ä»¶å¸è½½å‰|ç»„ä»¶é”€æ¯å‰|
|`onUnmounted`|ç»„ä»¶å¸è½½å|ç»„ä»¶é”€æ¯å|
|`onActivated`|ç»„ä»¶æ¿€æ´»|ç»„ä»¶è¢« `keep-alive` ç¼“å­˜å¹¶æ¿€æ´»|
|`onDeactivated`|ç»„ä»¶åœç”¨|ç»„ä»¶è¢« `keep-alive` ç¼“å­˜å¹¶åœç”¨|
|`onErrorCaptured`|é”™è¯¯æ•è·|æ•è·å­ç»„ä»¶é”™è¯¯|

---

åœ¨ `setup()` ä¸­ä½¿ç”¨è¿™äº›ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç®¡ç†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¤„ç†æ•°æ®å˜åŒ–ã€DOM æ›´æ–°ã€äº‹ä»¶ç»‘å®šä¸æ¸…ç†ç­‰ã€‚