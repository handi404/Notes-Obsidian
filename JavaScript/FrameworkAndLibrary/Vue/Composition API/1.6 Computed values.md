å®šä¹‰**åŸºäºå“åº”å¼æ•°æ®çš„æ´¾ç”Ÿå€¼**ï¼Œåœ¨æ•°æ®ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°ï¼ŒåŒæ—¶å…·å¤‡ç¼“å­˜æœºåˆ¶ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—ã€‚(å°±æ˜¯**æ ¹æ®å·²æœ‰æ•°æ®è®¡ç®—å‡ºä¸€ä¸ªæ–°æ•°æ®**ï¼Œè€Œä¸”åªæœ‰å½“åŸæ•°æ®å˜äº†ï¼Œæ‰ä¼šé‡æ–°è®¡ç®—ï¼ŒèŠ‚çœæ€§èƒ½ã€‚)
```vue
<template>
  <div class="home">
    <h1>Home</h1>
    <input type="text" v-model="search" />
    <p>search term - {{ search }}</p>
    <div v-for="name in matchingNames" :key="name">
      {{ name }}
    </div>
  </div>
</template>

<script>
import { computed, reactive, ref } from "vue";
export default {
  setup() {
    const names = ref(["John", "Mario", "Jane", "Doe", "Foo", "Bar"]);
    const search = ref("");
    const matchingNames = computed(() => {
      return names.value.filter((name) => name.includes(search.value));
    });
    return {
      names,
      search,
      matchingNames,
    };
  },
};
</script>
<style></style>
```

---

# **Vue 3 Computed è¯¦è§£ï¼ˆä½¿ç”¨ `setup()` å½¢å¼ï¼‰**

åœ¨ Vue 3 ç»„åˆå¼ API (`Composition API`) ä¸­ï¼Œ`computed`ï¼ˆè®¡ç®—å±æ€§ï¼‰ç”¨äºåŸºäº**ç°æœ‰æ•°æ®**æ´¾ç”Ÿå‡ºæ–°çš„æ•°æ®ï¼Œå¹¶åœ¨ä¾èµ–æ•°æ®å˜æ›´æ—¶**è‡ªåŠ¨æ›´æ–°**ã€‚å®ƒå¯ä»¥æœ‰æ•ˆä¼˜åŒ–æ€§èƒ½ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

---

## **1. `computed` çš„åŸºæœ¬ç”¨æ³•**

åœ¨ `setup()` ä¸­ï¼Œ`computed` åˆ›å»ºçš„è®¡ç®—å±æ€§æ˜¯**å“åº”å¼**çš„ï¼Œä¼šè‡ªåŠ¨ç›‘å¬ä¾èµ–çš„ `ref` å˜é‡ï¼Œå¹¶åœ¨å®ƒä»¬å˜åŒ–æ—¶æ›´æ–°å€¼ã€‚

### **ç¤ºä¾‹ï¼šåŸºæœ¬è®¡ç®—å±æ€§**

```vue
<template>
  <p>åŸä»·: {{ price }}</p>
  <p>æŠ˜æ‰£ä»·: {{ discountedPrice }}</p>
  <button @click="increasePrice">æ¶¨ä»·</button>
</template>

<script>
import { ref, computed } from 'vue';

export default {
  setup() {
    const price = ref(100); // åŸä»·
    const discountedPrice = computed(() => price.value * 0.9); // è®¡ç®—æŠ˜æ‰£ä»·

    const increasePrice = () => {
      price.value += 10;
    };

    return { price, discountedPrice, increasePrice };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `computed(() => price.value * 0.9)` å®šä¹‰ `discountedPrice` è®¡ç®—å±æ€§ã€‚
- `discountedPrice` **ä¾èµ– `price.value`**ï¼Œå½“ `price` å˜åŒ–æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ›´æ–°ã€‚
- `computed` **å†…éƒ¨æœ‰ç¼“å­˜æœºåˆ¶**ï¼Œå¦‚æœ `price` æ²¡å˜ï¼Œ`discountedPrice` ä¸ä¼šé‡æ–°è®¡ç®—ã€‚

---

## **2. `computed` VS `methods`**

|æ–¹å¼|è®¡ç®—æ–¹å¼|æ˜¯å¦ç¼“å­˜|é€‚ç”¨åœºæ™¯|
|---|---|---|---|
|**computed**|ä¾èµ–æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨è®¡ç®—|**æ˜¯**|é€‚ç”¨äºè®¡ç®—å¼€é”€å¤§ã€ä¾èµ–æ•°æ®ä¼šæ”¹å˜çš„æƒ…å†µ|
|**methods**|æ¯æ¬¡è°ƒç”¨æ—¶éƒ½é‡æ–°è®¡ç®—|**å¦**|é€‚ç”¨äºä¸ä¾èµ–æ•°æ®çš„è®¡ç®—|

### **ç¤ºä¾‹ï¼šå¯¹æ¯” `computed` ä¸ `methods`**

```vue
<template>
  <p>Computed: {{ computedResult }}</p>
  <p>Method: {{ getMethodResult() }}</p>
  <button @click="count++">å¢åŠ </button>
</template>

<script>
import { ref, computed } from 'vue';

export default {
  setup() {
    const count = ref(0);

    // computed æ–¹å¼ï¼ˆæœ‰ç¼“å­˜ï¼‰
    const computedResult = computed(() => {
      console.log("Computed è®¡ç®—");
      return count.value * 2;
    });

    // methods æ–¹å¼ï¼ˆæ— ç¼“å­˜ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½æ‰§è¡Œï¼‰
    const getMethodResult = () => {
      console.log("Method è®¡ç®—");
      return count.value * 2;
    };

    return { count, computedResult, getMethodResult };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `computed` åªæœ‰ `count` å˜åŒ–æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ï¼Œ**ä¸ä¼šåœ¨æ¯æ¬¡è°ƒç”¨æ—¶é‡å¤è®¡ç®—**ã€‚
- `methods` **æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œ**ï¼Œæ€§èƒ½è¾ƒä½ã€‚

---

## **3. è®¡ç®—å±æ€§çš„ `getter` å’Œ `setter`**

`computed` é»˜è®¤æ˜¯**åªè¯»**çš„ï¼Œä½†å¯ä»¥æä¾› `getter` å’Œ `setter` è®©å…¶å˜ä¸ºå¯å†™ã€‚

### **ç¤ºä¾‹ï¼šå¯å†™è®¡ç®—å±æ€§**

```vue
<template>
  <p>æ‘„æ°æ¸©åº¦: {{ celsius }}</p>
  <p>åæ°æ¸©åº¦: <input v-model="fahrenheit" /></p>
</template>

<script>
import { ref, computed } from 'vue';

export default {
  setup() {
    const celsius = ref(0);

    const fahrenheit = computed({
      get: () => (celsius.value * 9) / 5 + 32, // è¯»å–æ—¶è½¬æ¢ä¸ºåæ°åº¦
      set: (newValue) => {
        celsius.value = ((newValue - 32) * 5) / 9; // è®¾ç½®æ—¶è½¬æ¢å›æ‘„æ°åº¦
      }
    });

    return { celsius, fahrenheit };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `computed({ get, set })` åˆ›å»º**å¯è¯»å†™**è®¡ç®—å±æ€§ã€‚
- `fahrenheit` ç»‘å®š `input`ï¼Œè¾“å…¥å€¼å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–° `celsius`ã€‚
- `celsius` å˜æ›´æ—¶ï¼Œ`fahrenheit` ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚

---

## **4. è®¡ç®—å±æ€§ä¾èµ–å¤šä¸ª `ref`**

`computed` å¯ä»¥ä¾èµ–å¤šä¸ª `ref` æ•°æ®ã€‚

### **ç¤ºä¾‹ï¼šä¾èµ–å¤šä¸ª `ref`**

```vue
<template>
  <p>å§“å: {{ fullName }}</p>
  <button @click="updateName">ä¿®æ”¹å§“</button>
</template>

<script>
import { ref, computed } from 'vue';

export default {
  setup() {
    const firstName = ref('å¼ ');
    const lastName = ref('ä¸‰');

    const fullName = computed(() => `${firstName.value} ${lastName.value}`);

    const updateName = () => {
      firstName.value = 'æ';
    };

    return { fullName, updateName };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `computed(() => firstName.value + lastName.value)` ç›‘å¬ `firstName` å’Œ `lastName`ã€‚
- ä¿®æ”¹ `firstName.value` æ—¶ï¼Œ`fullName` ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚

---

## **5. `computed` ç»“åˆ `watch`**

å¦‚æœéœ€è¦åœ¨**è®¡ç®—å±æ€§å˜åŒ–æ—¶æ‰§è¡Œé¢å¤–æ“ä½œ**ï¼Œå¯ä»¥ä½¿ç”¨ `watch` ç›‘å¬ `computed` å€¼ã€‚

### **ç¤ºä¾‹ï¼šç›‘å¬ `computed`**

```vue
<script>
import { ref, computed, watch } from 'vue';

export default {
  setup() {
    const count = ref(0);

    const doubleCount = computed(() => count.value * 2);

    watch(doubleCount, (newValue, oldValue) => {
      console.log(`doubleCount å˜åŒ–: ${oldValue} -> ${newValue}`);
    });

    return { count, doubleCount };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- `watch(doubleCount, callback)` ç›‘å¬ `computed` å€¼çš„å˜åŒ–ã€‚
- åªæœ‰ `count` å˜åŒ–å¯¼è‡´ `doubleCount` å˜æ›´æ—¶ï¼Œ`watch` æ‰ä¼šè§¦å‘ã€‚

---

## **6. `computed` VS `watch`**

|ç‰¹æ€§|`computed`|`watch`|
|---|---|---|
|**æ˜¯å¦è¿”å›å€¼**|è¿”å›æ–°å€¼|ç›‘å¬å˜åŒ–ï¼Œé€šå¸¸ä¸è¿”å›|
|**æ˜¯å¦æœ‰ç¼“å­˜**|**æœ‰ç¼“å­˜**|æ— ç¼“å­˜ï¼Œæ¯æ¬¡ä¾èµ–å˜æ›´éƒ½ä¼šè§¦å‘|
|**é€‚ç”¨åœºæ™¯**|éœ€è¦æ´¾ç”Ÿæ–°å€¼çš„æƒ…å†µ|ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆå¦‚ API è°ƒç”¨ï¼‰|

---

## **7. `computed` åœ¨ `template` ä¸­çš„ä½¿ç”¨**

`computed` ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œæ— éœ€ `.value`ã€‚

```vue
<template>
  <p>ä»·æ ¼: {{ discountedPrice }}</p>
</template>

<script>
import { ref, computed } from 'vue';

export default {
  setup() {
    const price = ref(100);
    const discountedPrice = computed(() => price.value * 0.9);

    return { discountedPrice };
  }
};
</script>
```

**Vue è‡ªåŠ¨è§£åŒ… `computed` çš„ `.value`**ï¼Œæ‰€ä»¥æ¨¡æ¿ä¸­å¯ç›´æ¥ä½¿ç”¨ `discountedPrice`ã€‚

---

## **8. æ€»ç»“**

|åŠŸèƒ½|ä»£ç ç¤ºä¾‹|
|---|---|
|**åŸºæœ¬è®¡ç®—å±æ€§**|`computed(() => count.value * 2);`|
|**å¯è¯»å†™è®¡ç®—å±æ€§**|`computed({ get, set });`|
|**ä¾èµ–å¤šä¸ªæ•°æ®**|`computed(() => firstName.value + lastName.value);`|
|**ç›‘å¬ `computed`**|`watch(computedVar, callback);`|

`computed` é€‚ç”¨äºæ´¾ç”Ÿæ–°æ•°æ®ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Œå¹¶ä¸” Vue å†…éƒ¨æä¾›**ç¼“å­˜æœºåˆ¶**ï¼Œå¯ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚