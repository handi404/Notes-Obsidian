åœ¨ Vue 3 ä¸­ï¼Œå­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®çš„å¸¸è§æ–¹æ³•åŒ…æ‹¬ **è‡ªå®šä¹‰äº‹ä»¶ (`emit`)ã€`defineModel()`ã€`ref` ä¼ é€’å’Œ `provide/inject`**ã€‚ä¸‹é¢è¯¦ç»†è®²è§£å¦‚ä½•åœ¨ `setup()` ä¸­ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚

---

# **1. é€šè¿‡ `emit` äº‹ä»¶ä¼ é€’æ•°æ®ï¼ˆæ¨èï¼‰**

Vue æä¾› `emit` æ–¹æ³•ï¼Œå­ç»„ä»¶å¯ä»¥é€šè¿‡ `emit` è§¦å‘äº‹ä»¶ï¼Œå¹¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶ã€‚

### **ç¤ºä¾‹**

**å­ç»„ä»¶ï¼ˆ`Child.vue`ï¼‰**

```vue
<template>
  <div>
    <input v-model="message" placeholder="è¾“å…¥ä¿¡æ¯" />
    <button @click="sendMessage">å‘é€åˆ°çˆ¶ç»„ä»¶</button>
  </div>
</template>

<script>
import { ref, defineEmits } from 'vue';

export default {
  setup(props, { emit }) {
    const message = ref('');

    const sendMessage = () => {
      emit('update-message', message.value); // è§¦å‘äº‹ä»¶ï¼Œä¼ é€’æ•°æ®
    };

    return { message, sendMessage };
  }
};
</script>
```

---

**çˆ¶ç»„ä»¶ï¼ˆ`Parent.vue`ï¼‰**

```vue
<template>
  <div>
    <h3>çˆ¶ç»„ä»¶</h3>
    <p>æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯: {{ parentMessage }}</p>
    <Child @update-message="handleUpdateMessage" />
  </div>
</template>

<script>
import { ref } from 'vue';
import Child from './Child.vue';

export default {
  components: { Child },
  setup() {
    const parentMessage = ref('');

    const handleUpdateMessage = (message) => {
      parentMessage.value = message;
    };

    return { parentMessage, handleUpdateMessage };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- **`emit('update-message', message.value)`**ï¼šå­ç»„ä»¶è§¦å‘ `update-message` äº‹ä»¶ï¼Œä¼ é€’æ•°æ®åˆ°çˆ¶ç»„ä»¶ã€‚
- **`@update-message="handleUpdateMessage"`**ï¼šçˆ¶ç»„ä»¶ç›‘å¬ `update-message` äº‹ä»¶ï¼Œå¹¶è°ƒç”¨ `handleUpdateMessage` æ–¹æ³•æ›´æ–°æ•°æ®ã€‚

---

# **2. é€šè¿‡ `defineModel()` å®ç°åŒå‘ç»‘å®šï¼ˆVue 3.4+ æ¨èï¼‰**

Vue 3.4 å¼•å…¥äº† `defineModel()`ï¼Œè®©å­ç»„ä»¶å¯ä»¥ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚

### **ç¤ºä¾‹**

**å­ç»„ä»¶ï¼ˆ`Child.vue`ï¼‰**

```vue
<template>
  <input v-model="message" placeholder="è¾“å…¥ä¿¡æ¯" />
</template>

<script setup>
import { defineModel } from 'vue';

// å®šä¹‰ä¸€ä¸ª model å˜é‡ï¼Œè‡ªåŠ¨ç»‘å®šåˆ°çˆ¶ç»„ä»¶
const message = defineModel();
</script>
```

---

**çˆ¶ç»„ä»¶ï¼ˆ`Parent.vue`ï¼‰**

```vue
<template>
  <div>
    <h3>çˆ¶ç»„ä»¶</h3>
    <p>æ¥è‡ªå­ç»„ä»¶çš„ä¿¡æ¯: {{ parentMessage }}</p>
    <Child v-model="parentMessage" />
  </div>
</template>

<script setup>
import { ref } from 'vue';
import Child from './Child.vue';

const parentMessage = ref('');
</script>
```

### **ğŸ“Œ è§£æ**

- `defineModel()` **è®©å­ç»„ä»¶çš„ `message` è‡ªåŠ¨ç»‘å®šåˆ°çˆ¶ç»„ä»¶çš„ `parentMessage`**ï¼Œä¿®æ”¹ `message` ä¼šåŒæ­¥æ›´æ–° `parentMessage`ã€‚
- **æ›´ç®€å•æ˜“ç”¨**ï¼Œæ— éœ€ `emit`ã€‚

---

# **3. é€šè¿‡ `ref` ä¼ é€’å­ç»„ä»¶å®ä¾‹**

å¦‚æœçˆ¶ç»„ä»¶éœ€è¦ç›´æ¥è®¿é—®å­ç»„ä»¶çš„æ–¹æ³•æˆ–æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ `ref` ç»‘å®šå­ç»„ä»¶ã€‚

### **ç¤ºä¾‹**

**å­ç»„ä»¶ï¼ˆ`Child.vue`ï¼‰**

```vue
<template>
  <div>
    <p>å­ç»„ä»¶æ¶ˆæ¯: {{ message }}</p>
  </div>
</template>

<script>
import { ref, defineExpose } from 'vue';

export default {
  setup() {
    const message = ref('å­ç»„ä»¶çš„æ•°æ®');

    // è®©çˆ¶ç»„ä»¶èƒ½è®¿é—®è¿™ä¸ªæ•°æ®
    defineExpose({ message });

    return { message };
  }
};
</script>
```

---

**çˆ¶ç»„ä»¶ï¼ˆ`Parent.vue`ï¼‰**

```vue
<template>
  <div>
    <h3>çˆ¶ç»„ä»¶</h3>
    <p>å­ç»„ä»¶çš„æ•°æ®: {{ childRef?.message }}</p>
    <Child ref="childRef" />
    <button @click="updateMessage">æ›´æ–°å­ç»„ä»¶æ•°æ®</button>
  </div>
</template>

<script>
import { ref } from 'vue';
import Child from './Child.vue';

export default {
  components: { Child },
  setup() {
    const childRef = ref(null);

    const updateMessage = () => {
      if (childRef.value) {
        childRef.value.message = 'çˆ¶ç»„ä»¶ä¿®æ”¹åçš„æ•°æ®';
      }
    };

    return { childRef, updateMessage };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- **`ref="childRef"`**ï¼šçˆ¶ç»„ä»¶é€šè¿‡ `ref` è·å–å­ç»„ä»¶å®ä¾‹ã€‚
- **`defineExpose({ message })`**ï¼šè®©çˆ¶ç»„ä»¶èƒ½å¤Ÿè®¿é—® `message`ï¼Œå¦åˆ™ `message` åœ¨ `setup()` å†…éƒ¨ä¸å¯è§ã€‚
- **`childRef.value.message`**ï¼šçˆ¶ç»„ä»¶å¯ä»¥ç›´æ¥ä¿®æ”¹å­ç»„ä»¶çš„æ•°æ®ã€‚

---

# **4. é€šè¿‡ `provide/inject` å…±äº«æ•°æ®**

å¦‚æœæ•°æ®éœ€è¦åœ¨å¤šä¸ªå±‚çº§ç»„ä»¶é—´å…±äº«ï¼Œ`provide/inject` æ˜¯æ›´åˆé€‚çš„æ–¹æ¡ˆã€‚

### **ç¤ºä¾‹**

**ç¥–ç»„ä»¶ï¼ˆ`Parent.vue`ï¼‰**

```vue
<template>
  <div>
    <h3>çˆ¶ç»„ä»¶</h3>
    <Child />
  </div>
</template>

<script>
import { ref, provide } from 'vue';
import Child from './Child.vue';

export default {
  components: { Child },
  setup() {
    const message = ref('ç¥–ç»„ä»¶çš„æ¶ˆæ¯');
    
    // è®©æ‰€æœ‰å­ç»„ä»¶éƒ½èƒ½è®¿é—® message
    provide('message', message);

    return { message };
  }
};
</script>
```

---

**å­ç»„ä»¶ï¼ˆ`Child.vue`ï¼‰**

```vue
<template>
  <div>
    <p>å­ç»„ä»¶æ¥æ”¶åˆ°çš„æ¶ˆæ¯: {{ message }}</p>
  </div>
</template>

<script>
import { inject } from 'vue';

export default {
  setup() {
    const message = inject('message'); // è·å–ç¥–ç»„ä»¶æä¾›çš„æ•°æ®

    return { message };
  }
};
</script>
```

### **ğŸ“Œ è§£æ**

- **`provide('message', message)`**ï¼šçˆ¶ç»„ä»¶æä¾› `message` å˜é‡ï¼Œä¾›æ‰€æœ‰å­ç»„ä»¶ä½¿ç”¨ã€‚
- **`inject('message')`**ï¼šå­ç»„ä»¶è·å– `message` å¹¶æ˜¾ç¤ºã€‚

---

# **æ€»ç»“**

|æ–¹å¼|é€‚ç”¨åœºæ™¯|ä¼˜åŠ¿|ä»£ç ç®€æ´åº¦|
|---|---|---|---|
|**`emit` äº‹ä»¶**|é€‚ç”¨äºå•ä¸ªå­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®|å®˜æ–¹æ¨èï¼Œå•å‘æ•°æ®æµæ¸…æ™°|â­â­â­|
|**`defineModel()`**|Vue 3.4+ åŒå‘ç»‘å®š|ä»£ç æ›´ç®€å•ï¼Œé¿å… `emit`|â­â­â­â­â­|
|**`ref` ä¼ é€’ç»„ä»¶å®ä¾‹**|éœ€è¦çˆ¶ç»„ä»¶è®¿é—®å­ç»„ä»¶æ–¹æ³•/æ•°æ®|çµæ´»ï¼Œä½†å¯èƒ½å¯¼è‡´è€¦åˆ|â­â­|
|**`provide/inject`**|å¤šå±‚çº§ç»„ä»¶å…±äº«æ•°æ®|é€‚ç”¨äºæ·±å±‚ç»„ä»¶ä¼ é€’|â­â­â­â­|

---

# **æ¨èä½¿ç”¨**

1. **å•å‘æ•°æ®ä¼ é€’** â†’ `emit`ï¼ˆVue 3.4+ æ¨è `defineModel()`ï¼‰
2. **è®¿é—®å­ç»„ä»¶æ–¹æ³•æˆ–æ•°æ®** â†’ `ref` + `defineExpose()`
3. **æ·±å±‚ç»„ä»¶å…±äº«æ•°æ®** â†’ `provide/inject`

é€‰æ‹©åˆé€‚çš„æ–¹å¼å¯ä»¥æé«˜ç»„ä»¶çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ï¼ğŸš€