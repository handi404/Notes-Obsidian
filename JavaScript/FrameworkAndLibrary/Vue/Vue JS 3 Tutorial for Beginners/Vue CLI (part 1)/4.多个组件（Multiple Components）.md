在 Vue 3 中，创建和管理多个组件（Multiple Components）是构建复杂应用的核心部分。多个组件可以通过嵌套、父子关系、通信和组合等方式互相协作。接下来我们详细讲解 Vue 3 中如何使用多个组件，包括组件定义、组件之间的通信、插槽和组合等内容。

### 1. **组件的定义和注册**

在 Vue 3 中，组件是 UI 的独立块。每个组件封装了自己的逻辑、样式和模板。我们可以将组件分为全局注册和局部注册。

#### **局部注册**
局部注册是指组件只在某个父组件中使用，在父组件中通过 `components` 选项进行注册。

##### **示例：局部注册组件**
```vue
<!-- ParentComponent.vue -->
<template>
  <div>
    <ChildComponent />
  </div>
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';  // 导入子组件

</script>
```

```vue
<!-- ChildComponent.vue -->
<template>
  <div>
    I am a child component!
  </div>
</template>

<script setup>
</script>
```

在 `ParentComponent.vue` 中，我们导入并注册了 `ChildComponent`，然后在模板中使用它。

#### **全局注册**
全局注册是指在应用的全局范围内注册组件，所有组件都可以使用它。可以在应用创建时通过 `app.component()` 方法进行注册。

##### **示例：全局注册组件**
```js
// main.js
import { createApp } from 'vue';
import App from './App.vue';
import GlobalComponent from './components/GlobalComponent.vue';

const app = createApp(App);
app.component('GlobalComponent', GlobalComponent);  // 全局注册组件
app.mount('#app');
```

```vue
<!-- 在任何地方使用 GlobalComponent -->
<template>
  <GlobalComponent />
</template>
```

### 2. **父子组件通信**

在 Vue 3 中，父子组件之间的通信主要通过 `props` 和 `emits` 来实现。

#### **父组件向子组件传递数据：`props`**
`props` 是父组件传递给子组件的数据。在子组件中，通过 `defineProps()` 来接收这些数据。

##### **示例：使用 `props`**
```vue
<!-- ParentComponent.vue -->
<template>
  <ChildComponent message="Hello from Parent!" />
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';
</script>
```

```vue
<!-- ChildComponent.vue -->
<template>
  <div>{{ message }}</div> <!-- 通过 props 接收并显示父组件传递的数据 -->
</template>

<script setup>
const props = defineProps({
  message: String
});
</script>
```

在这个例子中，父组件通过 `props` 向子组件传递数据，子组件通过 `defineProps()` 接收并展示它。

#### **子组件向父组件传递数据：`emits`**
子组件可以通过事件（`emit`）向父组件传递数据。在子组件中，通过 `emit()` 触发事件，父组件通过 `v-on` 或 `@` 监听事件。

##### **示例：使用 `emit`**
```vue
<!-- ParentComponent.vue -->
<template>
  <ChildComponent @customEvent="handleCustomEvent" />
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';

function handleCustomEvent(payload) {
  console.log('Received from child:', payload);
}
</script>
```

```vue
<!-- ChildComponent.vue -->
<template>
  <button @click="sendEvent">Click me</button>
</template>

<script setup>
const emit = defineEmits(['customEvent']);

function sendEvent() {
  emit('customEvent', 'Hello from Child!');  // 发送事件到父组件
}
</script>
```

### 3. **插槽（Slots）**

Vue 3 中的插槽用于在子组件的模板中渲染父组件提供的内容。插槽提供了高度灵活的方式让父组件定制子组件的内容。

#### **默认插槽**
子组件中可以定义默认插槽，用于放置父组件传递的内容。

##### **示例：默认插槽**
```vue
<!-- ParentComponent.vue -->
<template>
  <ChildComponent>
    <p>This is content from the parent.</p> <!-- 插槽内容 -->
  </ChildComponent>
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';
</script>
```

```vue
<!-- ChildComponent.vue -->
<template>
  <div>
    <slot /> <!-- 插槽位置，渲染父组件传递的内容 -->
  </div>
</template>

<script setup>
</script>
```

#### **具名插槽**
具名插槽允许在子组件中使用多个不同的插槽，每个插槽有一个唯一的名称，父组件通过指定名称传递内容。

##### **示例：具名插槽**
```vue
<!-- ParentComponent.vue -->
<template>
  <ChildComponent>
    <template v-slot:header>
      <h1>Header Content</h1>
    </template>
    <template v-slot:footer>
      <p>Footer Content</p>
    </template>
  </ChildComponent>
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';
</script>
```

```vue
<!-- ChildComponent.vue -->
<template>
  <div>
    <slot name="header" /> <!-- 渲染 header 插槽内容 -->
    <slot />              <!-- 默认插槽 -->
    <slot name="footer" /> <!-- 渲染 footer 插槽内容 -->
  </div>
</template>

<script setup>
</script>
```

### 4. **动态组件**

Vue 3 提供了 `<component>` 标签，可以动态地根据传入的 `is` 属性渲染不同的组件。

#### **示例：动态组件**
```vue
<template>
  <component :is="currentComponent"></component>
  
  <button @click="switchComponent">Switch Component</button>
</template>

<script setup>
import ComponentA from './ComponentA.vue';
import ComponentB from './ComponentB.vue';

const currentComponent = ref('ComponentA');

function switchComponent() {
  currentComponent.value = currentComponent.value === 'ComponentA' ? 'ComponentB' : 'ComponentA';
}
</script>
```

在这个例子中，按钮点击后会在 `ComponentA` 和 `ComponentB` 之间切换显示。

### 5. **组合式 API 和多个组件的协作**

在 Vue 3 中，**组合式 API** 可以让我们通过共享逻辑更加方便地协作多个组件。通过 `setup()` 函数，你可以将复用逻辑提取到独立的函数或模块中，再在多个组件中引入和使用。

#### **示例：共享逻辑的组合**
```js
// useCounter.js (自定义组合函数)
import { ref } from 'vue';

export function useCounter() {
  const count = ref(0);
  
  function increment() {
    count.value++;
  }
  
  return { count, increment };
}
```

```vue
<!-- ComponentA.vue -->
<template>
  <button @click="increment">Count is {{ count }}</button>
</template>

<script setup>
import { useCounter } from './useCounter';

const { count, increment } = useCounter();
</script>
```

```vue
<!-- ComponentB.vue -->
<template>
  <button @click="increment">Count is {{ count }}</button>
</template>

<script setup>
import { useCounter } from './useCounter';

const { count, increment } = useCounter();
</script>
```

在这个例子中，`ComponentA` 和 `ComponentB` 共享了相同的计数逻辑，但它们独立维护自己的状态。

### 总结

Vue 3 中管理多个组件时的主要内容包括：
1. **组件的定义和注册**：可以通过局部或全局方式注册组件。
2. **父子组件通信**：通过 `props` 和 `emit` 实现父子组件之间的数据传递。
3. **插槽（Slots）**：提供灵活的方式让父组件传递并定制子组件内容。
4. **动态组件**：通过 `<component>` 实现组件的动态渲染。
5. **组合式 API**：通过共享逻辑提升代码复用性和协作性。

这些功能使 Vue 3 具备了构建复杂组件系统的能力，同时保证了代码的简洁和可维护性。