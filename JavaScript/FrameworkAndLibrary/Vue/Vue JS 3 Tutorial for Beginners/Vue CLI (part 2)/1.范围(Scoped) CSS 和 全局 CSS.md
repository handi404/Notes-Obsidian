在 Vue 3 中，**范围（Scoped）CSS** 和 **全局 CSS** 是用于管理组件样式的两种主要方式。每种方式都有其特定的应用场景，既可以保证组件的样式封装性，也可以在必要时影响全局样式。下面我们将详细讲解 Vue 3 中如何使用这两种方式，以及它们的区别和注意事项。

### 1. **Scoped CSS（范围 CSS）**

**Scoped CSS** 主要用于为某个组件的样式限定作用范围。使用 `scoped` 关键字可以保证样式仅作用于当前组件的模板内容，不会影响其他组件的样式。同时，该组件也不会受到其他组件或全局样式的影响。

#### **Scoped CSS 的基本用法**

在 Vue 3 中，你可以在组件的 `<style>` 标签上添加 `scoped` 属性来启用 Scoped CSS。

##### **示例：Scoped CSS**
```vue
<template>
  <div class="example">
    This is a scoped style example.
  </div>
</template>

<style scoped>
.example {
  color: blue;
}
</style>
```

**解释：**
- 这里 `scoped` 属性确保 `.example` 的样式只在当前组件生效。即使在其他组件中使用 `.example` 类，这些样式也不会影响其他组件。

#### **Scoped CSS 的实现原理**

Vue 3 通过给组件中的每个 DOM 元素自动添加一个**数据属性**（如 `data-v-xxxx`）来实现 Scoped CSS。浏览器会将样式规则加上特定的属性选择器，使得样式只在当前组件的 DOM 节点上生效。

**生成的 HTML 结构（假设组件 ID 为 `data-v-1234`）：**
```html
<div class="example" data-v-1234>
  This is a scoped style example.
</div>
```

**生成的 CSS 规则：**
```css
.example[data-v-1234] {
  color: blue;
}
```

这种机制确保了组件的样式封装，避免了样式冲突。

#### **Scoped CSS 的局限性**

- **无法作用于子组件**：Scoped CSS 的作用范围仅限于当前组件，它不会影响子组件的样式。如果需要对子组件应用样式，可以使用深度选择器（`::v-deep`，之前是 `/deep/` 或 `>>>`）。
  
##### **示例：使用深度选择器**
```vue
<template>
  <ChildComponent />
</template>

<style scoped>
::v-deep .child-class {
  color: red;
}
</style>
```
`::v-deep` 用于选择子组件内部的元素并应用样式。

- **对第三方库样式的限制**：有时我们可能需要修改第三方库组件的样式，由于它们的样式不受 `scoped` 影响，直接修改它们的样式会比较麻烦。

### 2. **全局 CSS**

全局 CSS 是指那些应用于整个项目中任何地方的样式。全局 CSS 通常用于定义通用的样式规则，如重置样式、全局的布局样式、字体、按钮样式等。

#### **全局 CSS 的用法**

在 Vue 3 中，全局 CSS 可以通过以下几种方式引入：

#### **方式 1：在主入口文件（如 `main.js`）中引入全局样式**

##### **示例：引入全局 CSS 文件**
```js
// main.js
import { createApp } from 'vue';
import App from './App.vue';
import './assets/global.css';  // 引入全局样式

createApp(App).mount('#app');
```

- 这种方式将全局样式文件引入项目的根实例，这些样式将作用于所有组件。

#### **方式 2：在组件中使用不带 `scoped` 的 `<style>` 标签**

如果在某个组件的 `<style>` 标签上**不添加 `scoped`** 属性，则这些样式将作为全局样式应用于所有组件。

##### **示例：在组件中定义全局样式**
```vue
<template>
  <div class="global-style">
    This style will affect the entire application.
  </div>
</template>

<style>
.global-style {
  color: green;
}
</style>
```

这里的 `.global-style` 会作为全局样式应用于整个应用程序的任何地方，而不仅仅是当前组件。

#### **方式 3：通过外部库引入全局样式**

你还可以通过导入第三方的样式库（如 Bootstrap、Tailwind CSS）来应用全局样式。通常这些库会通过 CDN 或 NPM 安装后引入到项目中。

##### **示例：引入外部样式库**
```js
// main.js
import 'bootstrap/dist/css/bootstrap.min.css';  // 引入 Bootstrap 全局样式
```

### 3. **Scoped CSS 和全局 CSS 的区别**

- **作用范围**：
  - Scoped CSS：样式只影响当前组件，不会影响其他组件，也不会被其他组件影响。
  - 全局 CSS：样式影响整个应用程序中的所有组件。

- **作用机制**：
  - Scoped CSS：Vue 通过给元素加上一个独特的属性（如 `data-v-xxxx`）来限定样式作用范围。
  - 全局 CSS：没有作用范围限制，直接应用于页面的任何元素。

- **使用场景**：
  - Scoped CSS：适合局部组件的样式管理，防止样式冲突。
  - 全局 CSS：适合定义通用的样式，如基础布局、全局主题和第三方库的样式。

### 4. **CSS Modules（CSS 模块化）**

Vue 3 还支持**CSS Modules**，这是一种自动将 CSS 类名局部化的方式，确保样式在组件之间不会发生冲突。CSS Modules 通过作用域更严密的局部化机制进一步增强了组件的封装性。

#### **使用 CSS Modules**

要启用 CSS Modules，可以在 `<style>` 标签上添加 `module` 属性。类名会被自动转换为哈希值，并通过 JavaScript 导入使用。

##### **示例：CSS Modules**
```vue
<template>
  <div :class="$style.example">
    This is styled using CSS Modules.
  </div>
</template>

<style module>
.example {
  color: purple;
}
</style>
```

在这里，`$style.example` 自动映射为一个唯一的类名，确保样式只作用于当前组件。

### 5. **Scoped 和全局样式的结合使用**

在实际开发中，可能需要将 Scoped CSS 和全局 CSS 结合使用。例如，重置样式或全局主题样式使用全局 CSS，而组件内部的特定样式使用 Scoped CSS。

#### **示例：结合使用**
```vue
<template>
  <div class="scoped-style">
    This is a scoped style.
  </div>
</template>

<style scoped>
.scoped-style {
  color: red;
}
</style>

<style>
/* 全局样式 */
body {
  font-family: Arial, sans-serif;
}
</style>
```

在这个例子中，`<style scoped>` 内的样式只作用于当前组件，而 `<style>` 定义的样式会全局生效。

### 6. **注意事项**

- **选择合适的方式**：当样式只需要影响某个组件时，优先使用 Scoped CSS；当需要影响整个应用时，使用全局 CSS。
- **避免样式冲突**：全局 CSS 容易造成样式冲突，因此在全局定义样式时要小心选择类名和选择器，避免污染其他组件。
- **`scoped` 样式性能问题**：Scoped CSS 会为每个组件生成独特的属性选择器，这在大型项目中可能对性能有一定影响。但一般来说，影响并不明显，Vue 3 的性能优化已经考虑了这个问题。

### 总结

- **Scoped CSS**：通过 `scoped` 关键字确保样式只作用于当前组件，保证了样式的封装性，避免了样式冲突。适合在需要严格隔离样式的组件中使用。
- **全局 CSS**：可以在应用的任何地方生效，适用于定义通用的样式或使用第三方库。需要注意避免样式污染和冲突。
- **CSS Modules**：提供了一种更强大的方式来确保样式的局部化，避免了命名冲突问题。

合理使用 Vue 3 提供的样式管理机制，可以帮助开发者更好地管理应用的样式，提高代码的维护性和可读性。