# **ğŸ“Œ Nuxt è‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼ˆError Handlingï¼‰è¯¦è§£**

åœ¨ Nuxt åº”ç”¨ä¸­ï¼Œé”™è¯¯å¤„ç†æ˜¯å¿…ä¸å¯å°‘çš„ï¼ŒåŒ…æ‹¬ **404 é¡µé¢**ã€**æœåŠ¡å™¨é”™è¯¯**ã€**API è¯·æ±‚å¤±è´¥** ç­‰ã€‚Nuxt æä¾›äº†**å…¨å±€é”™è¯¯é¡µé¢**å’Œ**å±€éƒ¨é”™è¯¯å¤„ç†**ä¸¤ç§æ–¹å¼ï¼Œæœ¬æ–‡å°†è¯¦ç»†è§£æå¦‚ä½•åœ¨ Nuxt ä¸­è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€‚

---

## **ğŸš€ 1. å…¨å±€é”™è¯¯é¡µé¢ (`error.vue`)**

ğŸ“Œ **Nuxt å…è®¸ä½ åœ¨ `error.vue` é‡Œå®šä¹‰å…¨å±€é”™è¯¯é¡µé¢ï¼Œç»Ÿä¸€å¤„ç† 404 å’Œ 500 ç­‰é”™è¯¯ã€‚**

### **âœ… åˆ›å»º `error.vue`**

åœ¨ `layouts/` ç›®å½•ä¸‹åˆ›å»º `error.vue`ï¼š

```vue
<template>
  <div class="error-page">
    <h1 v-if="error.statusCode === 404">ğŸ˜¢ é¡µé¢æœªæ‰¾åˆ°</h1>
    <h1 v-else>âš ï¸ å‘ç”Ÿé”™è¯¯</h1>
    <p>{{ error.message }}</p>
    <NuxtLink to="/">ğŸ  è¿”å›é¦–é¡µ</NuxtLink>
  </div>
</template>

<script setup>
defineProps(['error']);
</script>

<style>
.error-page {
  text-align: center;
  padding: 50px;
}
</style>
```

âœ… **å½“ç”¨æˆ·è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢ï¼ˆå¦‚ `/non-existent`ï¼‰æ—¶ï¼Œä¼šè‡ªåŠ¨æ˜¾ç¤ºæ­¤é¡µé¢ï¼**

---

## **ğŸš€ 2. å±€éƒ¨é”™è¯¯å¤„ç†ï¼ˆ`useError` & `showError`ï¼‰**

ğŸ“Œ **å¦‚æœä½ åªæƒ³åœ¨æŸä¸ªé¡µé¢æˆ–ç»„ä»¶é‡Œå¤„ç†é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨ `useError()` æˆ– `showError()`ã€‚**

### **âœ… åœ¨é¡µé¢ä¸­ä½¿ç”¨ `useError()`**

```vue
<script setup>
const error = useError();
</script>

<template>
  <div>
    <h1>ğŸ“Œ è¿™æ˜¯ä¸€ä¸ªé¡µé¢</h1>
    <p v-if="error">âŒ {{ error.message }}</p>
  </div>
</template>
```

âœ… **`useError()` å¯ä»¥åœ¨æŸä¸ªé¡µé¢é‡Œè·å–é”™è¯¯çŠ¶æ€ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–é¡µé¢ã€‚**

---

### **âœ… åœ¨ç»„ä»¶æˆ–é¡µé¢æ‰‹åŠ¨è§¦å‘ `showError()`**

ğŸ“Œ **å¦‚æœä½ æƒ³åœ¨ API è¯·æ±‚å¤±è´¥æ—¶æ‰‹åŠ¨æŠ›å‡ºé”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨ `showError()`ã€‚**

```vue
<script setup>
const fetchData = async () => {
  try {
    const data = await $fetch('/api/fake-url');
  } catch (err) {
    showError({ statusCode: 500, message: 'æœåŠ¡å™¨è¯·æ±‚å¤±è´¥ï¼' });
  }
};
</script>

<template>
  <button @click="fetchData">è·å–æ•°æ®</button>
</template>
```

âœ… **å½“ API è¯·æ±‚å¤±è´¥æ—¶ï¼Œç”¨æˆ·ä¼šè¢«è‡ªåŠ¨é‡å®šå‘åˆ° `error.vue` é¡µé¢ã€‚**

---

## **ğŸš€ 3. 404 é¡µé¢ï¼ˆè‡ªå®šä¹‰ `not-found.vue`ï¼‰**

ğŸ“Œ **å¦‚æœä½ æƒ³åˆ›å»ºç‹¬ç«‹çš„ 404 é¡µé¢ï¼ˆè€Œä¸æ˜¯ `error.vue` å¤„ç†æ‰€æœ‰é”™è¯¯ï¼‰ï¼Œå¯ä»¥æ‰‹åŠ¨æ‹¦æˆª 404 è¯·æ±‚ã€‚**

### **âœ… åˆ›å»º `pages/not-found.vue`**

```vue
<template>
  <div class="not-found">
    <h1>ğŸš« 404 - é¡µé¢æœªæ‰¾åˆ°</h1>
    <NuxtLink to="/">ğŸ  è¿”å›é¦–é¡µ</NuxtLink>
  </div>
</template>

<style>
.not-found {
  text-align: center;
  padding: 50px;
}
</style>
```

### **âœ… åœ¨ `middleware` é‡Œæ‹¦æˆª 404**

ğŸ“Œ **åˆ›å»º `middleware/notFound.ts`**

```ts
export default defineNuxtRouteMiddleware((to, from) => {
  if (!to.matched.length) {
    return navigateTo('/not-found', { replace: true });
  }
});
```

ç„¶ååœ¨ `nuxt.config.ts` é‡Œæ³¨å†Œï¼š

```ts
export default defineNuxtConfig({
  router: {
    options: {
      middleware: ['notFound']
    }
  }
});
```

âœ… **è¿™æ ·æ‰€æœ‰ 404 é¡µé¢éƒ½ä¼šè·³è½¬åˆ° `/not-found` é¡µé¢ï¼**

---

## **ğŸš€ 4. API é”™è¯¯å¤„ç†**

ğŸ“Œ **å¦‚æœä½ çš„ Nuxt åº”ç”¨è°ƒç”¨åç«¯ API æ—¶å‘ç”Ÿé”™è¯¯ï¼Œä½ å¯ä»¥åœ¨ `server/api/` é‡Œè‡ªå®šä¹‰é”™è¯¯å“åº”ã€‚**

### **âœ… åœ¨ `server/api/example.ts` é‡ŒæŠ›å‡º API é”™è¯¯**

```ts
export default defineEventHandler(() => {
  throw createError({ statusCode: 500, statusMessage: 'æœåŠ¡å™¨å‡ºé”™ï¼' });
});
```

### **âœ… åœ¨å‰ç«¯è°ƒç”¨ API å¹¶å¤„ç†é”™è¯¯**

```vue
<script setup>
const { data, error } = useFetch('/api/example');
</script>

<template>
  <div v-if="error">âŒ {{ error.statusMessage }}</div>
  <div v-else>{{ data }}</div>
</template>
```

âœ… **è¿™æ · `useFetch` ä¼šè‡ªåŠ¨æ•è· API é”™è¯¯ï¼Œå¹¶æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼**

---

## **ğŸš€ 5. è‡ªå®šä¹‰é”™è¯¯å¸ƒå±€**

ğŸ“Œ **å¦‚æœä½ æƒ³è®© `error.vue` ä½¿ç”¨ä¸åŒçš„å¸ƒå±€ï¼Œè€Œä¸æ˜¯ `default.vue`ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®š `layout`ã€‚**

### **âœ… ä¿®æ”¹ `error.vue` è®©å®ƒä½¿ç”¨ `error-layout.vue`**

```vue
<script setup>
definePageMeta({
  layout: 'error-layout'
});
defineProps(['error']);
</script>
```

### **âœ… åˆ›å»º `layouts/error-layout.vue`**

```vue
<template>
  <div class="error-layout">
    <h1>âš ï¸ è‡ªå®šä¹‰é”™è¯¯é¡µé¢</h1>
    <slot />
  </div>
</template>
```

âœ… **è¿™æ ·é”™è¯¯é¡µé¢ä¼šä½¿ç”¨ `error-layout.vue` ä½œä¸ºå¸ƒå±€ï¼**

---

## **ğŸ¯ æ€»ç»“**

|**é”™è¯¯ç±»å‹**|**è§£å†³æ–¹æ¡ˆ**|**ç¤ºä¾‹**|
|---|---|---|
|**404 é¡µé¢**|`error.vue` å¤„ç†|è‡ªåŠ¨æ˜¾ç¤º 404|
|**å±€éƒ¨é”™è¯¯å¤„ç†**|`useError()`|`<p v-if="error">{{ error.message }}</p>`|
|**æ‰‹åŠ¨æŠ›å‡ºé”™è¯¯**|`showError({ statusCode: 500 })`|API å¤±è´¥æ—¶è·³è½¬é”™è¯¯é¡µ|
|**API é”™è¯¯å¤„ç†**|`throw createError({ statusCode: 500 })`|`server/api/` é‡Œè‡ªå®šä¹‰é”™è¯¯|
|**è‡ªå®šä¹‰é”™è¯¯å¸ƒå±€**|`definePageMeta({ layout: 'error-layout' })`|`error-layout.vue`|

ğŸ“Œ **ğŸ’¡ Nuxt æä¾›äº†ä¸°å¯Œçš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ— è®ºæ˜¯å…¨å±€é”™è¯¯ã€API å¤±è´¥ï¼Œè¿˜æ˜¯ 404 é¡µé¢ï¼Œéƒ½å¯ä»¥çµæ´»å®šåˆ¶ï¼**