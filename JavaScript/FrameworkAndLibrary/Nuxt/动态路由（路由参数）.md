# **📌 Nuxt 动态路由（路由参数）详解**

Nuxt 提供 **基于文件的路由系统**，无需手动配置 `vue-router`，并且支持 **动态路由参数**（Dynamic Routes）。本教程详细介绍如何在 Nuxt 3 中使用动态路由，包括 **必填参数、可选参数、多级动态参数、Catch-All 路由** 等。

---

## **🚀 1. 基本动态路由**

如果你的 URL 需要**动态参数**（如 `/blog/:id`），可以这样做：

### **📂 创建动态路由**

在 `pages/` 目录下创建：

```
pages/
│── blog/
│   ├── index.vue   → `/blog`       （博客列表）
│   ├── [id].vue    → `/blog/:id`   （博客详情）
```

📌 这里 `[id].vue` 的 `[id]` 表示一个动态参数。

### **📌 代码示例**

```vue
<!-- pages/blog/[id].vue -->
<template>
  <div>
    <h1>博客详情</h1>
    <p>博客 ID: {{ route.params.id }}</p>
  </div>
</template>

<script setup>
import { useRoute } from 'vue-router';

const route = useRoute();  // 获取路由信息
</script>
```

**🔹 访问 `/blog/123`，页面会显示：**

```
博客 ID: 123
```

---

## **📌 2. 可选动态参数**

有时，你希望 `/blog` 显示博客列表，而 `/blog/:id` 显示博客详情。

你可以使用 **双方括号 `[[]]`** 定义 **可选参数**：

```
pages/
│── blog/
│   ├── [[id]].vue   → `/blog` 或 `/blog/:id`
```

```vue
<!-- pages/blog/[[id]].vue -->
<template>
  <div>
    <h1 v-if="route.params.id">博客详情: {{ route.params.id }}</h1>
    <h1 v-else>博客列表</h1>
  </div>
</template>

<script setup>
import { useRoute } from 'vue-router';

const route = useRoute();
</script>
```

🔹 **访问 `/blog`** 👉 显示 **博客列表**  
🔹 **访问 `/blog/123`** 👉 显示 **博客 ID: 123**

---

## **📌 3. 多级动态路由**

如果 URL 结构是 `/user/:id/post/:postId`，可以这样做：

```
pages/
│── user/
│   ├── [id]/
│       ├── post/
│           ├── [postId].vue   → `/user/:id/post/:postId`
```

```vue
<!-- pages/user/[id]/post/[postId].vue -->
<template>
  <div>
    <h1>用户 {{ route.params.id }} 的文章</h1>
    <p>文章 ID: {{ route.params.postId }}</p>
  </div>
</template>

<script setup>
import { useRoute } from 'vue-router';

const route = useRoute();
</script>
```

**🔹 访问 `/user/5/post/10`**

```
用户 5 的文章
文章 ID: 10
```

---

## **📌 4. Catch-All 路由（匹配所有路径）**

有时候，你希望 `/docs/*` 能匹配 `/docs/vue`、`/docs/nuxt`、`/docs/javascript` 等。  
你可以使用 `[...参数名].vue`：

```
pages/
│── docs/
│   ├── [...slug].vue   → `/docs/*`
```

```vue
<!-- pages/docs/[...slug].vue -->
<template>
  <div>
    <h1>文档页面</h1>
    <p>当前路径: {{ route.params.slug }}</p>
  </div>
</template>

<script setup>
import { useRoute } from 'vue-router';

const route = useRoute();
</script>
```

**🔹 访问 `/docs/vue/nuxt`**

```
当前路径: ["vue", "nuxt"]
```

📌 `route.params.slug` 变成 **数组** `["vue", "nuxt"]`，可用于动态导航。

---

## **📌 5. 在页面中获取路由参数**

在 `setup` 语法中，可以使用 `useRoute()` 获取路由参数：

```vue
<script setup>
import { useRoute } from 'vue-router';

const route = useRoute();
console.log(route.params.id);
</script>
```

🔹 **`route.params.id`** 获取 `/:id` 的值。  
🔹 **`route.params.slug`** 如果是 `Catch-All` 路由，值是 **数组**。

---

## **📌 6. 在 `<script>` 外部使用路由参数**

Nuxt 3 提供了 `useRoute()` 以外的 `useRouter()`：

```vue
<script setup>
import { useRouter } from 'vue-router';

const router = useRouter();

// 重定向
const goToHome = () => {
  router.push('/');
};
</script>

<template>
  <button @click="goToHome">返回首页</button>
</template>
```

---

## **📌 7. 使用 `useAsyncData()` 获取 API 数据**

如果你想在动态路由页面里获取数据：

```vue
<script setup>
import { useRoute, useAsyncData } from 'nuxt/app';

const route = useRoute();
const { data: post } = await useAsyncData(`blog-${route.params.id}`, () =>
  $fetch(`https://api.example.com/posts/${route.params.id}`)
);
</script>

<template>
  <div>
    <h1>{{ post.title }}</h1>
    <p>{{ post.content }}</p>
  </div>
</template>
```

**📌 `useAsyncData()`** 让数据在 **服务器端** 预加载，避免客户端请求 API，提升性能！

---

## **🎯 总结**

|**功能**|**文件名**|**路由路径**|
|---|---|---|
|**普通路由**|`pages/blog.vue`|`/blog`|
|**动态参数**|`pages/blog/[id].vue`|`/blog/:id`|
|**可选参数**|`pages/blog/[[id]].vue`|`/blog` 或 `/blog/:id`|
|**多级动态参数**|`pages/user/[id]/post/[postId].vue`|`/user/:id/post/:postId`|
|**匹配所有路径**|`pages/docs/[...slug].vue`|`/docs/*`|

🚀 **Nuxt 的动态路由功能强大，支持参数获取、API 预加载、多级嵌套、Catch-All 路由，让你的路由管理更加简单！**