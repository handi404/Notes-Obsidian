### CSRF Token、JWT、Session Token 三者的总结与对比：

---

#### **1. 核心定义**
- **CSRF Token**  
  - **是什么**：防跨站请求伪造的“一次性密码”。  
  - **用途**：确保用户的操作是主动发起的（如转账、修改密码）。  
  - **存储**：由服务器生成，嵌入表单或请求头，客户端提交时需回传。  

- **JWT（JSON Web Token）**  
  - **是什么**：自包含的“加密身份证”，直接存储用户信息。  
  - **用途**：身份验证与授权（如登录后访问 API）。  
  - **存储**：客户端保存（如 localStorage 或请求头），服务器不存储会话。  

- **Session Token**  
  - **是什么**：服务器颁发的“临时通行证”，用于跟踪用户会话。  
  - **用途**：维持登录状态（如电商网站保持用户登录）。  
  - **存储**：服务器存会话数据，客户端通过 Cookie 保存 Token。  

---

#### **2. 核心区别**  
| **特性**         | **CSRF Token**          | **JWT**                  | **Session Token**        |
|------------------|-------------------------|--------------------------|--------------------------|
| **核心目标**     | 防伪造请求（动作安全）   | 身份验证与授权（身份安全） | 维持会话状态（身份跟踪） |
| **存储位置**     | 表单/请求头             | 客户端（如 localStorage） | 服务器 + 客户端 Cookie    |
| **是否需服务器存储** | 临时生成，通常不长期存储 | 无需（仅需签名密钥）     | 必须存储会话数据         |
| **数据自包含性** | 无意义随机字符串        | 包含用户信息（可解码）   | 无意义标识符             |
| **典型场景**     | 表单提交、敏感操作       | 前后端分离 API、单点登录  | 传统网站登录状态管理     |

---

#### **3. 相互关系**  
- **CSRF Token 与 Session/JWT**：  
  - **Session**：若用 Cookie 存 Session Token，必须加 CSRF Token 防护（因为 Cookie 自动携带，易被伪造请求）。  
  - **JWT**：若 JWT 通过 Cookie 存储，同样需要 CSRF Token；若通过请求头手动发送（如 Authorization 头），则可不依赖 CSRF Token。  

- **JWT 与 Session Token**：  
  - **替代关系**：JWT 可替代 Session 实现无状态身份验证，但牺牲了服务器即时吊销能力（需等 JWT 过期）。  
  - **互补关系**：某些系统混合使用（如用 Session 管理短期登录，JWT 用于 API 授权）。  

---

#### **4. 如何选择？**  
- **用 CSRF Token 当：**  
  需要防止用户被诱导发起非自愿操作（如银行转账）。  
- **用 Session Token 当：**  
  传统网站需简单维护登录状态，且希望完全控制会话（如强制下线用户）。  
- **用 JWT 当：**  
  系统需分布式扩展（无中心会话存储），或需客户端携带用户信息（如移动端 API）。  

---

#### **5. 一句话总结**  
- **CSRF Token**：防“别人偷偷用你的身份做操作”。  
- **Session Token**：告诉服务器“我还是我，别让我重复登录”。  
- **JWT**：把“我是谁、我能做什么”直接写在令牌里，让服务器轻松验明正身。  

---

**三者协作示例**：  
- 用户登录 → 服务器返回 **JWT**（存客户端 localStorage）。  
- 提交敏感操作 → 后端要求请求头携带 **JWT** + 表单中嵌入 **CSRF Token**（双重防护）。  
- 若使用 **Session Token**（存 Cookie） → 必须搭配 **CSRF Token** 防止攻击。