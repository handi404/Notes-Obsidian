在 Vue 3 中，`Props` 是用于在**父组件**向**子组件**传递数据的一种机制。通过 `Props`，父组件可以将数据动态地传递给子组件，子组件则通过定义的 `props` 来接收这些数据。下面将详细讲解 Vue 3 中 `Props` 的定义、使用、类型、默认值、验证等内容。
[[传递对象数组]]
### 1. **Props 的基础使用**

在 Vue 3 中，`Props` 是通过 `defineProps` 这个组合式 API 在子组件的 `setup()` 函数中定义的。父组件通过属性的形式向子组件传递数据。

#### **示例：基础使用**

##### **父组件**
```vue
<template>
  <ChildComponent message="Hello from Parent!" />
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';
</script>
```

##### **子组件**
```vue
<template>
  <div>{{ message }}</div>
</template>

<script setup>
const props = defineProps({
  message: String  // 接收来自父组件的 props
});
</script>
```

**解释：**
- 在父组件中，我们通过 `message` 属性向子组件 `ChildComponent` 传递数据。
- 在子组件中，使用 `defineProps` 来声明接收的 `message` 属性，并在模板中使用 `{{ message }}` 显示出来。

### 2. **Props 的类型声明**

在 Vue 3 中，`Props` 可以通过 `defineProps` 来定义类型。这些类型声明可以帮助确保父组件传递的数据是符合预期的类型。

#### **示例：Props 类型声明**
```vue
<script setup>
const props = defineProps({
  message: String,      // 字符串类型
  count: Number,        // 数字类型
  isVisible: Boolean,   // 布尔类型
  items: Array,         // 数组类型
  user: Object          // 对象类型
});
</script>
```

通过这种类型声明，Vue 会自动对传入的 `Props` 进行类型检查。如果传入的数据类型不匹配，Vue 会在开发模式下发出警告。

### 3. **Props 的默认值**

如果父组件没有传递某个 `Prop`，可以为 `Props` 设置默认值。默认值可以通过 `default` 选项来定义。

#### **示例：Props 默认值**
```vue
<script setup>
const props = defineProps({
  message: {
    type: String,
    default: 'Hello, default message!'  // 设置默认值
  }
});
</script>
```

**解释：**
- 如果父组件没有传递 `message` 属性，`message` 将默认值为 `'Hello, default message!'`。

### 4. **Props 的必填项**

通过 `required: true`，可以将某个 `Prop` 设置为必填项。如果父组件没有传递该 `Prop`，Vue 会在开发模式下发出警告。

#### **示例：必填 Props**
```vue
<script setup>
const props = defineProps({
  title: {
    type: String,
    required: true  // 必须传递
  }
});
</script>
```

**解释：**
- 如果父组件没有传递 `title` 属性，Vue 会在控制台发出警告，提示 `title` 是必填的。

### 5. **Props 的类型验证**

除了基本的类型声明，Vue 还允许你对 `Props` 进行更复杂的验证。可以通过 `validator` 选项来定义自定义验证规则。

#### **示例：自定义验证**
```vue
<script setup>
const props = defineProps({
  age: {
    type: Number,
    validator(value) {
      return value >= 18;  // 验证年龄必须大于等于18
    }
  }
});
</script>
```

**解释：**
- 这里我们对 `age` 属性进行验证，确保它是大于等于 18 的数字。如果验证失败，Vue 会在开发模式下发出警告。

### 6. **动态 Props**

有时候我们需要动态传递多个 `Props`，可以使用 `v-bind` 指令传递一个对象，该对象的键对应 `Props` 的名称，值则对应具体的数据。

#### **示例：动态传递多个 Props**
##### **父组件**
```vue
<template>
  <ChildComponent v-bind="dynamicProps" />
</template>

<script setup>
import ChildComponent from './ChildComponent.vue';

const dynamicProps = {
  message: 'Hello dynamic props!',
  count: 42,
  isVisible: true
};
</script>
```

##### **子组件**
```vue
<template>
  <div>
    <p>{{ message }}</p>
    <p>{{ count }}</p>
    <p>{{ isVisible }}</p>
  </div>
</template>

<script setup>
const props = defineProps({
  message: String,
  count: Number,
  isVisible: Boolean
});
</script>
```

**解释：**
- 在父组件中，我们将多个 `Props` 存储在 `dynamicProps` 对象中，然后通过 `v-bind` 一次性传递给子组件。
- 子组件中通过 `defineProps` 来接收这些 `Props` 并使用。

### 7. **Props 的深度观察**

在 Vue 中，如果 `Props` 的值是一个对象或数组，且这个对象或数组的内容被修改，Vue 是无法自动检测到的。这是因为 JavaScript 的引用类型机制。为了观察对象或数组内部变化，可以将 `props` 的值转换为 `reactive` 或 `ref`。

#### **示例：深度观察对象**
```vue
<template>
  <div>{{ user.name }}</div>
</template>

<script setup>
import { toRefs } from 'vue';

const props = defineProps({
  user: Object
});

// 使用 toRefs 进行深度观察
const { user } = toRefs(props);
</script>
```

**解释：**
- 使用 `toRefs` 将 `props` 中的对象 `user` 转换为响应式的引用，这样即使 `user` 对象内部发生了变化，Vue 也能够自动响应。

### 8. **Non-Prop Attributes（非 Prop 属性）**

Vue 3 中，如果父组件传递的属性在子组件中没有定义为 `Props`，这些属性会作为 `attrs` 自动传递到子组件的根元素上。通常用于传递 `class`、`style`、`id` 等非 `Props` 属性。

#### **示例：Non-Prop Attributes**
##### **父组件**
```vue
<template>
  <ChildComponent id="child-id" class="child-class" />
</template>
```

##### **子组件**
```vue
<template>
  <div>
    I'm the child component.
  </div>
</template>

<script setup>
const props = defineProps();  // 没有接收任何 Props
</script>
```

**解释：**
- 在父组件中，我们向子组件传递了 `id` 和 `class` 属性，但子组件没有声明这些 `Props`。
- 这些属性会自动作为 Non-Prop Attributes 传递到子组件的根元素上。

### 9. **Prop Sync（Prop 双向绑定）**

Vue 3 中没有直接提供 `sync` 修饰符，但是可以通过 `v-model` 机制实现双向绑定。子组件通过 `emit` 事件来更新父组件的 `Prop`。

#### **示例：双向绑定**
##### **父组件**
```vue
<template>
  <ChildComponent v-model:count="count" />
</template>

<script setup>
import { ref } from 'vue';
import ChildComponent from './ChildComponent.vue';

const count = ref(0);
</script>
```

##### **子组件**
```vue
<template>
  <button @click="updateCount">Increment Count</button>
</template>

<script setup>
const props = defineProps({
  count: Number
});

const emit = defineEmits();

function updateCount() {
  emit('update:count', props.count + 1);  // 向父组件发送更新事件
}
</script>
```

**解释：**
- 在父组件中，`v-model:count` 实现了 `count` 的双向绑定。
- 在子组件中，通过 `emit('update:count', newCount)` 来更新 `count` 的值。

### 10. **总结**

- **Props 基础使用**：父组件通过属性向子组件传递数据，子组件通过 `defineProps` 接收。
- **类型声明**：`Props` 可以声明类型，Vue 会在开发模式下进行类型检查。
- **默认值**：`Props` 可以设置默认值，防止父组件未传递时出错。
- **必填项**：通过 `required: true` 确保某些 `Props` 是必传的。
- **自定义验证**：通过 `validator` 选项自定义 `Props` 验证规则。
- **动态传递**：使用 `v-bind` 动态传递多个 `Props`。
- **深度观察**：使用 `toRefs` 或 `reactive` 来观察 `Props` 内部的变化。
- **非 Prop 属性**：未定义为 `Props` 的属性