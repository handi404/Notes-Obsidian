在 Kotlin 中，连接数据库的基础方式也可以使用 **JDBC**（Java Database Connectivity），因为 Kotlin 运行在 JVM 上，完全兼容 Java 的库和工具。因此，使用 Kotlin 时可以直接调用 JDBC API。

不过，由于 Kotlin 提供了更简洁的语法和扩展函数等特性，通常结合更高级的库来进一步简化数据库操作。在 Kotlin 开发中，以下是几种主要的数据库连接和操作方式：

---

### **1. 使用 JDBC（Java 原生方式）**

Kotlin 可以直接使用 JDBC，代码和 Java 基本一致，但 Kotlin 语法更简洁。

#### **示例：使用 JDBC 连接 MySQL 数据库**

```kotlin
import java.sql.Connection
import java.sql.DriverManager
import java.sql.ResultSet

fun main() {
    val url = "jdbc:mysql://localhost:3306/your_database"
    val user = "your_username"
    val password = "your_password"

    var connection: Connection? = null

    try {
        // 加载 JDBC 驱动
        connection = DriverManager.getConnection(url, user, password)

        // 创建 SQL 语句
        val statement = connection.createStatement()
        val resultSet: ResultSet = statement.executeQuery("SELECT * FROM your_table")

        // 遍历结果集
        while (resultSet.next()) {
            println("ID: ${resultSet.getInt("id")}, Name: ${resultSet.getString("name")}")
        }

    } catch (e: Exception) {
        e.printStackTrace()
    } finally {
        connection?.close() // 关闭连接
    }
}
```

**优点：**

- 完全基于 Java 的方式，适合需要控制底层细节的场景。

**缺点：**

- 代码较为冗长，需要手动处理资源管理（如连接关闭等）。

---

### **2. 使用 Kotlin 扩展库简化 JDBC**

可以借助 Kotlin 的扩展函数和库封装简化 JDBC 操作。例如使用 [`kotlin-jdbc`](https://github.com/seratch/kotliquery) 这样的轻量级库，代码会更简洁。

#### **示例：使用 Kotliquery**

```kotlin
import kotliquery.*

fun main() {
    val session = sessionOf("jdbc:mysql://localhost:3306/your_database", "your_username", "your_password")
    session.use {
        // 查询数据
        val rows = it.run(queryOf("SELECT * FROM your_table").map { row ->
            row.int("id") to row.string("name")
        }.asList)

        // 打印结果
        rows.forEach { println("ID: ${it.first}, Name: ${it.second}") }
    }
}
```

**优点：**

- 更加 Kotlin 风格，避免了冗长的资源管理代码。

**缺点：**

- 相对基础 JDBC，库的学习成本略高。

---

### **3. 使用 ORM 框架（如 JPA/Hibernate + Kotlin 扩展）**

#### **Kotlin 官方支持的 JPA 扩展**

Kotlin 提供了对 JPA 的专门支持（通过 `javax.persistence`），适用于使用 Hibernate 等框架时。

#### **示例：使用 JPA 操作数据库**

```kotlin
import javax.persistence.*
import javax.persistence.criteria.CriteriaBuilder

@Entity
data class User(
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    val id: Long = 0,
    val name: String = ""
)

fun main() {
    val entityManagerFactory = Persistence.createEntityManagerFactory("your_persistence_unit")
    val entityManager = entityManagerFactory.createEntityManager()

    entityManager.transaction.begin()

    // 插入数据
    val user = User(name = "Kotlin User")
    entityManager.persist(user)

    // 查询数据
    val query = entityManager.createQuery("SELECT u FROM User u", User::class.java)
    val users = query.resultList
    users.forEach { println(it) }

    entityManager.transaction.commit()
    entityManager.close()
    entityManagerFactory.close()
}
```

**优点：**

- 使用 JPA 和 ORM，可以避免手动管理 SQL 语句，适合复杂的对象关系映射。

**缺点：**

- 学习成本高，尤其对于小型项目可能显得繁琐。

---

### **4. 使用现代 Kotlin 数据库框架**

以下是一些更现代、更高效的数据库框架，专门为 Kotlin 提供支持：

#### **(1) Exposed**

Exposed 是由 JetBrains 开发的 Kotlin ORM 和 DSL 数据库框架，提供两种模式：

- **DSL 模式**：构建类型安全的 SQL 查询。
- **DAO 模式**：类似于传统 ORM。

**示例：DSL 模式**

```kotlin
import org.jetbrains.exposed.sql.*
import org.jetbrains.exposed.sql.transactions.transaction
import org.jetbrains.exposed.sql.Database

object Users : Table() {
    val id = integer("id").autoIncrement()
    val name = varchar("name", 50)
    override val primaryKey = PrimaryKey(id)
}

fun main() {
    // 数据库连接
    Database.connect("jdbc:mysql://localhost:3306/your_database", user = "your_username", password = "your_password")

    transaction {
        // 创建表
        SchemaUtils.create(Users)

        // 插入数据
        Users.insert {
            it[name] = "John Doe"
        }

        // 查询数据
        Users.selectAll().forEach {
            println("ID: ${it[Users.id]}, Name: ${it[Users.name]}")
        }
    }
}
```

**优点：**

- 类型安全，DSL 模式易于构建 SQL 查询。
- 支持事务和自动表创建。

**缺点：**

- 对于习惯 SQL 的开发者，DSL 需要一定的学习曲线。

---

#### **(2) Ktor with SQL**

Ktor 是一个轻量级的 Kotlin Web 框架，也可以集成数据库操作。Ktor 常与 Exposed 或直接使用 JDBC 一起使用。

**示例：Ktor + Exposed**

```kotlin
fun Application.module() {
    install(ContentNegotiation) {
        json()
    }
    routing {
        get("/users") {
            call.respond(transaction {
                Users.selectAll().map { it[Users.name] }
            })
        }
    }
}
```

**优点：**

- 适合同时开发 Web 应用和数据库操作。

---

### **5. 使用 Spring Data 和 Kotlin**

Spring Framework 对 Kotlin 提供了良好的支持，Spring Data 可以简化数据库操作。

#### **示例：使用 Spring Data**

```kotlin
import org.springframework.data.jpa.repository.JpaRepository
import org.springframework.stereotype.Service
import javax.persistence.Entity
import javax.persistence.GeneratedValue
import javax.persistence.GenerationType
import javax.persistence.Id

@Entity
data class User(
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    val id: Long = 0,
    val name: String = ""
)

interface UserRepository : JpaRepository<User, Long>

@Service
class UserService(private val userRepository: UserRepository) {
    fun getAllUsers(): List<User> = userRepository.findAll()
    fun saveUser(user: User) = userRepository.save(user)
}
```

**优点：**

- 集成能力强，适合企业级项目。
- Spring Data 提供了丰富的功能，几乎不需要写 SQL。

---

### **总结**

1. **基础连接：JDBC**
    
    - 直接使用 Java 的 JDBC API，适合基础学习或底层开发。
2. **轻量库：Kotliquery**
    
    - 提供更优雅的 Kotlin 风格简化 JDBC 操作。
3. **ORM 框架：JPA + Hibernate**
    
    - 适合复杂的对象关系映射场景，企业级开发常用。
4. **Kotlin 专属：Exposed**
    
    - 专为 Kotlin 开发的数据库框架，灵活且强大。
5. **Spring Data with Kotlin**
    
    - 企业级开发中高效、现代化的选择。

如果是初学者，可以先从 **JDBC** 和 **Kotliquery** 入手，逐步学习 Exposed 或 Spring Data。