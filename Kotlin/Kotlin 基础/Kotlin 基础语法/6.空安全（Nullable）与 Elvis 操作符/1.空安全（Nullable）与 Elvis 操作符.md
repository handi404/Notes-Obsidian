### **Kotlin çš„ç©ºå®‰å…¨ï¼ˆNullableï¼‰ä¸ Elvis æ“ä½œç¬¦è¯¦è§£**

---

Kotlin æä¾›äº†å¼ºå¤§çš„ **ç©ºå®‰å…¨æœºåˆ¶**ï¼Œæœ‰æ•ˆé˜²æ­¢ Java ä¸­å¸¸è§çš„ `NullPointerException`ï¼ˆç®€ç§° NPEï¼‰é—®é¢˜ã€‚é€šè¿‡ Kotlin çš„ç±»å‹ç³»ç»Ÿï¼Œç©ºå€¼é—®é¢˜åœ¨ç¼–è¯‘é˜¶æ®µå³å¯å‘ç°ã€‚

---

## **1. å¯ç©ºç±»å‹ï¼ˆNullableï¼‰**

åœ¨ Kotlin ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰ç±»å‹éƒ½ **ä¸å¯ä¸º null**ã€‚å¦‚æœéœ€è¦æŸä¸ªå˜é‡å¯ä»¥ä¸º `null`ï¼Œéœ€è¦æ˜¾å¼å£°æ˜å…¶ä¸º **å¯ç©ºç±»å‹**ã€‚

### **1.1 å®šä¹‰å¯ç©ºç±»å‹**

é€šè¿‡åœ¨ç±»å‹åé¢æ·»åŠ  **`?`** æ ‡è¯†ç¬¦ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡å¯ä¸ºç©ºã€‚

```kotlin
val name: String = "Alice"  // ä¸å¯ä¸ºç©º
val nullableName: String? = null  // å¯ä¸ºç©º
```

#### **ç¤ºä¾‹ï¼šè®¿é—®å¯ç©ºå˜é‡**

```kotlin
fun main() {
    val name: String? = "Alice"
    println(name)  // è¾“å‡º: Alice

    val nullName: String? = null
    println(nullName)  // è¾“å‡º: null
}
```

---

## **2. å®‰å…¨è°ƒç”¨æ“ä½œç¬¦ï¼ˆ`?.`ï¼‰**

å¦‚æœç›´æ¥è®¿é—®å¯ç©ºå˜é‡çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä¼šç¼–è¯‘æŠ¥é”™ã€‚ä¸ºäº†å®‰å…¨åœ°è®¿é—®ï¼Œå¯ç©ºå˜é‡éœ€è¦ä½¿ç”¨ **å®‰å…¨è°ƒç”¨æ“ä½œç¬¦ï¼ˆ`?.`ï¼‰**ã€‚

```kotlin
val nullableName: String? = "Alice"
println(nullableName?.length)  // å¦‚æœ nullableName ä¸º nullï¼Œè¿”å› nullï¼Œå¦åˆ™è¿”å›å…¶é•¿åº¦
```

#### **ç¤ºä¾‹ï¼šå®‰å…¨è°ƒç”¨**

```kotlin
fun main() {
    val name: String? = "Alice"
    println(name?.uppercase())  // è¾“å‡º: ALICE

    val nullName: String? = null
    println(nullName?.uppercase())  // è¾“å‡º: null
}
```

---

## **3. Elvis æ“ä½œç¬¦ï¼ˆ`?:`ï¼‰**

Elvis æ“ä½œç¬¦ç”¨äºåœ¨å¯ç©ºå˜é‡ä¸º `null` æ—¶æä¾›é»˜è®¤å€¼ã€‚å…¶è¯­æ³•æ˜¯ `value ?: defaultValue`ã€‚
[[ç†è§£Elvis æ“ä½œç¬¦]]
### **3.1 ä½¿ç”¨ Elvis æ“ä½œç¬¦æä¾›é»˜è®¤å€¼**

```kotlin
val nullableName: String? = null
val name = nullableName ?: "Unknown"  // å¦‚æœ nullableName ä¸º nullï¼Œåˆ™ä½¿ç”¨ "Unknown"
println(name)  // è¾“å‡º: Unknown
```

#### **ç¤ºä¾‹ï¼šç»“åˆå®‰å…¨è°ƒç”¨ä¸ Elvis æ“ä½œç¬¦**

```kotlin
fun main() {
    val nullableName: String? = null
    println(nullableName?.length ?: "No name provided")  
    // è¾“å‡º: No name provided
}
```

---

## **4. éç©ºæ–­è¨€æ“ä½œç¬¦ï¼ˆ`!!`ï¼‰**

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœå¼€å‘è€…æ˜ç¡®çŸ¥é“æŸä¸ªå¯ç©ºå˜é‡ä¸ä¼šä¸º `null`ï¼Œå¯ä»¥ä½¿ç”¨ **éç©ºæ–­è¨€æ“ä½œç¬¦ï¼ˆ`!!`ï¼‰** å¼ºåˆ¶å°†å¯ç©ºç±»å‹è½¬æ¢ä¸ºéç©ºç±»å‹ã€‚å¦‚æœæ–­è¨€å¤±è´¥ï¼ˆå³å˜é‡ä¸º `null`ï¼‰ï¼Œä¼šæŠ›å‡º `KotlinNullPointerException`ã€‚

```kotlin
val nullableName: String? = null
println(nullableName!!.length)  // æŠ›å‡ºå¼‚å¸¸: KotlinNullPointerException
```

#### **æ³¨æ„ï¼šè°¨æ…ä½¿ç”¨ `!!`ï¼Œå¦åˆ™å®¹æ˜“å¼•å‘è¿è¡Œæ—¶å¼‚å¸¸ï¼**

---

## **5. å¯ç©ºç±»å‹çš„å¸¸ç”¨æ“ä½œ**

Kotlin æä¾›äº†å¾ˆå¤šä¾¿åˆ©çš„å‡½æ•°å’Œæ“ä½œç¬¦æ¥å¤„ç†å¯ç©ºç±»å‹ã€‚

### **5.1 ä½¿ç”¨ `let` å‡½æ•°**

`let` å‡½æ•°ç”¨äºåœ¨å˜é‡ä¸ä¸º `null` æ—¶æ‰§è¡ŒæŸäº›æ“ä½œã€‚

```kotlin
val nullableName: String? = "Alice"
nullableName?.let {
    println("The name is $it")  // è¾“å‡º: The name is Alice
}

val nullName: String? = null
nullName?.let {
    println("This will not print")
}
```

### **5.2 ä½¿ç”¨ `safe cast`**
[[Kotlin/Kotlin åŸºç¡€/Kotlin åŸºç¡€è¯­æ³•/6.ç©ºå®‰å…¨ï¼ˆNullableï¼‰ä¸ Elvis æ“ä½œç¬¦/ç±»å‹è½¬æ¢|ç±»å‹è½¬æ¢]]
ä½¿ç”¨ `as?` è¿›è¡Œå®‰å…¨ç±»å‹è½¬æ¢ï¼Œå¦‚æœè½¬æ¢å¤±è´¥è¿”å› `null`ã€‚

```kotlin
val obj: Any = "Hello"
val str: String? = obj as? String  // æˆåŠŸè½¬æ¢ä¸º String
println(str)  // è¾“å‡º: Hello

val number: Int? = obj as? Int  // è½¬æ¢å¤±è´¥ï¼Œè¿”å› null
println(number)  // è¾“å‡º: null
```

### **5.3 ä½¿ç”¨ `if` åˆ¤æ–­ç©ºå€¼**

å¯ä»¥é€šè¿‡ `if` æ˜¾å¼æ£€æŸ¥å˜é‡æ˜¯å¦ä¸ºç©ºã€‚

```kotlin
val nullableName: String? = null

if (nullableName != null) {
    println(nullableName.uppercase())
} else {
    println("Name is null")  // è¾“å‡º: Name is null
}
```

---

## **6. å¯ç©ºç±»å‹çš„é“¾å¼æ“ä½œ**

åˆ©ç”¨å®‰å…¨è°ƒç”¨æ“ä½œç¬¦å’Œ Elvis æ“ä½œç¬¦ï¼Œå¯ä»¥å®ç°é“¾å¼æ“ä½œã€‚

```kotlin
fun main() {
    val person: Person? = Person("Alice", null)

    val streetName = person?.address?.streetName ?: "No street provided"
    println(streetName)  // è¾“å‡º: No street provided
}

data class Address(val streetName: String)
data class Person(val name: String, val address: Address?)
```

---

## **7. æŠŠå¯ç©ºç±»å‹è½¬æ¢ä¸ºéç©ºç±»å‹**

æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†å¯ç©ºç±»å‹è½¬æ¢ä¸ºéç©ºç±»å‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•å®ç°ï¼š

### **7.1 ä½¿ç”¨ `Elvis æ“ä½œç¬¦` æä¾›é»˜è®¤å€¼**

```kotlin
val nullableName: String? = null
val name: String = nullableName ?: "Default Name"
println(name)  // è¾“å‡º: Default Name
```

### **7.2 æ˜¾å¼æŠ›å‡ºå¼‚å¸¸**

é€šè¿‡ `throw` åœ¨ Elvis æ“ä½œç¬¦ä¸­æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ã€‚

```kotlin
val nullableName: String? = null
val name: String = nullableName ?: throw IllegalArgumentException("Name cannot be null")
```

---

## **8. ç©ºå®‰å…¨ä¸é›†åˆ**

Kotlin çš„é›†åˆæ“ä½œä¹Ÿå¯ä»¥å¾ˆå¥½åœ°å¤„ç†ç©ºå€¼ã€‚

### **8.1 è¿‡æ»¤æ‰ç©ºå€¼**

ä½¿ç”¨ `filterNotNull` è¿‡æ»¤æ‰é›†åˆä¸­çš„ç©ºå€¼ã€‚

```kotlin
val names: List<String?> = listOf("Alice", null, "Bob", null, "Charlie")
val filteredNames = names.filterNotNull()
println(filteredNames)  // è¾“å‡º: [Alice, Bob, Charlie]
```

### **8.2 æ˜ å°„ä¸è¿‡æ»¤ç»“åˆ**

åœ¨å¤„ç†é›†åˆæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `map` å’Œ `filterNotNull` ä¸€èµ·æ“ä½œã€‚

```kotlin
val numbers: List<Int?> = listOf(1, null, 3, null, 5)
val doubledNumbers = numbers.map { it?.times(2) }.filterNotNull()
println(doubledNumbers)  // è¾“å‡º: [2, 6, 10]
```

---

## **9. ç»ƒä¹ é¢˜**

1. å®šä¹‰ä¸€ä¸ªå¯ç©ºçš„ `String?`ï¼Œå®ç°ä»¥ä¸‹æ“ä½œï¼š
    
    - å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™è¾“å‡ºå…¶é•¿åº¦ã€‚
    - å¦‚æœä¸ºç©ºï¼Œåˆ™è¾“å‡º "å€¼ä¸ºç©º"ã€‚
2. åˆ›å»ºä¸€ä¸ªåŒ…å«å¯ç©ºå€¼çš„åˆ—è¡¨ï¼Œè¿‡æ»¤æ‰ `null` å€¼åè¾“å‡ºéç©ºåˆ—è¡¨ã€‚
    
3. ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªå¯ç©ºçš„åœ°å€å¯¹è±¡ï¼Œè¿”å›è¡—é“åç§°ï¼›å¦‚æœä¸ºç©ºï¼Œåˆ™è¿”å›é»˜è®¤å€¼ "Unknown Street"ã€‚
    
4. ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ª `Any` ç±»å‹å‚æ•°ï¼Œå®‰å…¨åœ°å°†å…¶è½¬æ¢ä¸º `Int?`ï¼Œå¹¶è¿”å›è½¬æ¢ç»“æœã€‚
    
5. ç»™å®šä¸€ä¸ªç”¨æˆ·å¯¹è±¡ `User?`ï¼Œå®ç°é“¾å¼æ“ä½œæ£€æŸ¥å…¶é‚®ç®±åœ°å€æ˜¯å¦ä¸º `null`ï¼Œå¦‚æœä¸ºç©ºåˆ™è¿”å› "No Email"ã€‚
    

å®Œæˆåéšæ—¶å¯ä»¥è®¨è®ºï¼ ğŸ˜Š