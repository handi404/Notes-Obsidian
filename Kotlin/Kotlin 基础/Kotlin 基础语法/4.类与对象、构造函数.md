### **Kotlin 类与对象、构造函数详解**

---

### **1. Kotlin 类的定义**

在 Kotlin 中，类通过 `class` 关键字定义，基本语法如下：

```kotlin
class ClassName {
    // 类成员（属性、方法等）
}
```

#### **示例：定义一个简单的类**

```kotlin
class Person {
    var name: String = ""
    var age: Int = 0

    fun introduce() {
        println("Hi, I'm $name, and I'm $age years old.")
    }
}

fun main() {
    val person = Person()  // 创建对象
    person.name = "Alice"  // 设置属性
    person.age = 25
    person.introduce()     // 调用方法
}
```

---

### **2. 主构造函数**

Kotlin 的类可以在类名后直接声明主构造函数，用于初始化类的主要属性。

#### **2.1 主构造函数定义**

```kotlin
class Person(val name: String, var age: Int) {
    fun introduce() {
        println("Hi, I'm $name, and I'm $age years old.")
    }
}

fun main() {
    val person = Person("Alice", 25)  // 通过主构造函数初始化
    person.introduce()               // 输出: Hi, I'm Alice, and I'm 25 years old.
}
```

#### **2.2 主构造函数中的初始化代码块**

主构造函数不能包含代码逻辑，但可以使用 `init` 代码块初始化复杂逻辑。

```kotlin
class Person(val name: String, var age: Int) {
    init {
        println("A new person named $name is created.")
    }

    fun introduce() {
        println("Hi, I'm $name, and I'm $age years old.")
    }
}

fun main() {
    val person = Person("Alice", 25)
    // 输出:
    // A new person named Alice is created.
    // Hi, I'm Alice, and I'm 25 years old.
}
```

---

### **3. 次构造函数**

除了主构造函数，还可以定义次构造函数，用于支持不同的初始化方式。次构造函数使用 `constructor` 关键字。

```kotlin
class Person {
    var name: String
    var age: Int

    constructor(name: String) {
        this.name = name
        this.age = 0
    }

    constructor(name: String, age: Int) {
        this.name = name
        this.age = age
    }

    fun introduce() {
        println("Hi, I'm $name, and I'm $age years old.")
    }
}

fun main() {
    val person1 = Person("Alice")       // 使用次构造函数
    val person2 = Person("Bob", 30)     // 使用次构造函数
    person1.introduce()                // 输出: Hi, I'm Alice, and I'm 0 years old.
    person2.introduce()                // 输出: Hi, I'm Bob, and I'm 30 years old.
}
```

---

### **4. 类的属性与方法**

#### **4.1 属性**

- Kotlin 的属性由 `var`（可变）或 `val`（不可变）定义。
- 属性可以包含自定义的 `getter` 和 `setter`。

```kotlin
class Person {
    var name: String = "Unknown"
        get() = field.uppercase()  // 自定义 getter
        set(value) {
            field = value.trim()   // 自定义 setter
        }

    var age: Int = 0
}

fun main() {
    val person = Person()
    person.name = "  Alice  "      // 自动调用 setter
    println(person.name)           // 自动调用 getter，输出: ALICE
}
```

#### **4.2 方法**

方法定义与普通函数类似，但可以访问类的属性和方法。

---

### **5. Kotlin 中的对象**

#### **5.1 创建对象**

使用 `val` 或 `var` 创建类的实例。

```kotlin
val person = Person("Alice", 25)  // 使用主构造函数
```

#### **5.2 单例对象**

通过 `object` 关键字定义单例对象。

```kotlin
object Database {
    val name = "MainDB"

    fun connect() {
        println("Connected to $name")
    }
}

fun main() {
    Database.connect()  // 调用单例对象的方法
}
```

---

### **6. 嵌套类与内部类**

#### **6.1 嵌套类**

嵌套类是静态的，不能访问外部类的成员。

```kotlin
class Outer {
    class Nested {
        fun sayHello() = "Hello from Nested class"
    }
}

fun main() {
    val nested = Outer.Nested()
    println(nested.sayHello())  // 输出: Hello from Nested class
}
```

#### **6.2 内部类**

通过 `inner` 关键字定义内部类，可以访问外部类的成员。

```kotlin
class Outer(val name: String) {
    inner class Inner {
        fun sayHello() = "Hello from Inner class of $name"
    }
}

fun main() {
    val inner = Outer("OuterClass").Inner()
    println(inner.sayHello())  // 输出: Hello from Inner class of OuterClass
}
```

---

### **7. 数据类**

数据类是专门用于存储数据的类，使用 `data` 关键字定义。Kotlin 会自动为数据类生成 `toString()`、`equals()`、`hashCode()` 等方法。

```kotlin
data class User(val name: String, val age: Int)

fun main() {
    val user = User("Alice", 25)
    println(user)  // 输出: User(name=Alice, age=25)
}
```

---

### **8. 类的继承**

#### **8.1 开放类**

Kotlin 中的类默认是 `final` 的，不能被继承。若要允许继承，必须使用 `open` 关键字。

```kotlin
open class Animal {
    open fun makeSound() {
        println("Animal sound")
    }
}

class Dog : Animal() {
    override fun makeSound() {
        println("Woof!")
    }
}

fun main() {
    val dog = Dog()
    dog.makeSound()  // 输出: Woof!
}
```

#### **8.2 构造函数与继承**

子类必须调用父类的构造函数。

```kotlin
open class Animal(val name: String)

class Dog(name: String, val breed: String) : Animal(name)

fun main() {
    val dog = Dog("Buddy", "Golden Retriever")
    println("${dog.name} is a ${dog.breed}")
}
```

---

### **9. 抽象类与接口**
[[抽象类和接口]]
#### **9.1 抽象类**

抽象类不能被实例化，包含抽象方法（没有方法体）和具体方法。

```kotlin
abstract class Animal {
    abstract fun makeSound()  // 抽象方法

    fun eat() {
        println("Eating...")
    }
}

class Dog : Animal() {
    override fun makeSound() {
        println("Woof!")
    }
}

fun main() {
    val dog = Dog()
    dog.makeSound()
    dog.eat()
}
```

#### **9.2 接口**

接口使用 `interface` 关键字定义，可以包含抽象方法和实现方法。

```kotlin
interface Drivable {
    fun drive()

    fun honk() {
        println("Honking!")
    }
}

class Car : Drivable {
    override fun drive() {
        println("Driving a car")
    }
}

fun main() {
    val car = Car()
    car.drive()
    car.honk()
}
```

---

### **练习题**

1. 定义一个 `Car` 类，包含 `brand` 和 `speed` 属性，并实现一个方法 `drive()` 输出车辆信息。
2. 定义一个 `Student` 数据类，包含姓名和成绩，创建多个实例并比较它们。
3. 创建一个包含主构造函数和多个次构造函数的类，并调用不同的构造函数初始化实例。
4. 定义一个抽象类 `Shape`，实现具体子类 `Circle` 和 `Rectangle`，并重写方法计算面积。

完成后随时与我交流或讨论问题！ 😊