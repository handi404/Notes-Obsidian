好的，处理字符串是 Java 编程中非常高频的操作。Java 提供了几个核心类来处理字符串，各有其特点和适用场景。我们来逐一解析：

**核心字符串处理类**

1.  **`String` (java.lang.String)**
    *   **核心特性：不可变 (Immutable)**
        *   一旦一个 `String` 对象被创建，它的值就不能被改变。任何看起来像是修改 `String` 对象的操作（如 `concat()`, `substring()`, `replace()`）实际上都会创建一个*新的* `String` 对象。
        *   **为什么不可变？**
            *   **线程安全：** 无需同步即可在多线程环境共享。
            *   **安全性：** 例如，在网络连接、文件路径等场景，如果字符串可变，可能会被恶意修改导致安全漏洞。
            *   **哈希码缓存：** `String` 的哈希码在第一次计算后会被缓存，因为值不变，所以哈希码也不变，这使得 `String` 作为 `HashMap` 的键等场景时性能很高。
            *   **字符串常量池 (String Pool)：** 为了节省内存和提高效率，JVM 维护了一个字符串常量池。字面量字符串和通过 `intern()` 方法添加的字符串会存储在这里，相同的字符串内容会指向同一个对象。
    *   **创建方式：**
        *   字面量: `String s1 = "Hello";` (推荐，会尝试从字符串常量池获取)
        *   `new` 关键字: `String s2 = new String("Hello");` (总是在堆上创建新对象，即使内容相同)
        *   字符数组: `char[] chars = {'H', 'e', 'l', 'l', 'o'}; String s3 = new String(chars);`
        *   字节数组: `byte[] bytes = {72, 101, 108, 108, 111}; String s4 = new String(bytes);` (可以指定字符集)

2.  **`StringBuilder` (java.lang.StringBuilder) - (Java 5+，推荐使用)**
    *   **核心特性：可变 (Mutable)**
        *   用于在*单线程*环境下高效地拼接和修改字符串。
        *   它的操作直接在原对象上进行，不会每次都创建新对象，因此在大量字符串修改操作时性能远高于 `String`。
    *   **线程安全性：非线程安全。**

3.  **`StringBuffer` (java.lang.StringBuffer)**
    *   **核心特性：可变 (Mutable)**
        *   与 `StringBuilder` 类似，但它是**线程安全**的。其方法大多用 `synchronized` 关键字修饰。
        *   由于线程同步的开销，在单线程环境下，其性能通常低于 `StringBuilder`。
    *   **适用场景：** 多线程环境下需要共享和修改字符串时。但现代并发编程更倾向于使用 `java.util.concurrent` 包下的工具或局部 `StringBuilder` 结合同步块。

4.  **`StringJoiner` (java.util.StringJoiner) - (Java 8+)**
    *   **核心特性：可变 (Mutable)**
        *   一个辅助类，用于通过指定的分隔符、可选的前缀和后缀来构造一个字符序列。
        *   非常适合将集合或数组中的元素连接成一个字符串。

**常用方法详解 (以 `String` 为主，`StringBuilder` / `StringBuffer` 有类似功能的方法)**

下面列举 `String` 类中一些最常用和最新的方法，并会提及 `StringBuilder` / `StringBuffer` 的对应方法。

### **1. 获取与检查 (Inspection & Checking)**

| `String` 方法                 | `StringBuilder`/`StringBuffer` 对应 | 描述                                        | 示例 (`String str = "Hello World!";`)                     |
| :-------------------------- | :-------------------------------- | :---------------------------------------- | :------------------------------------------------------ |
| `length()`                  | `length()`                        | 返回字符串的长度（字符数量）。                           | `str.length()` 返回 `12`                                  |
| `isEmpty()`                 | - (通过 `length() == 0` 判断)         | 判断字符串是否为空（长度为0）。                          | `"".isEmpty()` 返回 `true`                                |
| `isBlank()` (Java 11+)      | -                                 | 判断字符串是否为空白（null、空字符串或只包含空白字符）。            | `"   ".isBlank()` 返回 `true`, `str.isBlank()` 返回 `false` |
| `charAt(int index)`         | `charAt(int index)`               | 返回指定索引处的字符。索引从0开始。                        | `str.charAt(0)` 返回 `H`                                  |
| `codePointAt(int index)`    | `codePointAt(int index)`          | 返回指定索引处的字符的 Unicode 码点（支持辅助平面字符）。         |                                                         |
| `contains(CharSequence s)`  | - (通过 `indexOf(str) != -1` 判断)    | 判断字符串是否包含指定的字符序列。                         | `str.contains("World")` 返回 `true`                       |
| `startsWith(String prefix)` | -                                 | 判断字符串是否以指定的前缀开始。                          | `str.startsWith("Hello")` 返回 `true`                     |
| `endsWith(String suffix)`   | -                                 | 判断字符串是否以指定的后缀结束。                          | `str.endsWith("!")` 返回 `true`                           |
| `indexOf(String str)`       | `indexOf(String str)`             | 返回指定子字符串在此字符串中第一次出现的索引，没有则返回 -1。可指定起始索引。  | `str.indexOf("o")` 返回 `4`                               |
| `lastIndexOf(String str)`   | `lastIndexOf(String str)`         | 返回指定子字符串在此字符串中最后一次出现的索引，没有则返回 -1。可指定起始索引。 | `str.lastIndexOf("o")` 返回 `7`                           |


### **2. 比较 (Comparison)**

| `String` 方法                        | 描述                                   | 示例 (`String s1 = "hello"; String s2 = "HELLO";`)                                                              |
| ---------------------------------- | ------------------------------------ | ------------------------------------------------------------------------------------------------------------- |
| `equals(Object anObject)`          | 比较两个字符串的内容是否相同（区分大小写）。**推荐用这个比较内容！** | `s1.equals("hello")` 返回 `true`, `s1.equals(s2)` 返回 `false`                                                    |
| `equalsIgnoreCase(String another)` | 比较两个字符串的内容是否相同（忽略大小写）。               | `s1.equalsIgnoreCase(s2)` 返回 `true`                                                                           |
| `compareTo(String anotherString)`  | 按字典顺序比较两个字符串（区分大小写）。返回负整数、零或正整数。     | `s1.compareTo("world")` 返回负数 (h < w)                                                                          |
| `compareToIgnoreCase(String str)`  | 按字典顺序比较两个字符串（忽略大小写）。                 | `s1.compareToIgnoreCase(s2)` 返回 `0`                                                                           |
| `==` (操作符)                         | 比较两个引用是否指向内存中的同一个对象（通常不用于比较字符串内容）。   | `String a = "hi"; String b = "hi"; a == b` 可能为 `true` (常量池)。 `String c = new String("hi"); a == c` 为 `false`。 |

### **3. 提取与截取 (Extraction & Substring)**

| `String` 方法                               | `StringBuilder`/`StringBuffer` 对应 | 描述                                        | 示例 (`String str = "Hello World!";`) |
| ----------------------------------------- | --------------------------------- | ----------------------------------------- | ----------------------------------- |
| `substring(int beginIndex)`               | `substring(int start)`            | 返回从 `beginIndex` 开始到字符串末尾的新子字符串。          | `str.substring(6)` 返回 `"World!"`    |
| `substring(int beginIndex, int endIndex)` | `substring(int start, int end)`   | 返回从 `beginIndex` 开始到 `endIndex-1` 的新子字符串。 | `str.substring(0, 5)` 返回 `"Hello"`  |

### **4. 修改与转换 (Modification & Transformation - `String` 返回新对象，`Builder` / `Buffer` 修改自身)**

| `String` 方法                                              | `StringBuilder`/`StringBuffer` 对应               | 描述                                                             | 示例 (`String str = " Hello Java! ";`)                 |
| -------------------------------------------------------- | ----------------------------------------------- | -------------------------------------------------------------- | ---------------------------------------------------- |
| `concat(String str)`                                     | `append(String str)`                            | 将指定字符串连接到此字符串的末尾。                                              | `"A".concat("B")` 返回 `"AB"`                          |
| `replace(char oldChar, char newChar)`                    | `replace(int start, int end, String str)` (更通用) | 将所有出现的 `oldChar` 替换为 `newChar`。                                | `str.replace('a', 'o')` 返回 `" Hello Jovo! "`         |
| `replace(CharSequence target, CharSequence replacement)` | `replace(int start, int end, String str)` (更通用) | 将所有出现的 `target` 子序列替换为 `replacement` 子序列。                      | `str.replace("Java", "World")` 返回 `" Hello World! "` |
| `replaceAll(String regex, String replacement)`           | - (需要自己用 `Pattern` 和 `Matcher`)                 | 使用给定的 `replacement` 替换此字符串所有匹配给定的正则表达式的子字符串。                   | `"a1b2c".replaceAll("\\d", "#")` 返回 `"a#b#c"`        |
| `replaceFirst(String regex, String replacement)`         | - (需要自己用 `Pattern` 和 `Matcher`)                 | 使用给定的 `replacement` 替换此字符串匹配给定的正则表达式的第一个子字符串。                  | `"a1b2c".replaceFirst("\\d", "#")` 返回 `"a#b2c"`      |
| `toLowerCase()`                                          | - (转成`String`再操作)                               | 将所有字符转换为小写。                                                    | `str.toLowerCase()` 返回 `" hello java! "`             |
| `toUpperCase()`                                          | - (转成`String`再操作)                               | 将所有字符转换为大写。                                                    | `str.toUpperCase()` 返回 `" HELLO JAVA! "`             |
| `trim()`                                                 | - (转成`String`再操作)                               | **(过时，但仍可用)** 去除字符串两端的 Unicode 空白字符 (小于等于 U+0020)。             | `str.trim()` 返回 `"Hello Java!"`                      |
| `strip()` (Java 11+)                                     | - (转成`String`再操作)                               | 去除字符串两端的所有 Unicode 空白字符 (使用 `Character.isWhitespace()`)。**推荐** | `str.strip()` 返回 `"Hello Java!"`                     |
| `stripLeading()` (Java 11+)                              | - (转成`String`再操作)                               | 去除字符串前端的空白字符。                                                  | `str.stripLeading()` 返回 `"Hello Java! "`             |
| `stripTrailing()` (Java 11+)                             | - (转成`String`再操作)                               | 去除字符串后端的空白字符。                                                  | `str.stripTrailing()` 返回 `" Hello Java!"`            |
| `repeat(int count)` (Java 11+)                           | -                                               | 返回一个新字符串，它是将此字符串重复 `count` 次的结果。                               | `"abc".repeat(3)` 返回 `"abcabcabc"`                   |
| `toCharArray()`                                          | -                                               | 将此字符串转换为一个新的字符数组。                                              | `char[] arr = str.toCharArray();`                    |
| `getBytes()`                                             | -                                               | 使用平台的默认字符集将此 `String` 编码为字节序列，存储到一个新的字节数组中。                    | `byte[] bytes = str.getBytes();` (注意字符集问题，可指定)       |
| `getBytes(Charset charset)`                              | -                                               | 使用指定的字符集编码。                                                    | `str.getBytes(StandardCharsets.UTF_8)`               |

### **5. 分割与连接 (Splitting & Joining)**

| `String` 方法                                                                                       | `StringJoiner` / `StringBuilder` 对应 | 描述                            | 示例                                                                         |
| ------------------------------------------------------------------------------------------------- | ----------------------------------- | ----------------------------- | -------------------------------------------------------------------------- |
| `split(String regex)`                                                                             | -                                   | 根据匹配给定的正则表达式来拆分此字符串。          | `"a,b,c".split(",")` 返回 `{"a", "b", "c"}` (字符串数组)                          |
| `split(String regex, int limit)`                                                                  | -                                   | 同上，但 `limit` 参数控制模式应用的次数。     | `"a,b,c,d".split(",", 2)` 返回 `{"a", "b,c,d"}`                              |
| `static String join(CharSequence delimiter, CharSequence... elements)` (Java 8+)                  | `StringJoiner`                      | 使用指定的分隔符连接多个元素。               | `String.join("-", "Java", "is", "cool")` 返回 `"Java-is-cool"`               |
| `static String join(CharSequence delimiter, Iterable<? extends CharSequence> elements)` (Java 8+) | `StringJoiner`                      | 使用指定的分隔符连接一个 `Iterable` 中的元素。 | `List<String> list = List.of("A", "B"); String.join(":", list)` 返回 `"A:B"` |

### **6. 格式化 (Formatting)**

| `String` 方法                                                     | 描述                                           | 示例                                                                            |
| --------------------------------------------------------------- | -------------------------------------------- | ----------------------------------------------------------------------------- |
| `static String format(String format, Object... args)`           | 使用指定的格式字符串和参数返回一个格式化的字符串 (类似 C 的 `sprintf`)。 | `String.format("Name: %s, Age: %d", "Alice", 30)` 返回 `"Name: Alice, Age: 30"` |
| `static String format(Locale l, String format, Object... args)` | 同上，但使用指定的区域设置。                               |                                                                               |

### **7. 其他 (`String` 特有)**

| `String` 方法          | 描述                                           | 示例                                                                                       |
| -------------------- | -------------------------------------------- | ---------------------------------------------------------------------------------------- |
| `intern()`           | 返回字符串对象的规范表示形式。如果常量池中已存在此字符串，则返回池中的引用。       | `String s1 = new String("a"); String s2 = s1.intern(); String s3 = "a"; s2 == s3` (true) |
| `lines()` (Java 11+) | 返回一个从此字符串中提取出来的行的 `Stream<String>`。行由行终止符分隔。 | `"A\nB\rC".lines().forEach(System.out::println);` (会打印 A, B, C)                          |

**`StringBuilder` / `StringBuffer` 特有常用方法**

这些方法用于直接修改对象自身：

| 方法                                         | 描述                                                     | 示例 (`StringBuilder sb = new StringBuilder("Hi");`) |
| :------------------------------------------- | :------------------------------------------------------- | :--------------------------------------------------- |
| `append(X x)` (多种重载，如 `String`, `int`, `char`, etc.) | 将 `x` 的字符串表示形式追加到序列的末尾。                      | `sb.append(" Java");` // sb 变为 "Hi Java"            |
| `insert(int offset, X x)` (多种重载)         | 将 `x` 的字符串表示形式插入到序列的 `offset` 位置。          | `sb.insert(2, " There");` // sb 变为 "Hi There Java" |
| `delete(int start, int end)`                 | 移除此序列中从 `start` 到 `end-1` 的子字符串中的字符。     | `sb.delete(0, 3);` // sb 变为 "There Java"          |
| `deleteCharAt(int index)`                    | 移除此序列指定位置的 `char`。                             | `sb.deleteCharAt(0);` // sb 变为 "here Java"       |
| `replace(int start, int end, String str)`    | 使用给定 `String` 中的字符替换此序列的子字符串中的字符。     | `sb.replace(0, 5, "Hello");` // sb 变为 "Hello Java" |
| `reverse()`                                  | 将此字符序列反转。                                         | `sb.reverse();` // sb 变为 "avaJ olleH"           |
| `setLength(int newLength)`                   | 设置字符序列的长度。如果 `newLength` 小于当前长度，则截断。 | `sb.setLength(5);` // sb 变为 "avaJ "               |
| `toString()`                                 | 返回表示此序列中数据的字符串。 (转换为 `String` 对象)      | `String finalStr = sb.toString();`                   |
| `capacity()`                                 | 返回当前容量（底层字符数组的大小）。                        |                                                      |

**`StringJoiner` 常用方法 (Java 8+)**

| 方法                             | 描述                                                | 示例 (`StringJoiner sj = new StringJoiner("-", "[", "]");`) |
| :------------------------------- | :-------------------------------------------------- | :------------------------------------------------------ |
| `add(CharSequence newElement)`   | 添加给定的 `CharSequence` 值作为下一个元素。           | `sj.add("A").add("B");` // sj 内部为 "[A-B]"           |
| `merge(StringJoiner other)`      | 合并另一个 `StringJoiner` 的内容（不包括其前缀后缀）。  |                                                         |
| `setEmptyValue(CharSequence emptyValue)` | 设置当连接器为空（未添加任何元素）时 `toString()` 返回的值。 | `sj.setEmptyValue("EMPTY");`                            |
| `toString()`                     | 返回最终连接好的字符串。                              | `String result = sj.toString();` // result 为 "[A-B]"     |

**选择使用哪个类？**

*   **`String`:**
    *   当字符串内容基本不发生改变时。
    *   作为方法的参数和返回值，因为其不可变性保证了安全。
    *   字符串字面量。
*   **`StringBuilder`:**
    *   **单线程环境**下，需要频繁进行字符串拼接、修改操作时（例如在循环中构建字符串）。这是最常见的动态字符串构建场景。
    *   例如：`StringBuilder sb = new StringBuilder(); for (String item : items) { sb.append(item).append(","); } String result = sb.toString();`
*   **`StringBuffer`:**
    *   **多线程环境**下，多个线程需要共享并修改同一个字符串序列时。
    *   由于其同步开销，现在很多场景会考虑使用 `StringBuilder` 配合外部同步机制，或者使用 `java.util.concurrent` 包下的并发数据结构。但在简单场景下，`StringBuffer` 仍然是直接的选择。
*   **`StringJoiner`:**
    *   当你需要用特定的分隔符、前缀、后缀来连接一系列字符串时，它提供了非常简洁和高效的方式。`String.join()` 内部其实就可能用到了 `StringJoiner`。

**最新进展与实践建议：**

1.  **优先 `StringBuilder` 进行动态拼接：** 在单线程中，避免使用 `+` 在循环中拼接字符串，因为这可能会导致创建大量临时的 `String` 对象。编译器有时会优化简单的 `+` 为 `StringBuilder`，但显式使用 `StringBuilder` 更清晰且性能有保障。
2.  **拥抱 Java 8+ 的 `String.join()` 和 `StringJoiner`：** 对于集合或数组元素的连接，它们非常方便。
3.  **利用 Java 11+ 的新方法：** `isBlank()`, `strip()`, `lines()`, `repeat()` 等可以简化代码。
4.  **理解 `String` 的不可变性：** 这是 Java 字符串设计的核心，理解它有助于写出更高效、更安全的代码。
5.  **注意 `equals()` vs `==`：** 比较字符串内容务必使用 `equals()`。
6.  **字符编码：** 在进行 `String` 和 `byte[]` 转换时 (如 `getBytes()`, `new String(byte[])`)，务必关注字符编码 (如 UTF-8)，以避免乱码问题。推荐显式指定 `Charset`。