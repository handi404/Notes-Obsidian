今天聊个后端老生常谈却一直有争议的话题： **Service 层到底要不要实现接口？**

我自己踩过坑、也折腾过一段时间，有时候项目刚启动我就不给 Service 写接口，结果几个月后加测试、改依赖、做重构时各种难受……但也不是所有时候都非得强上接口，有些场景真的是多此一举。

下面就来详细聊聊这个事，不绕弯，直接上干货。

**一、为什么大家喜欢在 Service 层写接口？**

这个我总结下来，主要就这几种心理或者理由：

1） **面向接口编程的“信仰”** ：Java一代开发者很容易受这句影响，“万物皆接口”，啥都先抽个接口。感觉没接口就不优雅。

2） **为了方便单元测试** ：接口 + Mock = 测试很轻松。比如用Mockito mock 一个接口比 mock 一个实现类顺手。

3） **为了更容易扩展/替换实现** ：比如用户登录接口有三种实现方式：数据库、LDAP、OAuth2，那么就用接口来统一定义一套行为。

4） **符合分层结构解耦思想** ：Controller 不依赖具体实现，只依赖接口，可以降低耦合度。

听起来都挺对的，我之前项目立项的时候也觉得“万一将来要替换实现怎么办”，然后每个Service都配一个接口……后来真香了—— **一堆没被继承过的接口，成了维护负担** 。

**什么时候不用接口反而更舒服？**

说实话，大部分业务项目，尤其是内部系统、后台管理那种 CRUD 性质的，Service 实现类写个接口，基本就是复制粘贴了一个类名变成接口名，毫无价值。

举个实际例子：

```
public interface UserService {
    User getUserById(Long id);
}
```
```
@Service
public class UserServiceImpl implements UserService {
    @Override
    public User getUserById(Long id) {
        return userMapper.selectById(id);
    }
}
```

你说这个接口有什么意义？根本没有第二个实现，Controller 也不会注入多个 Bean。测试时候 mock 一个 `UserServiceImpl` 也不难，为什么还要写接口？

还有些项目写完接口，结果维护时候接口改了忘了改实现类，IDE 还不报错……等上线才发现炸了，这种事我就碰过。

所以我现在的做法是： **不为写而写接口** 。只有明确要多个实现，或者明确要做拆分、隔离时，才抽接口。

**那什么时候“必须”写接口？**

不是说永远不写，有些场景我觉得接口是必须的：

1） **需要多实现切换的业务逻辑** 比如支付，你有微信支付、支付宝、银联等等：

```
public interface PaymentService {
    PayResult pay(PayRequest request);
}
```

不同渠道的实现：

```
@Service("wechatPayment")
public class WeChatPaymentService implements PaymentService {
    ...
}

@Service("alipayPayment")
public class AliPayPaymentService implements PaymentService {
    ...
}
```

然后通过 @Qualifier 注解，或者策略模式动态选择。

2） **你要写框架或者公共库** 别人用你的 Service，肯定要抽象出来个接口。否则只提供一个实现，扩展性没法保证。

3） **你搞了远程调用（RPC）或中台架构** 比如 Dubbo、Spring Cloud 这类服务框架，接口本身就代表了 API 合同，必须抽出来暴露。

4） **你重度使用测试框架，且项目较复杂** 这种确实 mock 接口更方便，特别是用 Mockito、JMockit 这类的团队，一般也倾向于接口式。

**经验总结**

我现在写项目的习惯是这样的：

- **一般业务开发，先不写接口** 。先把实现类撸完，等要扩展时再考虑提接口。
- **Controller 如果只会调用一个 Service 实现，就直接注入实现类**
- **Service 类名直接叫 XxxService，不带 Impl 后缀** ，这样简洁清晰，也不会因为“XxxService”和“XxxServiceImpl”来回跳转浪费时间
- **确定需要接口时再加，不搞预支设计**

这和以前那种“一开始就把每个类都写接口”的思维是反着的。以前是“写了再说”，现在是“需要再加”。

要知道，写接口本身不是目的，清晰、可维护、易扩展才是。

**对代码结构有没有影响？**

这点很多人也关心。比如 Spring 注入时，如果你用了接口，是不是有优势？

其实没有。Spring 是通过类型注入，接口和实现类只要 Bean 唯一，注入都没问题。唯一的影响是：

- **如果你用了多个实现类，要手动 @Qualifier 标注**
- **用接口做类型注入时，容易后期替换**

但从结构上来说，接口多了一层抽象，有利也有弊：

- 有利：未来能灵活替换、切面更方便插拔
- 有弊：阅读代码更绕，跳转多一层，维护开销大

我一般对团队建议是： **接口和实现不要分两个 package** ，否则每次找个实现类得来回切目录，痛苦不堪。

**最后**

很多时候我们写接口，不是为了真的扩展，而是为了显得“架构师”一点。但架构不是靠堆叠接口来体现的， **接口不是必需品，是工具，别被工具绑架了思想。**

更何况，Java 从 Spring Boot 2.x 开始对 Bean 管理已经非常灵活，接口写不写，更多是根据业务实际需要来判断，不该当成强制规范。

Service 层要不要写接口，其实不是非黑即白的问题。 **根据业务复杂度和未来可能的变化来决定，才是成熟开发者该做的选择** 。

感兴趣的朋友可以回去看看自己的项目，是不是一堆没用的接口正在吃灰。如果有，可以适当瘦身一下，项目会清爽很多。
