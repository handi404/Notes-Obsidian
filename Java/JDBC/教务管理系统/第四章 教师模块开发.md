# 第四章 教师模块开发

## **模块简介**	

教师模块主要为教师提供工作便利。

1. 个人中心：主要对教师个人信息进行管理。
2. 成绩管理：主要对所带班级的学生成绩进行管理。

 

基于控制台实现的教务管理系统

![img](image\教师菜单.png) 



## 需求分析

教师登录：（教师使用手机号登录，密码默认为手机号后6位）

​	成功进入管理界面

​	否则返回登录界面

个人中心模块：

​	展示个人信息

​	修改密码

​	修改电话

​	修改地址



成绩管理模块

​	查询授课成绩

​	添加学生成绩

​	修改学生成绩

​	

​	

## **本章⽬标**	

 

### 1、完成教师登录功能

 

登录界面设计：根据选择身份不同，进行登录

​		

```
public void mainView() {

    while (true) {

        System.out.println("*************教务管理系统*******************");
        System.out.println("请选择：1 教师登录 2 学生登录 3 管理员登录 0 退出系统");
        String num = sc.nextLine();

        String mess = "";

        switch (num) {
            case "1":
                loginView();
                Teacher teacher = new TeacherServiceImpl().login(userInfo);
                System.out.println(teacher);
                if (teacher != null) {
                    new TeacherView().teacherPage(teacher);
                } else {
                    mess = "账号或密码错误";
                }
                ;
                break;

            case "2":

                loginView();
                Student student = new StudentServiceImpl().login(userInfo);
                if (student != null) {
                    new StudentView().studetPage(student);
                } else {
                    mess = "账号或密码错误";
                }

                break;

            case "3":
                loginView();
                Manager manager = new ManagerServiceImpl().login(userInfo);
                if (manager != null) {
                    new ManagerView().managerPage(manager);
                } else {
                    mess = "账号或密码错误";
                }
                break;

            case "0":
                System.out.println("bye");
                return;

            default:
                mess = "功能暂未开放";
        }

        System.out.println(mess);

    }


}

/**
 * 登录界面
 *
 * @return 账号密码数组
 */
private Object[] loginView() {

    userInfo = new Object[2];

    System.out.println("***********请输入账号**************");
    userInfo[0] = sc.nextLine();

    System.out.println("***********请输入密码**************");
    userInfo[1] = sc.nextLine();

    return userInfo;
}
```



登录查询：以账号密码进行数据库查询

```
/**
     * 根据电话和密码查询
     *
     * @param userInfo
     * @return
     */
    @Override
    public Teacher findTeacherByPhoneAndPassword(Object[] userInfo) {

        try {
            return template.queryForObject("select * from teacher where phone=? and password=?", new BeanPropertyRowMapper<>(Teacher.class), userInfo);
        } catch (EmptyResultDataAccessException e) {
            return null;
        }
    }
```

###  

### 2、 完成管理界面主菜单设计

 

```
 public void teacherPage(Teacher teacher) {

        loginTeacher = teacher;

        while (true) {

            System.out.println("****************教务系统-教师系统***************");
            System.out.println("***************当前用户为:" + teacher.getName() + "****************");
            System.out.println("************************************************");
            System.out.println("请选择功能：1 个人中心 2 成绩管理   0 退出系统");

            String num = sc.nextLine();

            switch (num) {

                case "1":
                    myselfView();
                    break;

                case "2":
                    scoreView();
                    break;

                case "0":
                    return;

                default:
                    System.out.println("功能暂未开放，请重新选择");
            }
        }


    }


```



 

 

### 3、完成个人中心模块

```
 private void myselfView() {
        System.out.println("当前所在位置：##########教师系统>个人信息管理##########");
        System.out.println("基本信息："+loginTeacher);

        Map<String,Object> map = teacherService.FindPersonalInformation(loginTeacher);
        Course cr =(Course) map.get("course");
        System.out.println("教授课程："+cr.getCname()+"\t类型："+cr.getTypeName());
        System.out.println("所带班级:");
        List<String> classes =(List<String>) map.get("classes");
        if(classes.size()==0){
            System.out.println("暂未带班");
        }else{
            classes.forEach(c-> System.out.print("\t"+c));
            System.out.println("");
        }
        System.out.println("******************************************************");

        while (true){
            System.out.println("请选择功能：1 修改密码 2 修改电话 3 修改地址 0 返回上一级");
            String tnum = sc.nextLine();
            switch (tnum){
                case "1":
                    System.out.println("请输入新密码：");
                    String password = sc.nextLine();
                    teacherService.updatePassword(loginTeacher.getId(),password);
                    System.out.println("密码修改完成，请牢记新密码:"+password);
                    break;

                case "2":
                    System.out.println("请输入新手机号:");
                    String phone = checkTeacherPhone();
                    teacherService.updatePhone(loginTeacher.getId(),phone);
                    System.out.println("修改完成");
                    break;

                case "3":
                    System.out.println("请输入新地址：");
                    String address = sc.nextLine();
                    teacherService.updateAddress(loginTeacher.getId(),address);
                    System.out.println("修改完成");
                    break;

                case "0":
                    return;

                default:
                    System.out.println("该功能暂未开放，请重新选择");
            }


        }

    }
```

 

### 4、完成成绩管理模块



```
   /**
     * 成绩管理
     */
    private void scoreView() {

        System.out.println("当前所在位置：##########教师系统>成绩信息管理##########");

        while (true){
            System.out.println("请选择功能:1 查询授课成绩 2 添加学生成绩 3 修改学生成绩  0 返回上一级");
            String snum = sc.nextLine();

            switch (snum){
                case "1":
                    queryScoreView();
                    break;

                case "2":
                    addScoreView();
                    break;

                case "3":
                    modifyScoreView();
                    break;

                case "0":
                    return;

                default:
                    System.out.println("该功能暂未开放，请重新选择");
            }

        }
    }
```



## 涉及知识点

 

（⼀）字符串类

 

（二）正则表达式

 

（三）map集合的遍历



## **知识点讲解**	

 

### 字符串String

 

#### 1、什么是String

String` 类代表字符串。Java程序中所有的字符串文字（例如 "abc" ）都可以被看作是实现此类的实例。

 

#### 2、String类的作用

`String`类 中包括用于检查各个字符串的方法，比如用于**比较**字符串，**搜索**字符串，**提取**子字符串以及创建具有翻 

译为**大写**或**小写**的所有字符的字符串的副本

 

#### **3、String类的特点**

- ##### 字符串不变：字符串的值在创建后不能被更改

  ```java
  String s1 = "abc"; 
  s1 += "d"; 
  System.out.println(s1); // "abcd" 
  // 内存中有"abc"，"abcd"两个对象，s1从指向"abc"，改变指向，指向了"abcd"。
  ```

- ##### 因为String对象是不可变的，所以它们可以被共享。

  ```java
  String s1 = "abc";
  String s2 = "abc";
  // 内存中只有一个"abc"对象被创建，同时被s1和s2共享。
  ```

- ##### String的本质是

  - JDK8之前是char[] 数组
  - JDK8之后是byte[] 数组



#### 4、String类的常用方法





##### 判断功能的方法

```
String类的判断功能：
boolean equals(Object obj):比较字符串的内容是否相同,区分大小写
boolean equalsIgnoreCase(String str):比较字符串的内容是否相同,忽略大小写
boolean contains(String str):判断大字符串中是否包含小字符串
boolean startsWith(String str):判断字符串是否以某个指定的字符串开头
boolean endsWith(String str):判断字符串是否以某个指定的字符串结尾
boolean isEmpty():判断字符串是否为空。

注意：
字符串内容为空和字符串对象为空。
String s = "";内容为空
String s = null; 字符串对象为空
```



- ##### 代码演示

  ```java
  public class StringDemo {
  	public static void main(String[] args) {
  		// 创建字符串对象
  		String s1 = "helloworld";
  		String s2 = "helloworld";
  		String s3 = "HelloWorld";
  
  		// boolean equals(Object obj):比较字符串的内容是否相同,区分大小写
  		System.out.println("equals:" + s1.equals(s2));
  		System.out.println("equals:" + s1.equals(s3));
  		System.out.println("-----------------------");
  
  		// boolean equalsIgnoreCase(String str):比较字符串的内容是否相同,忽略大小写
  		System.out.println("equals:" + s1.equalsIgnoreCase(s2));
  		System.out.println("equals:" + s1.equalsIgnoreCase(s3));
  		System.out.println("-----------------------");
  
  		// boolean contains(String str):判断大字符串中是否包含小字符串
  		System.out.println("contains:" + s1.contains("hello"));
  		System.out.println("contains:" + s1.contains("hw"));//false 一定是连在一起的
  		System.out.println("-----------------------");
  
  		// boolean startsWith(String str):判断字符串是否以某个指定的字符串开头
  		System.out.println("startsWith:" + s1.startsWith("h"));
  		System.out.println("startsWith:" + s1.startsWith("hello"));
  		System.out.println("startsWith:" + s1.startsWith("world"));
  		System.out.println("-----------------------");
  
  		// 练习：boolean endsWith(String str):判断字符串是否以某个指定的字符串结尾这个自己玩
  
  		// boolean isEmpty():判断字符串是否为空。
  		System.out.println("isEmpty:" + s1.isEmpty());
  
  		String s4 = "";
  		String s5 = null;
  		System.out.println("isEmpty:" + s4.isEmpty());
  		// NullPointerException
  		// s5对象都不存在，所以不能调用方法，空指针异常
  		System.out.println("isEmpty:" + s5.isEmpty());
  	}
  }
  
  ```



##### 获取功能的方法

public int length()` ：返回此字符串的长度

public String concat(String str)`: 将指定的字符串连接到该字符串的末尾。

public char charAt(int index)`: 返回指定索引处的char值。

public int indexOf(int ch)`：返回指定子字符串第一次出现在该字符串内的索引。

public String substring(int beginIndex)`：返回一个子字符串，从beginIndex开始截取字符串到字符串结尾。

public String substring(int beginIndex,int endIndex)`：返回一个子字符串，从beginIndex到endIndex截取字符串。含beginIndex，不含endIndex。

代码演示

```java
/*
 * String类的获取功能
 * int length():获取字符串的长度。
 * char charAt(int index):获取指定索引位置的字符
 * int indexOf(int ch):返回指定字符在此字符串中第一次出现处的索引。
 * 		为什么这里是int类型，而不是char类型?
 * 		原因是：'a'和97其实都可以代表'a'
 * int indexOf(String str):返回指定字符串在此字符串中第一次出现处的索引。
 * int indexOf(int ch,int fromIndex):返回指定字符在此字符串中从指定位置后第一次出现处的索引。
 * int indexOf(String str,int fromIndex):返回指定字符串在此字符串中从指定位置后第一次出现处的索引。
 * String substring(int start):从指定位置开始截取字符串,默认到末尾。
 * String substring(int start,int end):从指定位置开始到指定位置结束截取字符串。
 */
public class StringDemo {
	public static void main(String[] args) {
		// 定义一个字符串对象
		String s = "helloworld";

		// int length():获取字符串的长度。
		System.out.println("s.length:" + s.length());
		System.out.println("----------------------");

		// char charAt(int index):获取指定索引位置的字符
		System.out.println("charAt:" + s.charAt(7));
		System.out.println("----------------------");

		// int indexOf(int ch):返回指定字符在此字符串中第一次出现处的索引。
		System.out.println("indexOf:" + s.indexOf('l'));
		System.out.println("----------------------");

		// int indexOf(String str):返回指定字符串在此字符串中第一次出现处的索引。
		System.out.println("indexOf:" + s.indexOf("owo"));
		System.out.println("----------------------");

		// int indexOf(int ch,int fromIndex):返回指定字符在此字符串中从指定位置后第一次出现处的索引。
		System.out.println("indexOf:" + s.indexOf('l', 4));//从第4个索引开始找l第一次出现的位置
		System.out.println("indexOf:" + s.indexOf('k', 4)); // -1
		System.out.println("indexOf:" + s.indexOf('l', 40)); // -1如果没有就返回-1
		System.out.println("----------------------");

		// 自己练习：int indexOf(String str,int
		// fromIndex):返回指定字符串在此字符串中从指定位置后第一次出现处的索引。

		// String substring(int start):从指定位置开始截取字符串,默认到末尾。包含start这个索引
		System.out.println("substring:" + s.substring(5));
		System.out.println("substring:" + s.substring(0));
		System.out.println("----------------------");

		// String substring(int start,int
		// end):从指定位置开始到指定位置结束截取字符串。包括start索引但是不包end索引，包左不包
		System.out.println("substring:" + s.substring(3, 8));
		System.out.println("substring:" + s.substring(0, s.length()));
	}
}


```



##### 字符串遍历

/*
 * 需求：遍历获取字符串中的每一个字符
 * 
 * 分析：
 * 		A:如何能够拿到每一个字符呢?
 * 			char charAt(int index)
 * 		B:我怎么知道字符到底有多少个呢?
 * 			int length()
 */
public class StringTest {
	public static void main(String[] args) {
	​	// 定义字符串
	​	String s = "helloworld";

	​	// 原始版本
	​	// System.out.println(s.charAt(0));
	​	// System.out.println(s.charAt(1));
	​	// System.out.println(s.charAt(2));
	​	// System.out.println(s.charAt(3));
	​	// System.out.println(s.charAt(4));
	​	// System.out.println(s.charAt(5));
	​	// System.out.println(s.charAt(6));
	​	// System.out.println(s.charAt(7));
	​	// System.out.println(s.charAt(8));
	​	// System.out.println(s.charAt(9));

	​	// 只需要我们从0取到9
	​	// for (int x = 0; x < 10; x++) {
	​	// System.out.println(s.charAt(x));
	​	// }

	​	// 如果长度特别长，我不可能去数，所以我们要用长度功能
	​	for (int x = 0; x < s.length(); x++) {
	​		// char ch = s.charAt(x);
	​		// System.out.println(ch);
	​		// 仅仅是输出，我就直接输出了
	​		System.out.println(s.charAt(x));
	​	}
	}
}



##### 转换功能的方法

​	public char[] toCharArray()`：将此字符串转换为新的字符数组。`public byte[] getBytes()`：使用平台的默认字	

​	符集将该String编码转换为新的字节数组。

​	

​	public String replace(char oldChar, char newChar)`：将oldChar匹配的字符串使用newChar字符串替换。



​	public String replaceFirst(String regex,String replacement)`用给定的 replacement 替换此字符串匹配给定

​	的regex的第一个子字符串。 



​	public String toUpperCase()` :  将字符中转换为大写



​	public String toLowerCase()`:  将字符中转换为小写



代码演示

```java
/*
 * String的转换功能：
 * byte[] getBytes():把字符串转换为字节数组。
 * char[] toCharArray():把字符串转换为字符数组。
 * static String valueOf(char[] chs):把字符数组转成字符串。
 * static String valueOf(int i):把int类型的数据转成字符串。
 * 		注意：String类的valueOf方法可以把任意类型的数据转成字符串。
 * String toLowerCase():把字符串转成小写。
 * String toUpperCase():把字符串转成大写。
 * String concat(String str):把字符串拼接。
 */
public class StringDemo {
	public static void main(String[] args) {
		// 定义一个字符串对象
		String s = "JavaSE";

		// byte[] getBytes():把字符串转换为字节数组。
		byte[] bys = s.getBytes();
		for (int x = 0; x < bys.length; x++) {
			System.out.println(bys[x]);
		}
		System.out.println("----------------");

		// char[] toCharArray():把字符串转换为字符数组。
		char[] chs = s.toCharArray();
		for (int x = 0; x < chs.length; x++) {
			System.out.println(chs[x]);
		}
		System.out.println("----------------");

		// static String valueOf(char[] chs):把字符数组转成字符串。
		String ss = String.valueOf(chs);
		System.out.println(ss);
		System.out.println("----------------");

		// static String valueOf(int i):把int类型的数据转成字符串。
		int i = 100;
		String sss = String.valueOf(i);
		System.out.println(sss);
		System.out.println("----------------");

		// String toLowerCase():把字符串转成小写。
		System.out.println("toLowerCase:" + s.toLowerCase());
		System.out.println("s:" + s);
		// System.out.println("----------------");
		// String toUpperCase():把字符串转成大写。
		System.out.println("toUpperCase:" + s.toUpperCase());
		System.out.println("----------------");

		// String concat(String str):把字符串拼接。
		String s1 = "hello";
		String s2 = "world";
		String s3 = s1 + s2;
		String s4 = s1.concat(s2);
		System.out.println("s3:"+s3);
		System.out.println("s4:"+s4);
	}
}

```



##### 分割-替换-去空格-正则的功能方法

- `public String[] split(String regex)`：将此字符串按照给定的regex（规则）拆分为字符串数组。
- `public String trim()`：去除该字符串的两端空格



- 代码演示

  ```java
  public class String_Demo03 {
      public static void main(String[] args) {
          //创建字符串对象
          String s = "aa|bb|cc";
          String[] strArray = s.split("\\|"); // ["aa","bb","cc"]   
          for(int x = 0; x < strArray.length; x++) {
              System.out.println(strArray[x]); // aa bb cc
          }
          
          // 替换功能
  		String s1 = "helloworld";
  		String s2 = s1.replace('l', 'k');//字符
  		String s3 = s1.replace("owo", "ak47");//字符串
  		System.out.println("s1:" + s1);
  		System.out.println("s2:" + s2);
  		System.out.println("s3:" + s3);
  		System.out.println("---------------");
          
          
          System.out.println("替换功能:"+s1);
          System.out.println(s1.replaceAll("\\s","e"));//把空格替换成e
  
  		// 去除字符串两空格
  		String s4 = " hello world  ";
  		String s5 = s4.trim();
  		System.out.println("s4:" + s4 + "---");
  		System.out.println("s5:" + s5 + "---");
          
          //正则表达式-校验用户写的内容是否满足当前规定  手机号：123 4000 8888
          String s5 ="13140008888";
          boolean matches = s5.matches("^1[356789]\\d{9}$");
          System.out.println(matches);
          
      }
  }
  ```


### 正则表达式

#### 什么是正则表达式？

​	正则表达式又称规则表达式，（Regular Expression，在代码中常简写为regex、regexp或RE），是一种文本

​	模式，包括普通字符（例如，a到z之间的字母）和特殊字符（称为“元字符”），是计算机科学中的一个概念



#### 作用

​	正则表达式使用单个字符串来描述、匹配一系列符合某个句法规则的字符串，通常被用来检索、替换那些符	

​	合某个模式（规则）的文本。



#### 普通字符

普通字符包括没有显式指定为元字符的所有可打印和不可打印字符。这包括所有大写和小写字母、所有数字、所有标点符号和一些其他符号。

| 字符   | 描述                                                         |      |
| ------ | ------------------------------------------------------------ | ---- |
| [ABC]  | 匹配 [...] 中的所有字符，例如 [aeiou] 匹配字符串 "google runoob taobao" 中所有的 e o u a 字母。 |      |
| [^ABC] | 匹配除了 [...] 中字符的所有字符，例如  匹配字符串 "google runoob taobao" 中除了 e o u a 字母的所有字符。 |      |
| [A-Z]  | [A-Z] 表示一个区间，匹配所有大写字母，[a-z] 表示所有小写字母。 |      |
| .      | 匹配除换行符（\n、\r）之外的任何单个字符，相等于。           |      |
| [\s\S] | 匹配所有。\s 是匹配所有空白符，包括换行，\S 非空白符，不包括换行。 |      |
| \w     | 匹配字母、数字、下划线。等价于 [A-Za-z0-9_]                  |      |
| \d     | 匹配任意一个阿拉伯数字（0 到 9）。等价于 [0-9]               |      |

#### 非打印字符

非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列：

| 字符 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| \cx  | 匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。 |
| \f   | 匹配一个换页符。等价于 \x0c 和 \cL。                         |
| \n   | 匹配一个换行符。等价于 \x0a 和 \cJ。                         |
| \r   | 匹配一个回车符。等价于 \x0d 和 \cM。                         |
| \s   | 匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。 |
| \S   | 匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。                  |
| \t   | 匹配一个制表符。等价于 \x09 和 \cI。                         |
| \v   | 匹配一个垂直制表符。等价于 \x0b 和 \cK。                     |



#### 特殊字符

所谓特殊字符，就是一些有特殊含义的字符，如上面说的 runoo*b 中的 *，简单的说就是表示任何字符串的意思。如果要查找字符串中的 * 符号，则需要对 * 进行转义，即在其前加一个 \，runo\*ob 匹配字符串 **runo\*ob**。

许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符"转义"，即，将反斜杠字符\ 放在它们前面。下表列出了正则表达式中的特殊字符：

| 特别字符 | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| $        | 匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 '\n' 或 '\r'。要匹配 $ 字符本身，请使用 \$。 |
| ( )      | 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 \( 和 \)。 |
| *        | 匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 \*。     |
| +        | 匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 \+。     |
| .        | 匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 \. 。    |
| [        | 标记一个中括号表达式的开始。要匹配 [，请使用 \[。            |
| ?        | 匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。 |
| \        | 将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， 'n' 匹配字符 'n'。'\n' 匹配换行符。序列 '\\' 匹配 "\"，而 '\(' 则匹配 "("。 |
| ^        | 匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 \^。 |
| {        | 标记限定符表达式的开始。要匹配 {，请使用 \{。                |
| \|       | 指明两项之间的一个选择。要匹配 \|，请使用 \|。               |

------



#### 限定符

限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 * 或 + 或 ? 或 {n} 或 {n,} 或 {n,m} 共6种。

正则表达式的限定符有：

| 字符  | 描述                                                         |      |
| ----- | ------------------------------------------------------------ | ---- |
| *     | 匹配前面的子表达式零次或多次。例如，zo* 能匹配 **"z"** 以及 **"zoo"**。* 等价于 {0,}。 |      |
| +     | 匹配前面的子表达式一次或多次。例如，zo+ 能匹配 **"zo"** 以及 "**zoo"**，但不能匹配 **"z"**。+ 等价于 {1,}。 |      |
| ?     | 匹配前面的子表达式零次或一次。例如，do(es)?  可以匹配 **"do"** 、 **"does"**、 **"doxy"** 中的 **"do"** 和 **"does"**。? 等价于 {0,1}。 |      |
| {n}   | n 是一个非负整数。匹配确定的 **n** 次。例如，o{2} 不能匹配 **"Bob"** 中的 **o**，但是能匹配 **"food"** 中的两个 **o**。 |      |
| {n,}  | n 是一个非负整数。至少匹配n 次。例如，o{2,} 不能匹配 **"Bob"** 中的 **o**，但能匹配 **"foooood"** 中的所有 **o**。o{1,} 等价于 o+。o{0,} 则等价于 o*。 |      |
| {n,m} | m 和 n 均为非负整数，其中 n <= m。最少匹配 n 次且最多匹配 m 次。例如，o{1,3} 将匹配 **"fooooood"** 中的前三个 **o**。o{0,1} 等价于 o?。请注意在逗号和两个数之间不能有空格。 |      |



## 模块功能实现

#### 个人中心模块

界面

```
private void myselfView() {
        System.out.println("当前所在位置：##########教师系统>个人信息管理##########");
        System.out.println("基本信息："+loginTeacher);

        Map<String,Object> map = teacherService.FindPersonalInformation(loginTeacher);
        Course cr =(Course) map.get("course");
        System.out.println("教授课程："+cr.getCname()+"\t类型："+cr.getTypeName());
        System.out.println("所带班级:");
        List<String> classes =(List<String>) map.get("classes");
        if(classes.size()==0){
            System.out.println("暂未带班");
        }else{
            classes.forEach(c-> System.out.print("\t"+c));
            System.out.println("");
        }
        System.out.println("******************************************************");

        while (true){
            System.out.println("请选择功能：1 修改密码 2 修改电话 3 修改地址 0 返回上一级");
            String tnum = sc.nextLine();
            switch (tnum){
                case "1":
                    System.out.println("请输入新密码：");
                    String password = sc.nextLine();
                    teacherService.updatePassword(loginTeacher.getId(),password);
                    System.out.println("密码修改完成，请牢记新密码:"+password);
                    break;

                case "2":
                    System.out.println("请输入新手机号:");
                    String phone = checkTeacherPhone();
                    teacherService.updatePhone(loginTeacher.getId(),phone);
                    System.out.println("修改完成");
                    break;

                case "3":
                    System.out.println("请输入新地址：");
                    String address = sc.nextLine();
                    teacherService.updateAddress(loginTeacher.getId(),address);
                    System.out.println("修改完成");
                    break;

                case "0":
                    return;

                default:
                    System.out.println("该功能暂未开放，请重新选择");
            }


        }

    }
    
    
     //验证手机号是否存在
    private String checkTeacherPhone() {
        while (true) {
            String phone = sc.nextLine();
            boolean bl = phone.matches("^1(3[0-9]|4[5-9]|5[0-3,5-9]|6[6]|7[1-8]|8[0-9]|9[1,3,5,7,8,9])\\d{8}$");
            if (bl) {

                //查询手机号是否存在,手机号不能重复
                boolean repeated = teacherService.findTeacherByPhone(phone);

                if (!repeated) { //手机号不重复
                    return phone;
                } else {
                    System.out.println("手机号已经存在，请换个手机号码");
                }

            } else {
                System.out.println("手机号码格式不正确，请重新输入手机号码");
            }
        }
    }
```

 

持久层

```

    @Override
    public int updatePasswordById(String id, String password) {
        return template.update("update teacher set password=? where id=?",password,id);
    }

    @Override
    public int updatePhoneById(String id, String phone) {
        return template.update("update teacher set phone=? where id=?",phone,id);
    }

    @Override
    public int updateAddressById(String id, String address) {
        return template.update("update teacher set address=? where id=?",address,id);
    }public int removeCourse(String cname) {
    return template.update("delete from course where cname=?",cname);
}
```



#### 成绩管理

##### 添加成绩

```
 private void addScoreView() {
        List<String> studetsId = studentService.findAllStudentsByTid(loginTeacher.getId());

        Score score1 = new Score();

        while(true) {

            System.out.println("请输入学生学号：");
            String sid = sc.nextLine();

            if (studetsId.contains(sid)) {

                //判断该学生成绩是否存在
                Score score = scoreService.findScoreBySidAndCid(sid,loginTeacher.getCid());
                if(score!=null){
                    System.out.println("该学生的课程成绩已经录入,是否继续添加？Y/N");
                    if(!out()){

                        return;
                    }
                }else{

                    System.out.println("请输入成绩：");
                    String gradeStr = sc.nextLine();

                    score1.setCid(loginTeacher.getCid());
                    score1.setSid(sid);
                    score1.setGrade(Double.valueOf(gradeStr));

                    //添加
                    scoreService.addScore(score1);

                    System.out.println("添加完成，是否继续？y/n");
                    if(!out()){

                        return;
                    }
                }

            } else {
                System.out.println("该学生不是您的学生,请重新输入学号");
            }
        }

    }
```

 

持久层

```
/**
     * 添加成绩
     * @param score1
     */
    @Override
    public void addScore(Score score1) {

        template.update("insert into score values(null,?,?,?)",score1.getGrade(),score1.getCid(),score1.getSid());
    }
```

##### 查询成绩

界面

```
 private void queryScoreView() {

        System.out.println("您所带班级的成绩如下：");

        List<Map<String,Object>> scores = scoreService.queryScoresByTeacherId(loginTeacher.getId());

        for (Map<String, Object> score : scores) {

            System.out.println("学生姓名:"+score.get("stuName")+"\t 成绩:"+score.get("grade")+"\t 课程名称:"+score.get("cname")+"\t 班级名称:"+score.get("className"));
        }

    }
```

##  

持久层

```

    /**
     * 根据教师id查询成绩信息
     * @param id
     * @return
     */
    @Override
    public List<Map<String, Object>> queryScoresByTeacherId(String id) {

        String sql = "select st.name stuName,cls.name className,grade,cname from student st,classes cls,teacher t,course c,score sc,teachingclass tc where tc.tid = t.id and tc.classId = cls.id and t.cid = c.id and sc.cid = c.id and sc.sid=st.id and st.classId = cls.id and t.id = ?";

        return template.queryForList(sql,id);
    }
```



##### 成绩修改

界面

```
 private void modifyScoreView() {
        List<String> studetsId = studentService.findAllStudentsByTid(loginTeacher.getId());
        while(true) {

            System.out.println("请输入学生学号：");
            String sid = sc.nextLine();

            if (studetsId.contains(sid)) {

                System.out.println("请输入新成绩：");
                String gradeStr = sc.nextLine();

                //根据学号和课程id修改成绩
                boolean bl = scoreService.updateGradeBySidAndCid(sid,loginTeacher.getCid(),Double.valueOf(gradeStr));

                if(bl){
                    System.out.println("修改成功是否继续？y/n");
                }else{
                    System.out.println("该学生该门功课的成绩不存在,请先进行添加，是否继续修改其他同学的成绩？y/n");

                }

                //判断是否退出
                if(!out()){
                    return;
                }
            } else {
                System.out.println("该学生不是您的学生,请重新输入学号");
            }
        }

    }
```

持久层

```
 /**
     * 根据学号和课程id修改成绩
     * @param sid
     * @param cid
     * @param grade
     * @return
     */
    @Override
    public int updateGrade(String sid, int cid, Double grade) {
        return template.update("update score set grade=? where sid=? and cid=?",grade,sid,cid);
    }
```





## 本章总结

 

本章重点讲解教师模块的开发实现。

 

## 布置作业

1. 完成界面创建。

2. 完成相关数据操作。


